#INFO: **** input file is /projects/bamu3429/BENCHMARK/fresh_atoms/MRPT/vdz/monoxides/VO/mrpt.py ****
import json
from pyscf import gto,scf,mcscf, fci, lo, ci, cc
from pyscf.scf import ROHF, UHF,ROKS
import numpy as np
import pandas as pd

# THIS IS WERE IT STARTS ====================================

df=json.load(open("../../../trail.json"))

spins={'ScO':1, 'TiO':2, 'VO':3, 'CrO':4, 'MnO':5, 'FeO':4, 'CuO':1}

nd={'Sc':(1,0), 'Ti':(2,0), 'V':(3,0), 'Cr':(5,0), 'Mn':(5,0), 'Fe':(5,1), 'Cu':(5,4)}

cas={'Sc':3, 'Ti':4, 'V':5, 'Cr':6, 'Mn':7, 'Fe':8, 'Cu':11}

re={'ScO':1.668, 'TiO':1.623, 'VO':1.591, 'CrO':1.621, 'MnO':1.648, 'FeO':1.616, 'CuO':1.725}

datacsv={}
for nm in ['basis','charge','method','molecule','pseudopotential',
           'totalenergy','totalenergy-stocherr','totalenergy-syserr']:
  datacsv[nm]=[]

basis='vdz'
element='V'

mol=gto.Mole()
mol.ecp={}
mol.basis={}
for el in [element,'O']:
  mol.ecp[el]=gto.basis.parse_ecp(df[el]['ecp'])
  mol.basis[el]=gto.basis.parse(df[el][basis])
mol.charge=0
mol.spin=spins[element+'O']
mol.build(atom="%s 0. 0. 0.; O 0. 0. %g"%(element,re[element+'O']),verbose=4)

m=ROHF(mol)
m.level_shift=1000.0
dm=m.from_chk("../../../../HF/monoxides/"+element+basis+"0.chk")
hf=m.kernel(dm)
m.analyze()

from pyscf.shciscf import shci
mc = shci.SHCISCF(m, 9, 4+cas[element])
#mc.fcisolver.conv_tol = 1e-14
mc.fcisolver.mpiprefix="srun -n20"
mc.fcisolver.num_thrds=12
mc.verbose = 4
cas=mc.kernel()[0]
 
from pyscf.icmpspt import icmpspt
pt=icmpspt.icmpspt(mc,rdmM=500, PTM=1000,\
                          pttype="MRLCC",\
                          third_order=True,\
                          fully_ic=True,\
                          do_dm4=True)

datacsv['basis'].append(basis)
datacsv['charge'].append(0)
datacsv['method'].append('MRPT')
datacsv['molecule'].append(element)
datacsv['pseudopotential'].append('trail')
datacsv['totalenergy'].append(cas+pt)
datacsv['totalenergy-stocherr'].append(0.0)
datacsv['totalenergy-syserr'].append(0.0)
pd.DataFrame(datacsv).to_csv(element+".csv",index=False)

#INFO: ******************** input file end ********************


System: ('Linux', 'bnode0302.rc.int.colorado.edu', '3.10.0-514.41.1.el7.x86_64', '#1 SMP Wed Jan 17 10:26:16 EST 2018', 'x86_64', 'x86_64')  Threads 28
Python 2.7.11 (default, Mar 22 2016, 01:42:54) 
[GCC Intel(R) C++ gcc 4.8 mode]
numpy 1.11.1  scipy 0.17.1
Date: Wed Apr 18 13:20:16 2018
PySCF version 1.4.6
PySCF path  /projects/bamu3429/softwares/pyscf_uptodate/pyscf
GIT ORIG_HEAD f3591ef22170896a4cdc2aadaa6f5da388ffcadb
GIT HEAD      ref: refs/heads/master
GIT master branch  1847583fb1d2472321833d3c71c8b7008e5fabf5

[INPUT] VERBOSE 4
[INPUT] num atoms = 2
[INPUT] num electrons = 19
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 3
[INPUT] symmetry False subgroup None
[INPUT]  1 V      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 O      0.000000000000   0.000000000000   1.591000000000 AA    0.000000000000   0.000000000000   3.006554264183 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] O
[INPUT] 0    0    [10   /1   ]  57.663349         -0.002794
                                35.726816         0.023976
                                22.453757         -0.115974
                                14.732301         0.288033
                                9.739917          -0.274786
                                5.042008          -0.083789
                                2.157818          0.063778
                                1.002916          0.410182
                                0.421839          0.504044
                                0.173041          0.172152
[INPUT] 0    0    [1    /1   ]  0.222099             1
[INPUT] 0    0    [1    /1   ]  0.08884              1
[INPUT] 1    0    [10   /1   ]  52.47406          -0.000522
                                32.138432         0.004857
                                19.458579         -0.027749
                                11.839344         0.074258
                                7.91003           0.014369
                                3.670858          0.153479
                                1.53966           0.283685
                                0.647119          0.358201
                                0.267853          0.29559
                                0.107198          0.104889
[INPUT] 1    0    [1    /1   ]  0.252604             1
[INPUT] 1    0    [1    /1   ]  0.101042             1
[INPUT] 2    0    [1    /1   ]  1.223113             1
[INPUT] 2    0    [1    /1   ]  0.489245             1
[INPUT] V
[INPUT] 0    0    [12   /1   ]  33.51168105       0.006845
                                15.38532624       -0.214557
                                9.96227367        1.392425
                                8.05943355        -1.485929
                                3.6960334         -0.026725
                                1.49220279        0.457681
                                0.84622253        0.506886
                                0.43855031        0.249453
                                0.2102388         0.007109
                                0.1022422         0.007055
                                0.04832462        -0.000443
                                0.02406855        0.001278
[INPUT] 0    0    [12   /1   ]  33.51168105       -0.001211
                                15.38532624       0.04697
                                9.96227367        -0.329808
                                8.05943355        0.363635
                                3.6960334         0.005985
                                1.49220279        -0.140857
                                0.84622253        -0.203846
                                0.43855031        -0.200776
                                0.2102388         0.022081
                                0.1022422         0.429765
                                0.04832462        0.534383
                                0.02406855        0.187984
[INPUT] 0    0    [12   /1   ]  33.51168105       -0.006871
                                15.38532624       0.226397
                                9.96227367        -1.640881
                                8.05943355        1.900984
                                3.6960334         -0.211293
                                1.49220279        -1.475616
                                0.84622253        0.220931
                                0.43855031        0.532517
                                0.2102388         0.907357
                                0.1022422         0.106097
                                0.04832462        -0.528638
                                0.02406855        -0.33681
[INPUT] 0    0    [1    /1   ]  0.02406855           1
[INPUT] 0    0    [1    /1   ]  0.01198757           1
[INPUT] 1    0    [12   /1   ]  49.83779697       0.000413
                                25.60370921       -0.003442
                                10.40982442       0.097153
                                7.71483683        -0.206888
                                4.49868206        0.083281
                                2.48212838        0.186621
                                1.4387019         0.395144
                                0.72090362        0.377883
                                0.3443302         0.134629
                                0.13162828        0.011074
                                0.05284968        -0.000426
                                0.02121951        0.000256
[INPUT] 1    0    [12   /1   ]  49.83779697       -2.9e-05
                                25.60370921       0.000502
                                10.40982442       -0.020934
                                7.71483683        0.047431
                                4.49868206        -0.020701
                                2.48212838        -0.057583
                                1.4387019         -0.106451
                                0.72090362        -0.140229
                                0.3443302         0.043257
                                0.13162828        0.438687
                                0.05284968        0.536785
                                0.02121951        0.12546
[INPUT] 1    0    [12   /1   ]  49.83779697       9e-05
                                25.60370921       -0.002342
                                10.40982442       0.125465
                                7.71483683        -0.321923
                                4.49868206        0.19446
                                2.48212838        0.693755
                                1.4387019         0.323454
                                0.72090362        -0.875978
                                0.3443302         -0.540174
                                0.13162828        0.69685
                                0.05284968        0.327275
                                0.02121951        -0.009315
[INPUT] 1    0    [1    /1   ]  0.02121951           1
[INPUT] 1    0    [1    /1   ]  0.00851977           1
[INPUT] 2    0    [10   /1   ]  34.27504048       0.000678
                                16.12418185       -0.017858
                                9.59474528        0.107867
                                3.8690861         0.173949
                                1.82728072        0.26883
                                0.85799457        0.321303
                                0.38035078        0.300128
                                0.15533087        0.170792
                                0.06318167        0.035148
                                0.03734397        0.003549
[INPUT] 2    0    [10   /1   ]  34.27504048       0.000411
                                16.12418185       0.011699
                                9.59474528        -0.096988
                                3.8690861         -0.225228
                                1.82728072        -0.395141
                                0.85799457        -0.078275
                                0.38035078        0.3045
                                0.15533087        0.474064
                                0.06318167        0.20462
                                0.03734397        0.016541
[INPUT] 2    0    [1    /1   ]  0.03734397           1
[INPUT] 2    0    [1    /1   ]  0.02207241           1
[INPUT] 3    0    [1    /1   ]  1.853039             1
[INPUT] 3    0    [1    /1   ]  1.0952517            1
nuclear repulsion = 25.9433202085229
number of shells = 24
number of NR pGTOs = 334
number of NR cGTOs = 76
basis = {'O': [[0, [57.663349, -0.002794], [35.726816, 0.023976], [22.453757, -0.115974], [14.732301, 0.288033], [9.739917, -0.274786], [5.042008, -0.083789], [2.157818, 0.063778], [1.002916, 0.410182], [0.421839, 0.504044], [0.173041, 0.172152]], [0, [0.222099, 1.0]], [0, [0.08884, 1.0]], [1, [52.47406, -0.000522], [32.138432, 0.004857], [19.458579, -0.027749], [11.839344, 0.074258], [7.91003, 0.014369], [3.670858, 0.153479], [1.53966, 0.283685], [0.647119, 0.358201], [0.267853, 0.29559], [0.107198, 0.104889]], [1, [0.252604, 1.0]], [1, [0.101042, 1.0]], [2, [1.223113, 1.0]], [2, [0.489245, 1.0]]], 'V': [[0, [33.51168105, 0.006845], [15.38532624, -0.214557], [9.96227367, 1.392425], [8.05943355, -1.485929], [3.6960334, -0.026725], [1.49220279, 0.457681], [0.84622253, 0.506886], [0.43855031, 0.249453], [0.2102388, 0.007109], [0.1022422, 0.007055], [0.04832462, -0.000443], [0.02406855, 0.001278]], [0, [33.51168105, -0.001211], [15.38532624, 0.04697], [9.96227367, -0.329808], [8.05943355, 0.363635], [3.6960334, 0.005985], [1.49220279, -0.140857], [0.84622253, -0.203846], [0.43855031, -0.200776], [0.2102388, 0.022081], [0.1022422, 0.429765], [0.04832462, 0.534383], [0.02406855, 0.187984]], [0, [33.51168105, -0.006871], [15.38532624, 0.226397], [9.96227367, -1.640881], [8.05943355, 1.900984], [3.6960334, -0.211293], [1.49220279, -1.475616], [0.84622253, 0.220931], [0.43855031, 0.532517], [0.2102388, 0.907357], [0.1022422, 0.106097], [0.04832462, -0.528638], [0.02406855, -0.33681]], [0, [0.02406855, 1.0]], [0, [0.01198757, 1.0]], [1, [49.83779697, 0.000413], [25.60370921, -0.003442], [10.40982442, 0.097153], [7.71483683, -0.206888], [4.49868206, 0.083281], [2.48212838, 0.186621], [1.4387019, 0.395144], [0.72090362, 0.377883], [0.3443302, 0.134629], [0.13162828, 0.011074], [0.05284968, -0.000426], [0.02121951, 0.000256]], [1, [49.83779697, -2.9e-05], [25.60370921, 0.000502], [10.40982442, -0.020934], [7.71483683, 0.047431], [4.49868206, -0.020701], [2.48212838, -0.057583], [1.4387019, -0.106451], [0.72090362, -0.140229], [0.3443302, 0.043257], [0.13162828, 0.438687], [0.05284968, 0.536785], [0.02121951, 0.12546]], [1, [49.83779697, 9e-05], [25.60370921, -0.002342], [10.40982442, 0.125465], [7.71483683, -0.321923], [4.49868206, 0.19446], [2.48212838, 0.693755], [1.4387019, 0.323454], [0.72090362, -0.875978], [0.3443302, -0.540174], [0.13162828, 0.69685], [0.05284968, 0.327275], [0.02121951, -0.009315]], [1, [0.02121951, 1.0]], [1, [0.00851977, 1.0]], [2, [34.27504048, 0.000678], [16.12418185, -0.017858], [9.59474528, 0.107867], [3.8690861, 0.173949], [1.82728072, 0.26883], [0.85799457, 0.321303], [0.38035078, 0.300128], [0.15533087, 0.170792], [0.06318167, 0.035148], [0.03734397, 0.003549]], [2, [34.27504048, 0.000411], [16.12418185, 0.011699], [9.59474528, -0.096988], [3.8690861, -0.225228], [1.82728072, -0.395141], [0.85799457, -0.078275], [0.38035078, 0.3045], [0.15533087, 0.474064], [0.06318167, 0.20462], [0.03734397, 0.016541]], [2, [0.03734397, 1.0]], [2, [0.02207241, 1.0]], [3, [1.853039, 1.0]], [3, [1.0952517, 1.0]]]}
ecp = {'O': [2, [[-1, [[], [[10.27717748, 6.0]], [[15.99566749, 1232.50197768], [10.46901775, -696.47008301], [14.6384801, -2654.22657081], [12.57591181, 2101.67732548]], [[7.77739102, 61.66306486]]]], [0, [[], [], [[12.39426073, -656683.37638839], [12.38126171, 657858.57667068], [8.57671033, 511.50098405], [9.89256508, -2579.54665641], [28.05641604, -57.68129584], [17.24753607, 970.30940152]], []]], [1, [[], [], [[14.78918914, -363027.24258186], [14.82014018, 361852.52314043], [22.89622221, -1300.20069256], [8.51331893, -181.96869573], [11.48609758, 2194.87589959], [27.22017524, 451.19906206]], []]]]], 'V': [10, [[-1, [[], [[8.85341849, 13.0]], [[14.12393489, 1867.96836466], [10.01469125, -417.2185296], [16.87739786, -6735.41034163], [17.42661229, 5248.9519915]], [[8.14766139, 115.09444037]]]], [0, [[], [], [[10.17161428, 8429.89768085], [6.62108601, -4738.0869454], [6.4407206, 3874.69004628], [11.26222343, -9817.80452096], [19.82459033, -286.16022228], [14.35299938, 2571.80634504]], []]], [1, [[], [], [[10.25117807, 40641.17869487], [10.49106006, -41559.00487832], [13.7869188, 3357.33248976], [16.29479305, -896.47755921], [7.79003518, -1904.45864373], [6.62830213, 382.3757783]], []]], [2, [[], [], [[8.601477, 4615.05527413], [10.66674565, -3671.60281242], [15.19026557, 4480.50015686], [8.06189603, -2591.12632756], [19.82232597, 2587.18683714], [18.22318105, -5431.92186158]], []]]]]}
CPU time:         3.76


******** <class 'pyscf.scf.rohf.ROHF'> flags ********
method = ROHF
initial guess = minao
damping factor = 0
level shift factor = 1000.0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /rc_scratch/bamu3429/tmpbpmaXa
max_memory 4000 MB (current use 159 MB)
num. doubly occ = 8  num. singly occ = 3
Set gradient conv threshold to 3.16228e-05
init E= -86.4002119656004
  HOMO = 499.886010123399  LUMO = 1000.01359651661
cycle= 1 E= -86.4002119656006  delta_E= -1.71e-13  |g|= 1.08e-05  |ddm|= 6.76e-08
  HOMO = -0.113989873998969  LUMO = 0.0135965166212596
Extra cycle  E= -86.4002119656941  delta_E= -9.35e-11  |g|= 4.1e-06  |ddm|= 2.8e-05
converged SCF energy = -86.4002119656941
**** MO energy ****
                Roothaan           | alpha              | beta
MO #1   energy= -3.26823018277762  | -3.34853323226971  | -3.18792703567378  occ= 2
MO #2   energy= -2.1050957723224   | -2.1335215546415   | -2.07666998493674  occ= 2
MO #3   energy= -2.06920857370836  | -2.19924632487493  | -1.9391708225418   occ= 2
MO #4   energy= -2.06920857370836  | -2.19924632487492  | -1.9391708225418   occ= 2
MO #5   energy= -1.1774128415322   | -1.18082969374625  | -1.17399597841321  occ= 2
MO #6   energy= -0.479679650296595 | -0.490829119437735 | -0.468530066531614 occ= 2
MO #7   energy= -0.453322165378181 | -0.45843745435467  | -0.448206876401691 occ= 2
MO #8   energy= -0.45332216537818  | -0.458437454354671 | -0.448206876401691 occ= 2
MO #9   energy= -0.126951728952729 | -0.286174871306384 | 0.0322724565883964 occ= 1
MO #10  energy= -0.11398987399902  | -0.491950969813362 | 0.263971161640374  occ= 1
MO #11  energy= -0.113989873998969 | -0.491950969813335 | 0.263971161640449  occ= 1
MO #12  energy= 0.0135965166212596 | 0.00975384136494153 | 0.0174391918775786 occ= 0
MO #13  energy= 0.0135965166212597 | 0.00975384136494201 | 0.0174391918775786 occ= 0
MO #14  energy= 0.013905374017949  | 0.0115034719264327 | 0.0163070739338829 occ= 0
MO #15  energy= 0.0286115397686416 | 0.0278358096592547 | 0.0293871705336136 occ= 0
MO #16  energy= 0.0423878235220983 | 0.0291055702223526 | 0.0556700768218458 occ= 0
MO #17  energy= 0.0423878235220996 | 0.0291055702223521 | 0.0556700768218459 occ= 0
MO #18  energy= 0.0486038554610052 | 0.0370454217289317 | 0.0601621398226603 occ= 0
MO #19  energy= 0.0617701249661959 | 0.0613402524391466 | 0.0621999956170886 occ= 0
MO #20  energy= 0.0617701249661967 | 0.0613402524391459 | 0.062199995617088  occ= 0
MO #21  energy= 0.0688508384595092 | 0.0670675844509276 | 0.070634092468091  occ= 0
MO #22  energy= 0.0688508384595094 | 0.0670675844509272 | 0.0706340924680909 occ= 0
MO #23  energy= 0.0787888404162078 | 0.071770540297821  | 0.0858070289385624 occ= 0
MO #24  energy= 0.120214061623496  | 0.10908208851461   | 0.131345885833728  occ= 0
MO #25  energy= 0.141599400228219  | 0.124226388574089  | 0.158972411882351  occ= 0
MO #26  energy= 0.14159940022822   | 0.124226388574088  | 0.15897241188235   occ= 0
MO #27  energy= 0.153952307651917  | 0.142374147276224  | 0.165530094867778  occ= 0
MO #28  energy= 0.179095581611111  | 0.171322368884142  | 0.186868945225592  occ= 0
MO #29  energy= 0.179095581611116  | 0.171322368884146  | 0.186868945225599  occ= 0
MO #30  energy= 0.196951897712053  | 0.185425859268268  | 0.208477936155837  occ= 0
MO #31  energy= 0.196951897712053  | 0.185425859268269  | 0.208477936155837  occ= 0
MO #32  energy= 0.211904164787084  | 0.200444633225578  | 0.223363651041703  occ= 0
MO #33  energy= 0.249155498469037  | 0.221798890060967  | 0.276512106877104  occ= 0
MO #34  energy= 0.249155498469038  | 0.221798890060969  | 0.276512106877106  occ= 0
MO #35  energy= 0.373430233544285  | 0.364782370335065  | 0.382078003194777  occ= 0
MO #36  energy= 0.462447481437093  | 0.460815242847821  | 0.464079720026367  occ= 0
MO #37  energy= 0.462447481437109  | 0.460815242847833  | 0.464079720026383  occ= 0
MO #38  energy= 0.473044356061204  | 0.465439840302288  | 0.48064884225934   occ= 0
MO #39  energy= 1.00243422838498   | 0.9792313669127    | 1.02563709123514   occ= 0
MO #40  energy= 1.09023167077033   | 1.02024467140835   | 1.16021856706468   occ= 0
MO #41  energy= 1.09023167077033   | 1.02024467140834   | 1.16021856706468   occ= 0
MO #42  energy= 1.23374421771367   | 1.21276297824308   | 1.25472545718425   occ= 0
MO #43  energy= 1.23374421771367   | 1.21276297824309   | 1.25472545718426   occ= 0
MO #44  energy= 1.43130837965629   | 1.42309528293096   | 1.43952149023619   occ= 0
MO #45  energy= 1.43130837965629   | 1.42309528293096   | 1.43952149023619   occ= 0
MO #46  energy= 1.49729487715581   | 1.49404079546092   | 1.50054895885212   occ= 0
MO #47  energy= 1.53630389489995   | 1.53300925865281   | 1.5395985311471    occ= 0
MO #48  energy= 1.53630389489995   | 1.53300925865282   | 1.53959853114709   occ= 0
MO #49  energy= 1.58616819352578   | 1.58153275236662   | 1.59080363468495   occ= 0
MO #50  energy= 1.58616819352578   | 1.58153275236662   | 1.59080363468496   occ= 0
MO #51  energy= 1.5982769900706    | 1.57476725870508   | 1.62178670574009   occ= 0
MO #52  energy= 1.88545269291342   | 1.87388344602902   | 1.89702193622757   occ= 0
MO #53  energy= 2.04739407525836   | 2.03345937805229   | 2.06132877026256   occ= 0
MO #54  energy= 2.61730038628389   | 2.56771836174944   | 2.66688241081833   occ= 0
MO #55  energy= 2.61730038628389   | 2.56771836174944   | 2.66688241081833   occ= 0
MO #56  energy= 2.97095460098941   | 2.88573407914639   | 3.05617512283244   occ= 0
MO #57  energy= 2.97095460098942   | 2.8857340791464    | 3.05617512283245   occ= 0
MO #58  energy= 3.00582905268525   | 2.98947871246987   | 3.02217939154069   occ= 0
MO #59  energy= 3.00627435719948   | 2.96999184848693   | 3.04255686624873   occ= 0
MO #60  energy= 3.00627435719949   | 2.96999184848694   | 3.04255686624874   occ= 0
MO #61  energy= 3.27920272920959   | 3.26103548578036   | 3.29736997263882   occ= 0
MO #62  energy= 3.27920272920959   | 3.26103548578037   | 3.29736997263882   occ= 0
MO #63  energy= 3.75266337247863   | 3.73819922609706   | 3.76712752185074   occ= 0
MO #64  energy= 4.21074003419604   | 4.21023953000013   | 4.2112405383797    occ= 0
MO #65  energy= 4.21074003419607   | 4.21023953000015   | 4.21124053837972   occ= 0
MO #66  energy= 4.31900137815672   | 4.31833340080553   | 4.31966935550793   occ= 0
MO #67  energy= 4.31900137815672   | 4.31833340080552   | 4.31966935550793   occ= 0
MO #68  energy= 4.51900182556641   | 4.51500799124316   | 4.52299565997592   occ= 0
MO #69  energy= 6.88418151732919   | 6.87440528116731   | 6.89395775342573   occ= 0
MO #70  energy= 7.47560646662748   | 7.40728867430247   | 7.54392425895252   occ= 0
MO #71  energy= 7.4756064666275    | 7.40728867430249   | 7.54392425895253   occ= 0
MO #72  energy= 7.4845983355896    | 7.45216999977924   | 7.51702667145219   occ= 0
MO #73  energy= 7.48459833558964   | 7.45216999977929   | 7.51702667145223   occ= 0
MO #74  energy= 7.64246885126031   | 7.62001472099009   | 7.66492298153058   occ= 0
MO #75  energy= 7.64246885126034   | 7.62001472099012   | 7.66492298153061   occ= 0
MO #76  energy= 7.75696867435208   | 7.73640386545789   | 7.77753348326061   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0V 3s        1.99960
pop of  0V 4s        0.87384
pop of  0V 5s        0.00490
pop of  0V 6s        0.00466
pop of  0V 7s        0.00224
pop of  0V 3px       1.99952
pop of  0V 3py       1.99952
pop of  0V 3pz       1.99677
pop of  0V 4px       0.00986
pop of  0V 4py       0.00986
pop of  0V 4pz       0.06115
pop of  0V 5px       0.00019
pop of  0V 5py       0.00019
pop of  0V 5pz       0.00552
pop of  0V 6px       0.00021
pop of  0V 6py       0.00021
pop of  0V 6pz       0.00855
pop of  0V 7px       0.00004
pop of  0V 7py       0.00004
pop of  0V 7pz       0.00084
pop of  0V 3dxy      0.99754
pop of  0V 3dyz      0.29496
pop of  0V 3dz^2     0.60542
pop of  0V 3dxz      0.29496
pop of  0V 3dx2-y2    0.99754
pop of  0V 4dxy      0.00175
pop of  0V 4dyz      0.00155
pop of  0V 4dz^2     0.00193
pop of  0V 4dxz      0.00155
pop of  0V 4dx2-y2    0.00175
pop of  0V 5dxy      0.00063
pop of  0V 5dyz      0.00000
pop of  0V 5dz^2     0.00131
pop of  0V 5dxz      0.00000
pop of  0V 5dx2-y2    0.00063
pop of  0V 6dxy      0.00003
pop of  0V 6dyz      0.00001
pop of  0V 6dz^2     0.00009
pop of  0V 6dxz      0.00001
pop of  0V 6dx2-y2    0.00003
pop of  0V 4fy^3     0.00000
pop of  0V 4fxyz     0.00000
pop of  0V 4fyz^2    0.00009
pop of  0V 4fz^3     0.00025
pop of  0V 4fxz^2    0.00009
pop of  0V 4fzx^2    0.00000
pop of  0V 4fx^3     0.00000
pop of  0V 5fy^3     0.00000
pop of  0V 5fxyz     0.00002
pop of  0V 5fyz^2    0.00058
pop of  0V 5fz^3     0.00089
pop of  0V 5fxz^2    0.00058
pop of  0V 5fzx^2    0.00002
pop of  0V 5fx^3     0.00000
pop of  1O 2s        1.86692
pop of  1O 3s        0.00480
pop of  1O 4s        0.01519
pop of  1O 2px       1.68179
pop of  1O 2py       1.68179
pop of  1O 2pz       1.53772
pop of  1O 3px       0.00287
pop of  1O 3py       0.00287
pop of  1O 3pz       0.00085
pop of  1O 4px       0.00238
pop of  1O 4py       0.00238
pop of  1O 4pz       0.00176
pop of  1O 3dxy      0.00001
pop of  1O 3dyz      0.00124
pop of  1O 3dz^2     0.00171
pop of  1O 3dxz      0.00124
pop of  1O 3dx2-y2    0.00001
pop of  1O 4dxy      0.00001
pop of  1O 4dyz      0.00470
pop of  1O 4dz^2     0.00308
pop of  1O 4dxz      0.00470
pop of  1O 4dx2-y2    0.00001
 ** Mulliken atomic charges  **
charge of  0V =      0.81805
charge of  1O =     -0.81805

******** <class 'pyscf.mcscf.mc1step.CASSCF'> flags ********
CAS (6e+3e, 9o), ncore = 5, nvir = 62
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
chkfile = ./scratch/161333/tmpQ6FWjB
max_memory 4000 MB (current use 236 MB)
internal_rotation = False

******** SHCI flags ********
executable             = /home/bamu3429/softwares/dice/Dice
mpiprefix              = srun -n20
scratchDirectory       = ./scratch/161333
integralFile           = ./FCIDUMP
configFile             = ./input.dat
outputFile             = ./output.dat
maxIter                = 6
sweep_iter             = []
sweep_epsilon          = []
nPTiter                = 0
Stochastic             = True
fullrestart            = False
restart                = False
num_thrds              = 12
memory                 = None

CASCI E = -86.4002868466211  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (7 JK  2 micro), CASSCF E = -86.4006252393466  dE = -0.00033839273  S^2 = 3.7500000
               |grad[o]|=0.000675  |grad[c]|= None  |ddm|=0.0092
macro iter 2 (21 JK  4 micro), CASSCF E = -86.4135435388074  dE = -0.012918299  S^2 = 3.7500000
               |grad[o]|=0.00239  |grad[c]|= None  |ddm|=0.0281
macro iter 3 (21 JK  4 micro), CASSCF E = -86.4371076477666  dE = -0.023564109  S^2 = 3.7500000
               |grad[o]|=0.0492  |grad[c]|= None  |ddm|=0.0817
macro iter 4 (21 JK  4 micro), CASSCF E = -86.4651701937873  dE = -0.028062546  S^2 = 3.7500000
               |grad[o]|=0.0651  |grad[c]|= None  |ddm|=0.0575
macro iter 5 (21 JK  4 micro), CASSCF E = -86.5176706460284  dE = -0.052500452  S^2 = 3.7500000
               |grad[o]|=0.0721  |grad[c]|= None  |ddm|=0.0574
macro iter 6 (21 JK  4 micro), CASSCF E = -86.5538766675971  dE = -0.036206022  S^2 = 3.7500000
               |grad[o]|=0.0734  |grad[c]|= None  |ddm|=0.0588
macro iter 7 (13 JK  4 micro), CASSCF E = -86.5563874739454  dE = -0.0025108063  S^2 = 3.7500000
               |grad[o]|=0.0332  |grad[c]|= None  |ddm|=0.0485
macro iter 8 (10 JK  4 micro), CASSCF E = -86.5563953563896  dE = -7.8824441e-06  S^2 = 3.7500000
               |grad[o]|=0.00188  |grad[c]|= None  |ddm|=0.00551
macro iter 9 (3 JK  1 micro), CASSCF E = -86.5563954353545  dE = -7.8964931e-08  S^2 = 3.7500000
               |grad[o]|=0.000226  |grad[c]|= None  |ddm|=0.000372
1-step CASSCF converged in 9 macro (138 JK 31 micro) steps
CASSCF canonicalization
CASSCF energy = -86.5563954353545


--------------------------------------------------
                 ICMPSPT CALCULATION              
--------------------------------------------------

Perturbation type: MRLCC
With fully internally contracted scheme
With third order correction

Preparing necessary RDMs
......production of RDMs took      88.37 sec
Reading binary 4RDM from DICE
......reading the RDM took         28.83 sec

(GOOD) Trace 4RDM:   3024.0 =    9*    8*    7*    6
(GOOD) Trace 3RDM:    504.0 =    9*    8*    7
(GOOD) Trace 2RDM:     72.0 =    9*    8
(GOOD) Trace 1RDM:      9.0 =    9

Producing the integrals
......production of INT took      40.86 sec

Energy_core =  -92.48334875
Energy      =  -86.55639544

WARNING: Have to use natural orbitals from CAASCF
         offdiagonal elements:    0.47771037

Basic ingredients written to int/
......savings of INGREDIENTS took      44.53 sec

Second-order:
perturber CCVV --        -0.093787870
perturber CCAV --        -0.064865101
perturber ACVV --        -0.097681620
perturber CCAA --        -0.039138055
perturber AAVV --        -0.103533732
perturber CAAV --        -0.120326075
perturber AAAV --        -0.028340468
perturber AAAC --        -0.004821955
Total:                   -0.552494877

Third-order:             -0.000416568

Total PT       --        -0.552911445

