#INFO: **** input file is /projects/bamu3429/BENCHMARK/fresh_atoms/MRPT/vdz/monoxides/ScO/mrpt.py ****
import json
from pyscf import gto,scf,mcscf, fci, lo, ci, cc
from pyscf.scf import ROHF, UHF,ROKS
import numpy as np
import pandas as pd

# THIS IS WERE IT STARTS ====================================

df=json.load(open("../../../trail.json"))

spins={'ScO':1, 'TiO':2, 'VO':3, 'CrO':4, 'MnO':5, 'FeO':4, 'CuO':1}

nd={'Sc':(1,0), 'Ti':(2,0), 'V':(3,0), 'Cr':(5,0), 'Mn':(5,0), 'Fe':(5,1), 'Cu':(5,4)}

cas={'Sc':3, 'Ti':4, 'V':5, 'Cr':6, 'Mn':7, 'Fe':8, 'Cu':11}

re={'ScO':1.668, 'TiO':1.623, 'VO':1.591, 'CrO':1.621, 'MnO':1.648, 'FeO':1.616, 'CuO':1.725}

datacsv={}
for nm in ['basis','charge','method','molecule','pseudopotential',
           'totalenergy','totalenergy-stocherr','totalenergy-syserr']:
  datacsv[nm]=[]

basis='vdz'
element='Sc'

mol=gto.Mole()
mol.ecp={}
mol.basis={}
for el in [element,'O']:
  mol.ecp[el]=gto.basis.parse_ecp(df[el]['ecp'])
  mol.basis[el]=gto.basis.parse(df[el][basis])
mol.charge=0
mol.spin=spins[element+'O']
mol.build(atom="%s 0. 0. 0.; O 0. 0. %g"%(element,re[element+'O']),verbose=4)

m=ROHF(mol)
m.level_shift=1000.0
dm=m.from_chk("../../../../HF/monoxides/"+element+basis+"0.chk")
hf=m.kernel(dm)
m.analyze()

from pyscf.shciscf import shci
mc = shci.SHCISCF(m, 9, 4+cas[element])
#mc.fcisolver.conv_tol = 1e-14
mc.fcisolver.mpiprefix="srun -n20"
mc.fcisolver.num_thrds=12
mc.verbose = 4
cas=mc.kernel()[0]
 
from pyscf.icmpspt import icmpspt
pt=icmpspt.icmpspt(mc,rdmM=500, PTM=1000,\
                          pttype="MRLCC",\
                          third_order=True,\
                          fully_ic=True,\
                          do_dm4=True)

datacsv['basis'].append(basis)
datacsv['charge'].append(0)
datacsv['method'].append('MRPT')
datacsv['molecule'].append(element)
datacsv['pseudopotential'].append('trail')
datacsv['totalenergy'].append(cas+pt)
datacsv['totalenergy-stocherr'].append(0.0)
datacsv['totalenergy-syserr'].append(0.0)
pd.DataFrame(datacsv).to_csv(element+".csv",index=False)

#INFO: ******************** input file end ********************


System: ('Linux', 'bnode0302.rc.int.colorado.edu', '3.10.0-514.41.1.el7.x86_64', '#1 SMP Wed Jan 17 10:26:16 EST 2018', 'x86_64', 'x86_64')  Threads 28
Python 2.7.11 (default, Mar 22 2016, 01:42:54) 
[GCC Intel(R) C++ gcc 4.8 mode]
numpy 1.11.1  scipy 0.17.1
Date: Wed Apr 18 12:43:51 2018
PySCF version 1.4.6
PySCF path  /projects/bamu3429/softwares/pyscf_uptodate/pyscf
GIT ORIG_HEAD f3591ef22170896a4cdc2aadaa6f5da388ffcadb
GIT HEAD      ref: refs/heads/master
GIT master branch  1847583fb1d2472321833d3c71c8b7008e5fabf5

[INPUT] VERBOSE 4
[INPUT] num atoms = 2
[INPUT] num electrons = 17
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT]  1 Sc     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 O      0.000000000000   0.000000000000   1.668000000000 AA    0.000000000000   0.000000000000   3.152063175775 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] Sc
[INPUT] 0    0    [12   /1   ]  36.40041505       0.005374
                                19.41172108       -0.032266
                                7.76559262        0.361279
                                4.72233684        -0.858519
                                3.30202494        0.196889
                                1.73290764        0.133972
                                0.86033787        0.640189
                                0.4883664         0.334618
                                0.23725388        0.123744
                                0.10565308        -0.017421
                                0.04670613        0.010856
                                0.020926          -0.001573
[INPUT] 0    0    [12   /1   ]  36.40041505       -0.001039
                                19.41172108       0.006911
                                7.76559262        -0.089603
                                4.72233684        0.22876
                                3.30202494        -0.05839
                                1.73290764        -0.038559
                                0.86033787        -0.215849
                                0.4883664         -0.20849
                                0.23725388        -0.146275
                                0.10565308        0.350802
                                0.04670613        0.655178
                                0.020926          0.218601
[INPUT] 0    0    [12   /1   ]  36.40041505       -0.00183
                                19.41172108       0.017383
                                7.76559262        -0.306573
                                4.72233684        0.839756
                                3.30202494        -0.052081
                                1.73290764        -0.85219
                                0.86033787        -0.851788
                                0.4883664         0.410577
                                0.23725388        0.822494
                                0.10565308        0.741761
                                0.04670613        -0.631886
                                0.020926          -0.450278
[INPUT] 0    0    [1    /1   ]  0.020926             1
[INPUT] 0    0    [1    /1   ]  0.00937558           1
[INPUT] 1    0    [12   /1   ]  41.12697558       0.001162
                                22.43738592       -0.006345
                                11.2588519        0.030743
                                6.08582478        -0.083979
                                3.77549759        -0.031739
                                2.17906519        0.232763
                                1.07491872        0.420436
                                0.55241218        0.351975
                                0.2815094         0.143464
                                0.12312886        0.016009
                                0.0538551         0.000238
                                0.02355558        0.000253
[INPUT] 1    0    [12   /1   ]  41.12697558       -0.000251
                                22.43738592       0.001425
                                11.2588519        -0.007434
                                6.08582478        0.022493
                                3.77549759        0.004514
                                2.17906519        -0.065531
                                1.07491872        -0.124901
                                0.55241218        -0.130795
                                0.2815094         0.004026
                                0.12312886        0.357311
                                0.0538551         0.542386
                                0.02355558        0.222946
[INPUT] 1    0    [12   /1   ]  41.12697558       0.000719
                                22.43738592       -0.005169
                                11.2588519        0.035545
                                6.08582478        -0.125521
                                3.77549759        -0.110989
                                2.17906519        0.858227
                                1.07491872        0.397739
                                0.55241218        -0.878221
                                0.2815094         -0.616013
                                0.12312886        0.57803
                                0.0538551         0.453432
                                0.02355558        0.007472
[INPUT] 1    0    [1    /1   ]  0.02355558           1
[INPUT] 1    0    [1    /1   ]  0.01030293           1
[INPUT] 2    0    [10   /1   ]  23.41055103       -0.002062
                                9.57667856        0.014373
                                5.80916551        0.096933
                                2.24207749        0.204502
                                1.03019541        0.261896
                                0.49142269        0.31382
                                0.21727354        0.282419
                                0.10003285        0.15287
                                0.04583255        0.056392
                                0.02097146        0.002436
[INPUT] 2    0    [10   /1   ]  23.41055103       0.003535
                                9.57667856        -0.025151
                                5.80916551        -0.062521
                                2.24207749        -0.365218
                                1.03019541        -0.408516
                                0.49142269        0.106345
                                0.21727354        0.341278
                                0.10003285        0.355175
                                0.04583255        0.170429
                                0.02097146        0.018134
[INPUT] 2    0    [1    /1   ]  0.02097146           1
[INPUT] 2    0    [1    /1   ]  0.00959584           1
[INPUT] 3    0    [1    /1   ]  1.439822             1
[INPUT] 3    0    [1    /1   ]  0.65881494           1
[INPUT] O
[INPUT] 0    0    [10   /1   ]  57.663349         -0.002794
                                35.726816         0.023976
                                22.453757         -0.115974
                                14.732301         0.288033
                                9.739917          -0.274786
                                5.042008          -0.083789
                                2.157818          0.063778
                                1.002916          0.410182
                                0.421839          0.504044
                                0.173041          0.172152
[INPUT] 0    0    [1    /1   ]  0.222099             1
[INPUT] 0    0    [1    /1   ]  0.08884              1
[INPUT] 1    0    [10   /1   ]  52.47406          -0.000522
                                32.138432         0.004857
                                19.458579         -0.027749
                                11.839344         0.074258
                                7.91003           0.014369
                                3.670858          0.153479
                                1.53966           0.283685
                                0.647119          0.358201
                                0.267853          0.29559
                                0.107198          0.104889
[INPUT] 1    0    [1    /1   ]  0.252604             1
[INPUT] 1    0    [1    /1   ]  0.101042             1
[INPUT] 2    0    [1    /1   ]  1.223113             1
[INPUT] 2    0    [1    /1   ]  0.489245             1
nuclear repulsion = 20.9386666191367
number of shells = 24
number of NR pGTOs = 334
number of NR cGTOs = 76
basis = {'Sc': [[0, [36.40041505, 0.005374], [19.41172108, -0.032266], [7.76559262, 0.361279], [4.72233684, -0.858519], [3.30202494, 0.196889], [1.73290764, 0.133972], [0.86033787, 0.640189], [0.4883664, 0.334618], [0.23725388, 0.123744], [0.10565308, -0.017421], [0.04670613, 0.010856], [0.020926, -0.001573]], [0, [36.40041505, -0.001039], [19.41172108, 0.006911], [7.76559262, -0.089603], [4.72233684, 0.22876], [3.30202494, -0.05839], [1.73290764, -0.038559], [0.86033787, -0.215849], [0.4883664, -0.20849], [0.23725388, -0.146275], [0.10565308, 0.350802], [0.04670613, 0.655178], [0.020926, 0.218601]], [0, [36.40041505, -0.00183], [19.41172108, 0.017383], [7.76559262, -0.306573], [4.72233684, 0.839756], [3.30202494, -0.052081], [1.73290764, -0.85219], [0.86033787, -0.851788], [0.4883664, 0.410577], [0.23725388, 0.822494], [0.10565308, 0.741761], [0.04670613, -0.631886], [0.020926, -0.450278]], [0, [0.020926, 1.0]], [0, [0.00937558, 1.0]], [1, [41.12697558, 0.001162], [22.43738592, -0.006345], [11.2588519, 0.030743], [6.08582478, -0.083979], [3.77549759, -0.031739], [2.17906519, 0.232763], [1.07491872, 0.420436], [0.55241218, 0.351975], [0.2815094, 0.143464], [0.12312886, 0.016009], [0.0538551, 0.000238], [0.02355558, 0.000253]], [1, [41.12697558, -0.000251], [22.43738592, 0.001425], [11.2588519, -0.007434], [6.08582478, 0.022493], [3.77549759, 0.004514], [2.17906519, -0.065531], [1.07491872, -0.124901], [0.55241218, -0.130795], [0.2815094, 0.004026], [0.12312886, 0.357311], [0.0538551, 0.542386], [0.02355558, 0.222946]], [1, [41.12697558, 0.000719], [22.43738592, -0.005169], [11.2588519, 0.035545], [6.08582478, -0.125521], [3.77549759, -0.110989], [2.17906519, 0.858227], [1.07491872, 0.397739], [0.55241218, -0.878221], [0.2815094, -0.616013], [0.12312886, 0.57803], [0.0538551, 0.453432], [0.02355558, 0.007472]], [1, [0.02355558, 1.0]], [1, [0.01030293, 1.0]], [2, [23.41055103, -0.002062], [9.57667856, 0.014373], [5.80916551, 0.096933], [2.24207749, 0.204502], [1.03019541, 0.261896], [0.49142269, 0.31382], [0.21727354, 0.282419], [0.10003285, 0.15287], [0.04583255, 0.056392], [0.02097146, 0.002436]], [2, [23.41055103, 0.003535], [9.57667856, -0.025151], [5.80916551, -0.062521], [2.24207749, -0.365218], [1.03019541, -0.408516], [0.49142269, 0.106345], [0.21727354, 0.341278], [0.10003285, 0.355175], [0.04583255, 0.170429], [0.02097146, 0.018134]], [2, [0.02097146, 1.0]], [2, [0.00959584, 1.0]], [3, [1.439822, 1.0]], [3, [0.65881494, 1.0]]], 'O': [[0, [57.663349, -0.002794], [35.726816, 0.023976], [22.453757, -0.115974], [14.732301, 0.288033], [9.739917, -0.274786], [5.042008, -0.083789], [2.157818, 0.063778], [1.002916, 0.410182], [0.421839, 0.504044], [0.173041, 0.172152]], [0, [0.222099, 1.0]], [0, [0.08884, 1.0]], [1, [52.47406, -0.000522], [32.138432, 0.004857], [19.458579, -0.027749], [11.839344, 0.074258], [7.91003, 0.014369], [3.670858, 0.153479], [1.53966, 0.283685], [0.647119, 0.358201], [0.267853, 0.29559], [0.107198, 0.104889]], [1, [0.252604, 1.0]], [1, [0.101042, 1.0]], [2, [1.223113, 1.0]], [2, [0.489245, 1.0]]]}
ecp = {'Sc': [10, [[-1, [[], [[8.68432435, 11.0]], [[12.96081047, 1293.12711495], [3.42726018, -59.34807006], [13.92649869, -6626.33658022], [14.1135521, 5365.4170824]], [[3.87834215, 95.52756785]]]], [0, [[], [], [[14.11432286, -1492.86349923], [4.42835597, 1499.37242], [7.46045566, 1088.20049735], [10.23533878, -1981.91696501], [4.52489587, -1710.45115474], [13.07885945, 2625.43810581]], []]], [1, [[], [], [[9.83997641, -2070.12504374], [7.25072068, 5801.02991534], [11.81974746, 1554.97375552], [14.07433272, -853.69420879], [7.08460322, -4878.01776292], [14.07166426, 462.12967346]], []]], [2, [[], [], [[11.29849449, -570.2795343], [5.72119848, -549.4382461], [6.53234086, 1672.92599442], [8.11431019, -2704.80905453], [9.9572828, 4666.19773963], [10.24029445, -2524.96335631]], []]]]], 'O': [2, [[-1, [[], [[10.27717748, 6.0]], [[15.99566749, 1232.50197768], [10.46901775, -696.47008301], [14.6384801, -2654.22657081], [12.57591181, 2101.67732548]], [[7.77739102, 61.66306486]]]], [0, [[], [], [[12.39426073, -656683.37638839], [12.38126171, 657858.57667068], [8.57671033, 511.50098405], [9.89256508, -2579.54665641], [28.05641604, -57.68129584], [17.24753607, 970.30940152]], []]], [1, [[], [], [[14.78918914, -363027.24258186], [14.82014018, 361852.52314043], [22.89622221, -1300.20069256], [8.51331893, -181.96869573], [11.48609758, 2194.87589959], [27.22017524, 451.19906206]], []]]]]}
CPU time:         3.67


******** <class 'pyscf.scf.rohf.ROHF'> flags ********
method = ROHF
initial guess = minao
damping factor = 0
level shift factor = 1000.0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /rc_scratch/bamu3429/tmp7clqXM
max_memory 4000 MB (current use 160 MB)
num. doubly occ = 8  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -61.8293427518168
  HOMO = 499.880548749502  LUMO = 1000.01155147204
cycle= 1 E= -61.8293427518168  delta_E= -5.68e-14  |g|= 9.3e-06  |ddm|= 2.61e-08
  HOMO = -0.119451249910491  LUMO = 0.0115514721584422
Extra cycle  E= -61.8293427518576  delta_E= -4.07e-11  |g|= 8.83e-06  |ddm|= 1.57e-05
converged SCF energy = -61.8293427518576
**** MO energy ****
                Roothaan           | alpha              | beta
MO #1   energy= -2.65318619967038  | -2.65787609641968  | -2.64849630314176  occ= 2
MO #2   energy= -1.66577527428769  | -1.67090576417502  | -1.66064478559891  occ= 2
MO #3   energy= -1.62929515004875  | -1.63166000817812  | -1.62693029191938  occ= 2
MO #4   energy= -1.62929515004875  | -1.63166000817812  | -1.62693029191938  occ= 2
MO #5   energy= -1.11981543564377  | -1.12084234413067  | -1.11878852730117  occ= 2
MO #6   energy= -0.431174987976362 | -0.432732043918527 | -0.429617924251347 occ= 2
MO #7   energy= -0.420431252704916 | -0.421199606498533 | -0.419662898911299 occ= 2
MO #8   energy= -0.420431252704913 | -0.42119960649853  | -0.419662898911296 occ= 2
MO #9   energy= -0.119451249910491 | -0.248319157576534 | 0.00941663180792521 occ= 1
MO #10  energy= 0.0115514721584422 | 0.00519168258602568 | 0.0179112617308598 occ= 0
MO #11  energy= 0.0115514721584424 | 0.00519168258602579 | 0.01791126173086   occ= 0
MO #12  energy= 0.0160636708279167 | 0.0145076999725573 | 0.0176196413722279 occ= 0
MO #13  energy= 0.0230219769898079 | 0.0220437781454687 | 0.0240001839016771 occ= 0
MO #14  energy= 0.0283385226588601 | 0.028244716924761  | 0.0284323283929588 occ= 0
MO #15  energy= 0.0283385226588611 | 0.0282447169247618 | 0.0284323283929598 occ= 0
MO #16  energy= 0.0319507202167864 | 0.0314291425175803 | 0.0324722979159907 occ= 0
MO #17  energy= 0.0319507202167868 | 0.0314291425175815 | 0.0324722979159919 occ= 0
MO #18  energy= 0.0366664996222315 | 0.0365119090027003 | 0.0368210903625322 occ= 0
MO #19  energy= 0.0447423923510863 | 0.0334872225221313 | 0.0559975621800422 occ= 0
MO #20  energy= 0.0447423923510867 | 0.033487222522131  | 0.0559975621800425 occ= 0
MO #21  energy= 0.0602660904202222 | 0.0504051269038461 | 0.0701270670853755 occ= 0
MO #22  energy= 0.074844118626079  | 0.0707958662237606 | 0.0788923710283987 occ= 0
MO #23  energy= 0.0748441186260833 | 0.0707958662237649 | 0.078892371028403  occ= 0
MO #24  energy= 0.101080336489074  | 0.0999938969987777 | 0.10216677597937   occ= 0
MO #25  energy= 0.101080336489076  | 0.0999938969987804 | 0.102166775979372  occ= 0
MO #26  energy= 0.115729025590691  | 0.113914909744853  | 0.117543133029464  occ= 0
MO #27  energy= 0.134349193903872  | 0.126193662233134  | 0.142504704860409  occ= 0
MO #28  energy= 0.143020687507145  | 0.138625775554766  | 0.147415599459525  occ= 0
MO #29  energy= 0.143020687507149  | 0.138625775554769  | 0.147415599459529  occ= 0
MO #30  energy= 0.168684511832028  | 0.159046052240157  | 0.178322971423902  occ= 0
MO #31  energy= 0.168684511832028  | 0.159046052240156  | 0.1783229714239    occ= 0
MO #32  energy= 0.173870097719608  | 0.164307292027017  | 0.183432938395839  occ= 0
MO #33  energy= 0.249715616183766  | 0.242346743820655  | 0.25708448854688   occ= 0
MO #34  energy= 0.249715616183768  | 0.242346743820655  | 0.257084488546881  occ= 0
MO #35  energy= 0.386471358948589  | 0.384353392426492  | 0.388589331205587  occ= 0
MO #36  energy= 0.418363743391836  | 0.417103848509316  | 0.419623638274354  occ= 0
MO #37  energy= 0.418363743391841  | 0.417103848509324  | 0.419623638274359  occ= 0
MO #38  energy= 0.461018498427876  | 0.459313950436955  | 0.462723044432869  occ= 0
MO #39  energy= 0.8243114689142    | 0.815068176339636  | 0.833554751708278  occ= 0
MO #40  energy= 0.872298499648652  | 0.866789134684677  | 0.877807864612626  occ= 0
MO #41  energy= 0.872298499648668  | 0.866789134684696  | 0.877807864612643  occ= 0
MO #42  energy= 1.03659911625565   | 1.02911072584753   | 1.04408750666377   occ= 0
MO #43  energy= 1.03659911625566   | 1.02911072584754   | 1.04408750666377   occ= 0
MO #44  energy= 1.2546132460981    | 1.24593809143655   | 1.26328839694895   occ= 0
MO #45  energy= 1.39019820038405   | 1.3892781202176    | 1.3911182805505    occ= 0
MO #46  energy= 1.39019820038405   | 1.3892781202176    | 1.3911182805505    occ= 0
MO #47  energy= 1.46025947059364   | 1.45924269306337   | 1.46127624812392   occ= 0
MO #48  energy= 1.46025947059364   | 1.45924269306337   | 1.46127624812392   occ= 0
MO #49  energy= 1.47266818744588   | 1.47030950253955   | 1.47502687115196   occ= 0
MO #50  energy= 1.5501627324       | 1.54984510484751   | 1.55048035995249   occ= 0
MO #51  energy= 1.55016273240001   | 1.54984510484751   | 1.55048035995249   occ= 0
MO #52  energy= 1.72219786590388   | 1.71981994558969   | 1.7245757857872    occ= 0
MO #53  energy= 1.89944716631222   | 1.89620258151188   | 1.90269175111255   occ= 0
MO #54  energy= 1.89944716631222   | 1.89620258151188   | 1.90269175111255   occ= 0
MO #55  energy= 1.92443796023241   | 1.9222162346878    | 1.92665968881563   occ= 0
MO #56  energy= 2.00366706688997   | 2.00180083888544   | 2.00553329489451   occ= 0
MO #57  energy= 2.00366706688998   | 2.00180083888544   | 2.00553329489451   occ= 0
MO #58  energy= 2.01005236735285   | 2.00492958996169   | 2.01517514474401   occ= 0
MO #59  energy= 2.01005236735285   | 2.00492958996169   | 2.015175144744     occ= 0
MO #60  energy= 2.31305368205871   | 2.31154049893663   | 2.31456686632873   occ= 0
MO #61  energy= 2.44683606869879   | 2.44576403258717   | 2.44790810481042   occ= 0
MO #62  energy= 2.44683606869879   | 2.44576403258717   | 2.44790810481042   occ= 0
MO #63  energy= 3.17768544099368   | 3.17407924403769   | 3.1812916380283    occ= 0
MO #64  energy= 4.23385489010442   | 4.23369513191608   | 4.23401464829275   occ= 0
MO #65  energy= 4.23385489010442   | 4.23369513191608   | 4.23401464829275   occ= 0
MO #66  energy= 4.35268718964793   | 4.35240801365976   | 4.35296636563611   occ= 0
MO #67  energy= 4.35268718964794   | 4.35240801365976   | 4.35296636563611   occ= 0
MO #68  energy= 4.36487239158367   | 4.36435449348151   | 4.36539028971862   occ= 0
MO #69  energy= 5.23490751982425   | 5.23373722594409   | 5.23607781370441   occ= 0
MO #70  energy= 5.23490751982425   | 5.23373722594409   | 5.23607781370441   occ= 0
MO #71  energy= 5.28401934458017   | 5.28245640722687   | 5.28558228193349   occ= 0
MO #72  energy= 5.28401934458017   | 5.28245640722686   | 5.28558228193348   occ= 0
MO #73  energy= 5.45955589570882   | 5.45729631756337   | 5.46181547385428   occ= 0
MO #74  energy= 5.45955589570884   | 5.45729631756338   | 5.46181547385429   occ= 0
MO #75  energy= 5.49181062161766   | 5.48948168443489   | 5.49413955882638   occ= 0
MO #76  energy= 5.60464779268403   | 5.60314875828261   | 5.60614682707478   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0Sc 3s        1.99928
pop of  0Sc 4s        0.88925
pop of  0Sc 5s        0.00366
pop of  0Sc 6s        0.00252
pop of  0Sc 7s        0.00132
pop of  0Sc 3px       1.99910
pop of  0Sc 3py       1.99910
pop of  0Sc 3pz       1.99527
pop of  0Sc 4px       0.01224
pop of  0Sc 4py       0.01224
pop of  0Sc 4pz       0.08717
pop of  0Sc 5px       0.00017
pop of  0Sc 5py       0.00017
pop of  0Sc 5pz       0.00718
pop of  0Sc 6px       0.00058
pop of  0Sc 6py       0.00058
pop of  0Sc 6pz       0.02148
pop of  0Sc 7px       0.00009
pop of  0Sc 7py       0.00009
pop of  0Sc 7pz       0.00276
pop of  0Sc 3dxy      0.00000
pop of  0Sc 3dyz      0.31230
pop of  0Sc 3dz^2     0.47515
pop of  0Sc 3dxz      0.31230
pop of  0Sc 3dx2-y2    0.00000
pop of  0Sc 4dxy      0.00000
pop of  0Sc 4dyz      0.00038
pop of  0Sc 4dz^2     0.00720
pop of  0Sc 4dxz      0.00038
pop of  0Sc 4dx2-y2    0.00000
pop of  0Sc 5dxy      0.00000
pop of  0Sc 5dyz      0.00008
pop of  0Sc 5dz^2     0.00199
pop of  0Sc 5dxz      0.00008
pop of  0Sc 5dx2-y2    0.00000
pop of  0Sc 6dxy      0.00000
pop of  0Sc 6dyz      0.00000
pop of  0Sc 6dz^2     0.00002
pop of  0Sc 6dxz      0.00000
pop of  0Sc 6dx2-y2    0.00000
pop of  0Sc 4fy^3     0.00000
pop of  0Sc 4fxyz     0.00000
pop of  0Sc 4fyz^2    0.00024
pop of  0Sc 4fz^3     0.00044
pop of  0Sc 4fxz^2    0.00024
pop of  0Sc 4fzx^2    0.00000
pop of  0Sc 4fx^3     0.00000
pop of  0Sc 5fy^3     0.00000
pop of  0Sc 5fxyz     0.00000
pop of  0Sc 5fyz^2    0.00124
pop of  0Sc 5fz^3     0.00161
pop of  0Sc 5fxz^2    0.00124
pop of  0Sc 5fzx^2    0.00000
pop of  0Sc 5fx^3     0.00000
pop of  1O 2s        1.84783
pop of  1O 3s        0.00655
pop of  1O 4s        0.02189
pop of  1O 2px       1.66246
pop of  1O 2py       1.66246
pop of  1O 2pz       1.61915
pop of  1O 3px       0.00332
pop of  1O 3py       0.00332
pop of  1O 3pz       0.00192
pop of  1O 4px       0.00320
pop of  1O 4py       0.00320
pop of  1O 4pz       0.00220
pop of  1O 3dxy      0.00000
pop of  1O 3dyz      0.00093
pop of  1O 3dz^2     0.00124
pop of  1O 3dxz      0.00093
pop of  1O 3dx2-y2    0.00000
pop of  1O 4dxy      0.00000
pop of  1O 4dyz      0.00367
pop of  1O 4dz^2     0.00292
pop of  1O 4dxz      0.00367
pop of  1O 4dx2-y2    0.00000
 ** Mulliken atomic charges  **
charge of  0Sc =      0.85086
charge of  1O =     -0.85086

******** <class 'pyscf.mcscf.mc1step.CASSCF'> flags ********
CAS (4e+3e, 9o), ncore = 5, nvir = 62
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
chkfile = ./scratch/36429/tmpPwiZmE
max_memory 4000 MB (current use 248 MB)
internal_rotation = False

******** SHCI flags ********
executable             = /home/bamu3429/softwares/dice/Dice
mpiprefix              = srun -n20
scratchDirectory       = ./scratch/36429
integralFile           = ./FCIDUMP
configFile             = ./input.dat
outputFile             = ./output.dat
maxIter                = 6
sweep_iter             = []
sweep_epsilon          = []
nPTiter                = 0
Stochastic             = True
fullrestart            = False
restart                = False
num_thrds              = 12
memory                 = None

CASCI E = -61.8293492205318  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (7 JK  2 micro), CASSCF E = -61.8293661273584  dE = -1.6906827e-05  S^2 = 0.7500000
               |grad[o]|=6.38e-05  |grad[c]|= None  |ddm|=0.00768
macro iter 2 (7 JK  2 micro), CASSCF E = -61.8295158150499  dE = -0.00014968769  S^2 = 0.7500000
               |grad[o]|=0.000172  |grad[c]|= None  |ddm|=0.00484
macro iter 3 (21 JK  4 micro), CASSCF E = -61.8405225647624  dE = -0.01100675  S^2 = 0.7500000
               |grad[o]|=0.00167  |grad[c]|= None  |ddm|=0.035
macro iter 4 (21 JK  4 micro), CASSCF E = -61.8530943752903  dE = -0.012571811  S^2 = 0.7500000
               |grad[o]|=0.0347  |grad[c]|= None  |ddm|=0.0466
macro iter 5 (21 JK  4 micro), CASSCF E = -61.8969656965852  dE = -0.043871321  S^2 = 0.7500000
               |grad[o]|=0.038  |grad[c]|= None  |ddm|=0.0581
macro iter 6 (21 JK  4 micro), CASSCF E = -61.948252199742  dE = -0.051286503  S^2 = 0.7500000
               |grad[o]|=0.0733  |grad[c]|= None  |ddm|=0.0327
macro iter 7 (21 JK  4 micro), CASSCF E = -61.9618477012328  dE = -0.013595501  S^2 = 0.7500000
               |grad[o]|=0.0406  |grad[c]|= None  |ddm|=0.0299
macro iter 8 (21 JK  4 micro), CASSCF E = -61.9635861685666  dE = -0.0017384673  S^2 = 0.7500000
               |grad[o]|=0.00724  |grad[c]|= None  |ddm|=0.0149
macro iter 9 (21 JK  4 micro), CASSCF E = -61.9644341462112  dE = -0.00084797764  S^2 = 0.7500000
               |grad[o]|=0.00401  |grad[c]|= None  |ddm|=0.00461
macro iter 10 (20 JK  4 micro), CASSCF E = -61.964658522273  dE = -0.00022437606  S^2 = 0.7500000
               |grad[o]|=0.00276  |grad[c]|= None  |ddm|=0.0118
macro iter 11 (19 JK  4 micro), CASSCF E = -61.9648105947259  dE = -0.00015207245  S^2 = 0.7500000
               |grad[o]|=0.00224  |grad[c]|= None  |ddm|=0.0117
macro iter 12 (15 JK  4 micro), CASSCF E = -61.9648876831477  dE = -7.7088422e-05  S^2 = 0.7500000
               |grad[o]|=0.00166  |grad[c]|= None  |ddm|= 0.01
macro iter 13 (18 JK  4 micro), CASSCF E = -61.9649121658522  dE = -2.4482704e-05  S^2 = 0.7500000
               |grad[o]|=0.00116  |grad[c]|= None  |ddm|=0.00813
macro iter 14 (16 JK  3 micro), CASSCF E = -61.9649125603236  dE = -3.9447138e-07  S^2 = 0.7500000
               |grad[o]|=0.000213  |grad[c]|= None  |ddm|=0.000555
macro iter 15 (7 JK  1 micro), CASSCF E = -61.964912733275  dE = -1.7295142e-07  S^2 = 0.7500000
               |grad[o]|=9.36e-05  |grad[c]|= None  |ddm|=6.26e-05
macro iter 16 (6 JK  1 micro), CASSCF E = -61.9649140822664  dE = -1.3489914e-06  S^2 = 0.7500000
               |grad[o]|=9.42e-05  |grad[c]|= None  |ddm|=0.00264
macro iter 17 (7 JK  2 micro), CASSCF E = -61.9649486480364  dE = -3.456577e-05  S^2 = 0.7500000
               |grad[o]|=0.000299  |grad[c]|= None  |ddm|=0.00539
macro iter 18 (21 JK  4 micro), CASSCF E = -61.9666418813414  dE = -0.0016932333  S^2 = 0.7500000
               |grad[o]|=0.00176  |grad[c]|= None  |ddm|=0.00623
macro iter 19 (21 JK  4 micro), CASSCF E = -61.9677774107322  dE = -0.0011355294  S^2 = 0.7500000
               |grad[o]|=0.00362  |grad[c]|= None  |ddm|=0.00388
macro iter 20 (16 JK  4 micro), CASSCF E = -61.9678221613907  dE = -4.4750659e-05  S^2 = 0.7500000
               |grad[o]|=0.00178  |grad[c]|= None  |ddm|=0.00292
macro iter 21 (14 JK  2 micro), CASSCF E = -61.9678227159585  dE = -5.5456775e-07  S^2 = 0.7500000
               |grad[o]|=0.000211  |grad[c]|= None  |ddm|=0.0002
macro iter 22 (3 JK  1 micro), CASSCF E = -61.9678227222035  dE = -6.2450454e-09  S^2 = 0.7500000
               |grad[o]|=4e-05  |grad[c]|= None  |ddm|=2.43e-05
1-step CASSCF converged in 22 macro (344 JK 70 micro) steps
CASSCF canonicalization
CASSCF energy = -61.9678227222035


--------------------------------------------------
                 ICMPSPT CALCULATION              
--------------------------------------------------

Perturbation type: MRLCC
With fully internally contracted scheme
With third order correction

Preparing necessary RDMs
......production of RDMs took      62.11 sec
Reading binary 4RDM from DICE
......reading the RDM took         28.17 sec

(GOOD) Trace 4RDM:    840.0 =    7*    6*    5*    4
(GOOD) Trace 3RDM:    210.0 =    7*    6*    5
(GOOD) Trace 2RDM:     42.0 =    7*    6
(GOOD) Trace 1RDM:      7.0 =    7

Producing the integrals
......production of INT took      42.21 sec

Energy_core =  -70.26520646
Energy      =  -61.96782272

WARNING: Have to use natural orbitals from CAASCF
         offdiagonal elements:    0.46895573

Basic ingredients written to int/
......savings of INGREDIENTS took      36.69 sec

Second-order:
perturber CCVV --        -0.166311862
perturber CCAV --        -0.062212512
perturber ACVV --        -0.059296347
perturber CCAA --        -0.020526083
perturber AAVV --        -0.051682284
perturber CAAV --        -0.069961942
