#INFO: **** input file is /projects/bamu3429/BENCHMARK/fresh_atoms/MRPT/vdz/atoms/Fe_0/mrpt.py ****
import json
from pyscf import gto,scf,mcscf, fci, lo, ci, cc
from pyscf.scf import ROHF, UHF,ROKS
import numpy as np
import pandas as pd

# THIS IS WERE IT STARTS ====================================

df=json.load(open("../../../trail.json"))

spins={'Sc':1, 'Ti':2, 'V':3, 'Cr':6, 'Mn':5, 'Fe':4, 'Cu':1}

nd={'Sc':(1,0), 'Ti':(2,0), 'V':(3,0), 'Cr':(5,0), 'Mn':(5,0), 'Fe':(5,1), 'Cu':(5,5)}

cas={'Sc':3, 'Ti':4, 'V':5, 'Cr':6, 'Mn':7, 'Fe':8, 'Cu':11}

datacsv={}
for nm in ['atom','charge','method','basis','pseudopotential','hf',
           'totalenergy','totalenergy-stocherr','totalenergy-syserr']:
  datacsv[nm]=[]

basis='vdz'
el='Fe'
charge=0

mol=gto.Mole()
mol.ecp={}
mol.basis={}
mol.ecp[el]=gto.basis.parse_ecp(df[el]['ecp'])
mol.basis[el]=gto.basis.parse(df[el][basis])
mol.charge=charge
if el == 'Cr' or el == 'Cu':
  mol.spin=spins[el]-charge
else:
  mol.spin=spins[el]+charge
mol.build(atom="%s 0. 0. 0."%el,verbose=4)

m=ROHF(mol)
m.level_shift=1000.0
dm=m.from_chk("../../../../HF/atoms/"+el+basis+str(charge)+".chk")
hf=m.kernel(dm)
m.analyze()

from pyscf.shciscf import shci
mc = shci.SHCISCF(m, 6, cas[el]-charge)
#mc.fcisolver.conv_tol = 1e-14
mc.fcisolver.mpiprefix="srun -n20"
mc.fcisolver.num_thrds=12
mc.verbose = 4
cas=mc.kernel()[0]
 
from pyscf.icmpspt import icmpspt
pt=icmpspt.icmpspt(mc,rdmM=500, PTM=1000,\
                          pttype="MRLCC",\
                          third_order=True,\
                          fully_ic=True,\
                          do_dm4=True)

datacsv['atom'].append(el)
datacsv['charge'].append(charge)
datacsv['method'].append('MRPT')
datacsv['basis'].append(basis)
datacsv['pseudopotential'].append('trail')
datacsv['hf'].append(hf)
datacsv['totalenergy'].append(cas+pt)
datacsv['totalenergy-stocherr'].append(0.0)
datacsv['totalenergy-syserr'].append(0.0)
pd.DataFrame(datacsv).to_csv(el+".csv",index=False)

#INFO: ******************** input file end ********************


System: ('Linux', 'bnode0302.rc.int.colorado.edu', '3.10.0-514.41.1.el7.x86_64', '#1 SMP Wed Jan 17 10:26:16 EST 2018', 'x86_64', 'x86_64')  Threads 28
Python 2.7.11 (default, Mar 22 2016, 01:42:54) 
[GCC Intel(R) C++ gcc 4.8 mode]
numpy 1.11.1  scipy 0.17.1
Date: Wed Apr 18 12:11:03 2018
PySCF version 1.4.6
PySCF path  /projects/bamu3429/softwares/pyscf_uptodate/pyscf
GIT ORIG_HEAD f3591ef22170896a4cdc2aadaa6f5da388ffcadb
GIT HEAD      ref: refs/heads/master
GIT master branch  1847583fb1d2472321833d3c71c8b7008e5fabf5

[INPUT] VERBOSE 4
[INPUT] num atoms = 1
[INPUT] num electrons = 16
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 4
[INPUT] symmetry False subgroup None
[INPUT]  1 Fe     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] Fe
[INPUT] 0    0    [12   /1   ]  41.79315189       0.013363
                                21.4479766        -0.225831
                                13.50597996       1.092302
                                9.47978339        -1.379238
                                4.48116767        0.183004
                                2.00533715        0.377557
                                1.21557711        0.591529
                                0.52042955        0.236703
                                0.24120153        -0.029854
                                0.11142434        0.02048
                                0.05213724        -0.006828
                                0.02419858        0.002604
[INPUT] 0    0    [12   /1   ]  41.79315189       -0.002034
                                21.4479766        0.04181
                                13.50597996       -0.22265
                                9.47978339        0.296462
                                4.48116767        -0.039261
                                2.00533715        -0.090727
                                1.21557711        -0.230375
                                0.52042955        -0.197211
                                0.24120153        0.111234
                                0.11142434        0.439139
                                0.05213724        0.516418
                                0.02419858        0.126845
[INPUT] 0    0    [12   /1   ]  41.79315189       -0.004323
                                21.4479766        0.132016
                                13.50597996       -0.841007
                                9.47978339        1.270608
                                4.48116767        -0.357855
                                2.00533715        -1.172638
                                1.21557711        0.080918
                                0.52042955        0.564238
                                0.24120153        0.803759
                                0.11142434        0.166439
                                0.05213724        -0.599817
                                0.02419858        -0.320989
[INPUT] 0    0    [1    /1   ]  0.02419858           1
[INPUT] 0    0    [1    /1   ]  0.01123134           1
[INPUT] 1    0    [12   /1   ]  66.19105244       0.00032
                                34.58074578       -0.003142
                                17.77781378       0.029707
                                9.38371315        -0.152873
                                5.85185491        0.094627
                                3.39352009        0.227547
                                1.80084269        0.448024
                                0.88349057        0.318306
                                0.45376195        0.097682
                                0.18864625        0.012314
                                0.07756623        -0.001004
                                0.03189313        0.000474
[INPUT] 1    0    [12   /1   ]  66.19105244       -1.8e-05
                                34.58074578       0.000416
                                17.77781378       -0.005911
                                9.38371315        0.03555
                                5.85185491        -0.025962
                                3.39352009        -0.059781
                                1.80084269        -0.122371
                                0.88349057        -0.102075
                                0.45376195        0.039881
                                0.18864625        0.346137
                                0.07756623        0.528115
                                0.03189313        0.237416
[INPUT] 1    0    [12   /1   ]  66.19105244       -0.000834
                                34.58074578       0.002604
                                17.77781378       0.016549
                                9.38371315        -0.211504
                                5.85185491        0.182022
                                3.39352009        0.789997
                                1.80084269        0.110593
                                0.88349057        -0.853215
                                0.45376195        -0.426908
                                0.18864625        0.584503
                                0.07756623        0.418096
                                0.03189313        0.004159
[INPUT] 1    0    [1    /1   ]  0.03189313           1
[INPUT] 1    0    [1    /1   ]  0.01311358           1
[INPUT] 2    0    [10   /1   ]  58.21685909       0.000311
                                24.96806153       -0.010386
                                12.44413704       0.126915
                                5.48395408        0.166806
                                2.79137309        0.262721
                                1.34407118        0.316542
                                0.61230651        0.280074
                                0.27095461        0.158069
                                0.12811374        0.049028
                                0.05904405        0.008369
[INPUT] 2    0    [10   /1   ]  58.21685909       0.000264
                                24.96806153       0.008003
                                12.44413704       -0.131894
                                5.48395408        -0.228203
                                2.79137309        -0.382561
                                1.34407118        -0.063105
                                0.61230651        0.332607
                                0.27095461        0.402603
                                0.12811374        0.213988
                                0.05904405        0.04923
[INPUT] 2    0    [1    /1   ]  0.05904405           1
[INPUT] 2    0    [1    /1   ]  0.02721175           1
[INPUT] 3    0    [1    /1   ]  2.703381             1
[INPUT] 3    0    [1    /1   ]  1.2459129            1
nuclear repulsion = 0
number of shells = 16
number of NR pGTOs = 276
number of NR cGTOs = 54
basis = {'Fe': [[0, [41.79315189, 0.013363], [21.4479766, -0.225831], [13.50597996, 1.092302], [9.47978339, -1.379238], [4.48116767, 0.183004], [2.00533715, 0.377557], [1.21557711, 0.591529], [0.52042955, 0.236703], [0.24120153, -0.029854], [0.11142434, 0.02048], [0.05213724, -0.006828], [0.02419858, 0.002604]], [0, [41.79315189, -0.002034], [21.4479766, 0.04181], [13.50597996, -0.22265], [9.47978339, 0.296462], [4.48116767, -0.039261], [2.00533715, -0.090727], [1.21557711, -0.230375], [0.52042955, -0.197211], [0.24120153, 0.111234], [0.11142434, 0.439139], [0.05213724, 0.516418], [0.02419858, 0.126845]], [0, [41.79315189, -0.004323], [21.4479766, 0.132016], [13.50597996, -0.841007], [9.47978339, 1.270608], [4.48116767, -0.357855], [2.00533715, -1.172638], [1.21557711, 0.080918], [0.52042955, 0.564238], [0.24120153, 0.803759], [0.11142434, 0.166439], [0.05213724, -0.599817], [0.02419858, -0.320989]], [0, [0.02419858, 1.0]], [0, [0.01123134, 1.0]], [1, [66.19105244, 0.00032], [34.58074578, -0.003142], [17.77781378, 0.029707], [9.38371315, -0.152873], [5.85185491, 0.094627], [3.39352009, 0.227547], [1.80084269, 0.448024], [0.88349057, 0.318306], [0.45376195, 0.097682], [0.18864625, 0.012314], [0.07756623, -0.001004], [0.03189313, 0.000474]], [1, [66.19105244, -1.8e-05], [34.58074578, 0.000416], [17.77781378, -0.005911], [9.38371315, 0.03555], [5.85185491, -0.025962], [3.39352009, -0.059781], [1.80084269, -0.122371], [0.88349057, -0.102075], [0.45376195, 0.039881], [0.18864625, 0.346137], [0.07756623, 0.528115], [0.03189313, 0.237416]], [1, [66.19105244, -0.000834], [34.58074578, 0.002604], [17.77781378, 0.016549], [9.38371315, -0.211504], [5.85185491, 0.182022], [3.39352009, 0.789997], [1.80084269, 0.110593], [0.88349057, -0.853215], [0.45376195, -0.426908], [0.18864625, 0.584503], [0.07756623, 0.418096], [0.03189313, 0.004159]], [1, [0.03189313, 1.0]], [1, [0.01311358, 1.0]], [2, [58.21685909, 0.000311], [24.96806153, -0.010386], [12.44413704, 0.126915], [5.48395408, 0.166806], [2.79137309, 0.262721], [1.34407118, 0.316542], [0.61230651, 0.280074], [0.27095461, 0.158069], [0.12811374, 0.049028], [0.05904405, 0.008369]], [2, [58.21685909, 0.000264], [24.96806153, 0.008003], [12.44413704, -0.131894], [5.48395408, -0.228203], [2.79137309, -0.382561], [1.34407118, -0.063105], [0.61230651, 0.332607], [0.27095461, 0.402603], [0.12811374, 0.213988], [0.05904405, 0.04923]], [2, [0.05904405, 1.0]], [2, [0.02721175, 1.0]], [3, [2.703381, 1.0]], [3, [1.2459129, 1.0]]]}
ecp = {'Fe': [10, [[-1, [[], [[16.90683491, 16.0]], [[18.40258134, 26847.81569895], [6.30300831, -133.54888707], [18.42848726, -26765.4049232], [18.43432023, 1.00742417]], [[7.01300654, 270.50935856]]]], [0, [[], [], [[9.62463353, 20308.8999348], [9.1270955, -17595.21707731], [7.5416384, 1884.69012383], [12.70900949, -4483.50209856], [8.14863339, -1094.38597968], [16.27611739, 1032.95376659]], []]], [1, [[], [], [[11.36514719, -905.00711112], [14.56762424, 34640.9358259], [15.05861359, -42299.94223895], [17.41337089, 10633.68808757], [18.3746752, -5844.19723669], [17.04734437, 3803.80414779]], []]], [2, [[], [], [[10.13935738, -11031.18647055], [13.45796076, 16711.37502047], [10.97387824, 37989.95033676], [11.92919033, -41782.92514683], [17.7123012, 3812.58339812], [17.32108913, -5718.00854971]], []]]]]}
CPU time:         3.75


******** <class 'pyscf.scf.rohf.ROHF'> flags ********
method = ROHF
initial guess = minao
damping factor = 0
level shift factor = 1000.0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /rc_scratch/bamu3429/tmpA2_YHN
max_memory 4000 MB (current use 100 MB)
num. doubly occ = 6  num. singly occ = 4
Set gradient conv threshold to 3.16228e-05
init E= -123.036061010216
  HOMO = 499.850605063579  LUMO = 1000.01973248698
cycle= 1 E= -123.036061010216  delta_E= -3.55e-13  |g|= 1.57e-05  |ddm|= 5.6e-08
  HOMO = -0.149394937669965  LUMO = 0.0197324869844126
Extra cycle  E= -123.036061010282  delta_E= -6.57e-11  |g|= 1.06e-05  |ddm|= 5.1e-05
converged SCF energy = -123.036061010282
**** MO energy ****
                Roothaan           | alpha              | beta
MO #1   energy= -4.42216091911884  | -4.60781083256967  | -4.2365109944821   occ= 2
MO #2   energy= -2.80719016108822  | -3.07874707004583  | -2.5356332521306   occ= 2
MO #3   energy= -2.79858983247842  | -3.00245878753524  | -2.5947208774216   occ= 2
MO #4   energy= -2.79797378619163  | -2.99750527356526  | -2.59844229881801  occ= 2
MO #5   energy= -0.55114429340647  | -0.616153174844183 | -0.486135412271865 occ= 2
MO #6   energy= -0.263291760048523 | -0.277528239209361 | -0.249055590902428 occ= 2
MO #7   energy= -0.198787706041976 | -0.709258155834899 | 0.311682893092806  occ= 1
MO #8   energy= -0.187528370376144 | -0.699380610792204 | 0.324323695021521  occ= 1
MO #9   energy= -0.185174597690537 | -0.697340185516742 | 0.326990870114764  occ= 1
MO #10  energy= -0.149394937669965 | -0.665918565757602 | 0.367128380910775  occ= 1
MO #11  energy= 0.0197324869844126 | 0.0183528970292349 | 0.0211120769395923 occ= 0
MO #12  energy= 0.0209818031361527 | 0.0200679291959954 | 0.0218956770763114 occ= 0
MO #13  energy= 0.021060584717388  | 0.0201755054222501 | 0.0219456640125249 occ= 0
MO #14  energy= 0.0236011772257871 | 0.0231086670970921 | 0.0240936868864614 occ= 0
MO #15  energy= 0.0640931605691819 | 0.0605746208981651 | 0.0676117002401992 occ= 0
MO #16  energy= 0.0670666903571315 | 0.0643201356855044 | 0.069813245028759  occ= 0
MO #17  energy= 0.0672637632385375 | 0.06457595569016   | 0.0699515707869135 occ= 0
MO #18  energy= 0.0829984165487669 | 0.0828423919021517 | 0.0831544301598642 occ= 0
MO #19  energy= 0.0830746216964778 | 0.0829145090567828 | 0.0832347258365731 occ= 0
MO #20  energy= 0.0830956794524822 | 0.082934924680101  | 0.0832564238229761 occ= 0
MO #21  energy= 0.0833338349949649 | 0.0832783441238084 | 0.0833893258084056 occ= 0
MO #22  energy= 0.083351618751588  | 0.0831786591091602 | 0.0835245647004418 occ= 0
MO #23  energy= 0.196408760067532  | 0.191036047672962  | 0.201781472636536  occ= 0
MO #24  energy= 0.251548000165421  | 0.246569466512476  | 0.256526631038602  occ= 0
MO #25  energy= 0.252274715800201  | 0.247155621734129  | 0.257393870413795  occ= 0
MO #26  energy= 0.25244840949254   | 0.247306051516747  | 0.257590804820464  occ= 0
MO #27  energy= 0.252845997726655  | 0.25108191596064   | 0.254610078598149  occ= 0
MO #28  energy= 0.254970077342167  | 0.249416516788348  | 0.260523762042863  occ= 0
MO #29  energy= 0.273102042513498  | 0.257298561713386  | 0.288905523313611  occ= 0
MO #30  energy= 0.280954429812671  | 0.268284450515139  | 0.293624409110203  occ= 0
MO #31  energy= 0.281481146727598  | 0.269041337308452  | 0.293920956146745  occ= 0
MO #32  energy= 1.71743156889209   | 1.68773718058395   | 1.7471259528523    occ= 0
MO #33  energy= 1.72713202401582   | 1.6257140392715    | 1.82854994781474   occ= 0
MO #34  energy= 1.73656459656293   | 1.63505180158396   | 1.83807751451213   occ= 0
MO #35  energy= 1.73807204422731   | 1.63634158017582   | 1.83980260134886   occ= 0
MO #36  energy= 1.76120350911248   | 1.65608288848678   | 1.8663243287917    occ= 0
MO #37  energy= 1.84812990706433   | 1.79764094799614   | 1.89861899627794   occ= 0
MO #38  energy= 3.45011692124584   | 3.35936896416067   | 3.540864878331     occ= 0
MO #39  energy= 3.48364643179834   | 3.41249164326434   | 3.55480122033233   occ= 0
MO #40  energy= 3.48568446631836   | 3.41546818359224   | 3.55590074904448   occ= 0
MO #41  energy= 3.57993442433591   | 3.48234827591541   | 3.67752057275642   occ= 0
MO #42  energy= 3.58044975582067   | 3.4927150453908    | 3.66818446625055   occ= 0
MO #43  energy= 3.5816004268403    | 3.49617825362989   | 3.66702260005072   occ= 0
MO #44  energy= 3.5818239629747    | 3.50513373314991   | 3.65851419279948   occ= 0
MO #45  energy= 3.59303035733369   | 3.48737680503233   | 3.69868390963505   occ= 0
MO #46  energy= 3.59581299522656   | 3.51828089377203   | 3.6733450966811    occ= 0
MO #47  energy= 3.59585019599899   | 3.51958886385387   | 3.67211152814412   occ= 0
MO #48  energy= 9.63696830672617   | 9.52578097056824   | 9.74815564288409   occ= 0
MO #49  energy= 9.64027845917104   | 9.53180764107789   | 9.74874927726418   occ= 0
MO #50  energy= 9.64191926066667   | 9.53354494806588   | 9.75029357326746   occ= 0
MO #51  energy= 9.65190996066626   | 9.56789718991892   | 9.73592273141358   occ= 0
MO #52  energy= 9.65477111187869   | 9.53732264070276   | 9.7722195830546    occ= 0
MO #53  energy= 9.67274136179893   | 9.59689462857541   | 9.74858809502245   occ= 0
MO #54  energy= 9.67281182859831   | 9.59637169814553   | 9.74925195905109   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0Fe 3s        1.99997
pop of  0Fe 4s        1.99784
pop of  0Fe 5s        0.00063
pop of  0Fe 6s        0.00079
pop of  0Fe 7s        0.00028
pop of  0Fe 3px       1.99988
pop of  0Fe 3py       1.99988
pop of  0Fe 3pz       1.99986
pop of  0Fe 4px       0.00004
pop of  0Fe 4py       0.00004
pop of  0Fe 4pz       0.00009
pop of  0Fe 5px       0.00001
pop of  0Fe 5py       0.00001
pop of  0Fe 5pz       0.00001
pop of  0Fe 6px       0.00000
pop of  0Fe 6py       0.00000
pop of  0Fe 6pz       0.00000
pop of  0Fe 7px       0.00000
pop of  0Fe 7py       0.00000
pop of  0Fe 7pz       0.00000
pop of  0Fe 3dxy      1.94539
pop of  0Fe 3dyz      1.00321
pop of  0Fe 3dz^2     0.99768
pop of  0Fe 3dxz      1.04684
pop of  0Fe 3dx2-y2    0.99836
pop of  0Fe 4dxy      0.00009
pop of  0Fe 4dyz      0.00154
pop of  0Fe 4dz^2     0.00181
pop of  0Fe 4dxz      0.00145
pop of  0Fe 4dx2-y2    0.00107
pop of  0Fe 5dxy      0.00009
pop of  0Fe 5dyz      0.00075
pop of  0Fe 5dz^2     0.00091
pop of  0Fe 5dxz      0.00070
pop of  0Fe 5dx2-y2    0.00056
pop of  0Fe 6dxy      0.00000
pop of  0Fe 6dyz      0.00001
pop of  0Fe 6dz^2     0.00001
pop of  0Fe 6dxz      0.00001
pop of  0Fe 6dx2-y2    0.00001
pop of  0Fe 4fy^3     0.00002
pop of  0Fe 4fxyz     0.00000
pop of  0Fe 4fyz^2    0.00001
pop of  0Fe 4fz^3     0.00002
pop of  0Fe 4fxz^2    0.00001
pop of  0Fe 4fzx^2    0.00001
pop of  0Fe 4fx^3     0.00003
pop of  0Fe 5fy^3     0.00003
pop of  0Fe 5fxyz     0.00000
pop of  0Fe 5fyz^2    0.00000
pop of  0Fe 5fz^3     0.00001
pop of  0Fe 5fxz^2    0.00000
pop of  0Fe 5fzx^2    0.00000
pop of  0Fe 5fx^3     0.00003
 ** Mulliken atomic charges  **
charge of  0Fe =     -0.00000

******** <class 'pyscf.mcscf.mc1step.CASSCF'> flags ********
CAS (6e+2e, 6o), ncore = 4, nvir = 44
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
chkfile = ./scratch/837/tmpTuwmch
max_memory 4000 MB (current use 139 MB)
internal_rotation = False

******** SHCI flags ********
executable             = /home/bamu3429/softwares/dice/Dice
mpiprefix              = srun -n20
scratchDirectory       = ./scratch/837
integralFile           = ./FCIDUMP
configFile             = ./input.dat
outputFile             = ./output.dat
maxIter                = 6
sweep_iter             = []
sweep_epsilon          = []
nPTiter                = 0
Stochastic             = True
fullrestart            = False
restart                = False
num_thrds              = 12
memory                 = None


ERROR: srun -n20 /home/bamu3429/softwares/dice/Dice ./input.dat > ./output.dat 2>&1

