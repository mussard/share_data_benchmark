#INFO: **** input file is /projects/bamu3429/BENCHMARK/fresh_atoms/MRPT/vtz/atoms/Ti_0/mrpt.py ****
import json
from pyscf import gto,scf,mcscf, fci, lo, ci, cc
from pyscf.scf import ROHF, UHF,ROKS
import numpy as np
import pandas as pd

# THIS IS WERE IT STARTS ====================================

df=json.load(open("../../../trail.json"))

spins={'Sc':1, 'Ti':2, 'V':3, 'Cr':6, 'Mn':5, 'Fe':4, 'Cu':1}

nd={'Sc':(1,0), 'Ti':(2,0), 'V':(3,0), 'Cr':(5,0), 'Mn':(5,0), 'Fe':(5,1), 'Cu':(5,5)}

cas={'Sc':3, 'Ti':4, 'V':5, 'Cr':6, 'Mn':7, 'Fe':8, 'Cu':11}

datacsv={}
for nm in ['atom','charge','method','basis','pseudopotential','hf',
           'totalenergy','totalenergy-stocherr','totalenergy-syserr']:
  datacsv[nm]=[]

basis='vtz'
el='Ti'
charge=0

mol=gto.Mole()
mol.ecp={}
mol.basis={}
mol.ecp[el]=gto.basis.parse_ecp(df[el]['ecp'])
mol.basis[el]=gto.basis.parse(df[el][basis])
mol.charge=charge
if el == 'Cr' or el == 'Cu':
  mol.spin=spins[el]-charge
else:
  mol.spin=spins[el]+charge
mol.build(atom="%s 0. 0. 0."%el,verbose=4)

m=ROHF(mol)
m.level_shift=1000.0
dm=m.from_chk("../../../../HF/atoms/"+el+basis+str(charge)+".chk")
hf=m.kernel(dm)
m.analyze()

from pyscf.shciscf import shci
mc = shci.SHCISCF(m, 6, cas[el]-charge)
#mc.fcisolver.conv_tol = 1e-14
mc.fcisolver.mpiprefix="srun -n20"
mc.fcisolver.num_thrds=12
mc.verbose = 4
cas=mc.kernel()[0]
 
from pyscf.icmpspt import icmpspt
pt=icmpspt.icmpspt(mc,rdmM=500, PTM=1000,\
                          pttype="MRLCC",\
                          third_order=True,\
                          fully_ic=True,\
                          do_dm4=True)

datacsv['atom'].append(el)
datacsv['charge'].append(charge)
datacsv['method'].append('MRPT')
datacsv['basis'].append(basis)
datacsv['pseudopotential'].append('trail')
datacsv['hf'].append(hf)
datacsv['totalenergy'].append(cas+pt)
datacsv['totalenergy-stocherr'].append(0.0)
datacsv['totalenergy-syserr'].append(0.0)
pd.DataFrame(datacsv).to_csv(el+".csv",index=False)

#INFO: ******************** input file end ********************


System: ('Linux', 'bnode0302.rc.int.colorado.edu', '3.10.0-514.41.1.el7.x86_64', '#1 SMP Wed Jan 17 10:26:16 EST 2018', 'x86_64', 'x86_64')  Threads 28
Python 2.7.11 (default, Mar 22 2016, 01:42:54) 
[GCC Intel(R) C++ gcc 4.8 mode]
numpy 1.11.1  scipy 0.17.1
Date: Wed Apr 18 15:41:27 2018
PySCF version 1.4.6
PySCF path  /projects/bamu3429/softwares/pyscf_uptodate/pyscf
GIT ORIG_HEAD f3591ef22170896a4cdc2aadaa6f5da388ffcadb
GIT HEAD      ref: refs/heads/master
GIT master branch  1847583fb1d2472321833d3c71c8b7008e5fabf5

[INPUT] VERBOSE 4
[INPUT] num atoms = 1
[INPUT] num electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 2
[INPUT] symmetry False subgroup None
[INPUT]  1 Ti     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] Ti
[INPUT] 0    0    [12   /1   ]  37.13946663       0.002411
                                11.66061728       -0.575963
                                8.9751153         2.645948
                                7.67011905        -2.362876
                                3.44923714        -0.059842
                                1.58705441        0.244002
                                0.95387432        0.58593
                                0.47300537        0.378609
                                0.2203041         0.031099
                                0.10349534        0.004602
                                0.04822069        0.000609
                                0.0226639         0.001044
[INPUT] 0    0    [12   /1   ]  37.13946663       -0.000363
                                11.66061728       0.129591
                                8.9751153         -0.625086
                                7.67011905        0.572499
                                3.44923714        0.016652
                                1.58705441        -0.073052
                                0.95387432        -0.203234
                                0.47300537        -0.251131
                                0.2203041         -0.044619
                                0.10349534        0.38905
                                0.04822069        0.591401
                                0.0226639         0.208165
[INPUT] 0    0    [12   /1   ]  37.13946663       -0.001048
                                11.66061728       0.513626
                                8.9751153         -2.6299
                                7.67011905        2.506927
                                3.44923714        0.034363
                                1.58705441        -1.199876
                                0.95387432        -0.360111
                                0.47300537        0.526538
                                0.2203041         0.906119
                                0.10349534        0.354604
                                0.04822069        -0.569496
                                0.0226639         -0.388471
[INPUT] 0    0    [12   /1   ]  37.13946663       -0.002126
                                11.66061728       0.777822
                                8.9751153         -4.101997
                                7.67011905        4.037004
                                3.44923714        -0.301669
                                1.58705441        -2.544268
                                0.95387432        1.067498
                                0.47300537        2.188092
                                0.2203041         -0.737717
                                0.10349534        -1.595594
                                0.04822069        0.519723
                                0.0226639         0.702092
[INPUT] 0    0    [1    /1   ]  0.0226639            1
[INPUT] 0    0    [1    /1   ]  0.01065211           1
[INPUT] 1    0    [12   /1   ]  44.38520603       0.000557
                                23.85822456       -0.004857
                                12.73507149       0.027448
                                6.00842867        -0.150306
                                3.96301478        0.092203
                                2.13751474        0.210744
                                1.20712576        0.397756
                                0.62000194        0.354359
                                0.30900057        0.130823
                                0.12918293        0.012952
                                0.05400711        -0.000125
                                0.02257859        0.000245
[INPUT] 1    0    [12   /1   ]  44.38520603       -7.7e-05
                                23.85822456       0.000906
                                12.73507149       -0.006126
                                6.00842867        0.038285
                                3.96301478        -0.027356
                                2.13751474        -0.059665
                                1.20712576        -0.115513
                                0.62000194        -0.130421
                                0.30900057        0.025358
                                0.12918293        0.394962
                                0.05400711        0.54831
                                0.02257859        0.169017
[INPUT] 1    0    [12   /1   ]  44.38520603       0.000257
                                23.85822456       -0.004273
                                12.73507149       0.034307
                                6.00842867        -0.26758
                                3.96301478        0.2157
                                2.13751474        0.80689
                                1.20712576        0.194864
                                0.62000194        -0.88026
                                0.30900057        -0.530792
                                0.12918293        0.664296
                                0.05400711        0.379472
                                0.02257859        -0.003174
[INPUT] 1    0    [12   /1   ]  44.38520603       0.000117
                                23.85822456       -0.005201
                                12.73507149       0.057541
                                6.00842867        -0.690259
                                3.96301478        1.21697
                                2.13751474        1.017989
                                1.20712576        -1.674556
                                0.62000194        -0.722613
                                0.30900057        1.629515
                                0.12918293        -0.172012
                                0.05400711        -0.594627
                                0.02257859        0.019229
[INPUT] 1    0    [1    /1   ]  0.02257859           1
[INPUT] 1    0    [1    /1   ]  0.00943936           1
[INPUT] 2    0    [10   /1   ]  29.31465998       -0.000519
                                13.63067536       -0.007186
                                8.04907964        0.095441
                                3.25682476        0.170565
                                1.474054          0.27882
                                0.66141289        0.324798
                                0.29673638        0.280135
                                0.13456087        0.172066
                                0.06095666        0.058237
                                0.02784531        0.004588
[INPUT] 2    0    [10   /1   ]  29.31465998       0.002823
                                13.63067536       -0.006527
                                8.04907964        -0.061261
                                3.25682476        -0.257858
                                1.474054          -0.489583
                                0.66141289        0.014563
                                0.29673638        0.349211
                                0.13456087        0.382975
                                0.06095666        0.175115
                                0.02784531        0.017645
[INPUT] 2    0    [10   /1   ]  29.31465998       0.007279
                                13.63067536       -0.0349
                                8.04907964        0.005127
                                3.25682476        -0.547554
                                1.474054          -0.249327
                                0.66141289        0.883201
                                0.29673638        0.185008
                                0.13456087        -0.439752
                                0.06095666        -0.35135
                                0.02784531        -0.032892
[INPUT] 2    0    [1    /1   ]  0.02784531           1
[INPUT] 2    0    [1    /1   ]  0.01271987           1
[INPUT] 3    0    [1    /1   ]  2.226593             1
[INPUT] 3    0    [1    /1   ]  0.630802             1
[INPUT] 3    0    [1    /1   ]  0.17870852           1
[INPUT] 4    0    [1    /1   ]  2.043434             1
[INPUT] 4    0    [1    /1   ]  0.57891237           1
nuclear repulsion = 0
number of shells = 22
number of NR pGTOs = 399
number of NR cGTOs = 88
basis = {'Ti': [[0, [37.13946663, 0.002411], [11.66061728, -0.575963], [8.9751153, 2.645948], [7.67011905, -2.362876], [3.44923714, -0.059842], [1.58705441, 0.244002], [0.95387432, 0.58593], [0.47300537, 0.378609], [0.2203041, 0.031099], [0.10349534, 0.004602], [0.04822069, 0.000609], [0.0226639, 0.001044]], [0, [37.13946663, -0.000363], [11.66061728, 0.129591], [8.9751153, -0.625086], [7.67011905, 0.572499], [3.44923714, 0.016652], [1.58705441, -0.073052], [0.95387432, -0.203234], [0.47300537, -0.251131], [0.2203041, -0.044619], [0.10349534, 0.38905], [0.04822069, 0.591401], [0.0226639, 0.208165]], [0, [37.13946663, -0.001048], [11.66061728, 0.513626], [8.9751153, -2.6299], [7.67011905, 2.506927], [3.44923714, 0.034363], [1.58705441, -1.199876], [0.95387432, -0.360111], [0.47300537, 0.526538], [0.2203041, 0.906119], [0.10349534, 0.354604], [0.04822069, -0.569496], [0.0226639, -0.388471]], [0, [37.13946663, -0.002126], [11.66061728, 0.777822], [8.9751153, -4.101997], [7.67011905, 4.037004], [3.44923714, -0.301669], [1.58705441, -2.544268], [0.95387432, 1.067498], [0.47300537, 2.188092], [0.2203041, -0.737717], [0.10349534, -1.595594], [0.04822069, 0.519723], [0.0226639, 0.702092]], [0, [0.0226639, 1.0]], [0, [0.01065211, 1.0]], [1, [44.38520603, 0.000557], [23.85822456, -0.004857], [12.73507149, 0.027448], [6.00842867, -0.150306], [3.96301478, 0.092203], [2.13751474, 0.210744], [1.20712576, 0.397756], [0.62000194, 0.354359], [0.30900057, 0.130823], [0.12918293, 0.012952], [0.05400711, -0.000125], [0.02257859, 0.000245]], [1, [44.38520603, -7.7e-05], [23.85822456, 0.000906], [12.73507149, -0.006126], [6.00842867, 0.038285], [3.96301478, -0.027356], [2.13751474, -0.059665], [1.20712576, -0.115513], [0.62000194, -0.130421], [0.30900057, 0.025358], [0.12918293, 0.394962], [0.05400711, 0.54831], [0.02257859, 0.169017]], [1, [44.38520603, 0.000257], [23.85822456, -0.004273], [12.73507149, 0.034307], [6.00842867, -0.26758], [3.96301478, 0.2157], [2.13751474, 0.80689], [1.20712576, 0.194864], [0.62000194, -0.88026], [0.30900057, -0.530792], [0.12918293, 0.664296], [0.05400711, 0.379472], [0.02257859, -0.003174]], [1, [44.38520603, 0.000117], [23.85822456, -0.005201], [12.73507149, 0.057541], [6.00842867, -0.690259], [3.96301478, 1.21697], [2.13751474, 1.017989], [1.20712576, -1.674556], [0.62000194, -0.722613], [0.30900057, 1.629515], [0.12918293, -0.172012], [0.05400711, -0.594627], [0.02257859, 0.019229]], [1, [0.02257859, 1.0]], [1, [0.00943936, 1.0]], [2, [29.31465998, -0.000519], [13.63067536, -0.007186], [8.04907964, 0.095441], [3.25682476, 0.170565], [1.474054, 0.27882], [0.66141289, 0.324798], [0.29673638, 0.280135], [0.13456087, 0.172066], [0.06095666, 0.058237], [0.02784531, 0.004588]], [2, [29.31465998, 0.002823], [13.63067536, -0.006527], [8.04907964, -0.061261], [3.25682476, -0.257858], [1.474054, -0.489583], [0.66141289, 0.014563], [0.29673638, 0.349211], [0.13456087, 0.382975], [0.06095666, 0.175115], [0.02784531, 0.017645]], [2, [29.31465998, 0.007279], [13.63067536, -0.0349], [8.04907964, 0.005127], [3.25682476, -0.547554], [1.474054, -0.249327], [0.66141289, 0.883201], [0.29673638, 0.185008], [0.13456087, -0.439752], [0.06095666, -0.35135], [0.02784531, -0.032892]], [2, [0.02784531, 1.0]], [2, [0.01271987, 1.0]], [3, [2.226593, 1.0]], [3, [0.630802, 1.0]], [3, [0.17870852, 1.0]], [4, [2.043434, 1.0]], [4, [0.57891237, 1.0]]]}
ecp = {'Ti': [10, [[-1, [[], [[8.52499277, 12.0]], [[15.2433413, 2048.39512837], [9.82605516, -812.71625987], [13.73638629, -6663.62886396], [12.6545051, 5396.93874773]], [[7.54790686, 102.29991323]]]], [0, [[], [], [[6.07854372, -5355.67455847], [6.60870356, 4802.76911085], [5.40803832, 1304.66429039], [10.43037595, -1133.61681175], [18.40796253, -258.77562194], [15.384288, 672.53886697]], []]], [1, [[], [], [[9.60319864, 56981.17339652], [9.66270511, -57002.97844363], [15.06515908, 1335.72576887], [16.36599976, -813.49634683], [7.86420177, -720.45341501], [10.25452653, 239.69852194]], []]], [2, [[], [], [[10.56650824, -4262.72074057], [2.71368379, -1.34753473], [9.33780917, 1569.82864567], [31.60560687, -0.4538755], [12.28030141, 5034.44351544], [13.3677017, -2350.67846378]], []]]]]}
CPU time:         3.64


******** <class 'pyscf.scf.rohf.ROHF'> flags ********
method = ROHF
initial guess = minao
damping factor = 0
level shift factor = 1000.0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /rc_scratch/bamu3429/tmpVsIHo_
max_memory 4000 MB (current use 145 MB)
num. doubly occ = 5  num. singly occ = 2
Set gradient conv threshold to 3.16228e-05
init E= -57.5224688372315
  HOMO = 499.910136986237  LUMO = 1000.01380090662
cycle= 1 E= -57.5224688372315  delta_E= 2.84e-14  |g|= 3.69e-06  |ddm|= 1.05e-08
  HOMO = -0.0898630142013781  LUMO = 0.0138009066155319
Extra cycle  E= -57.5224688372297  delta_E= 1.82e-12  |g|= 1.51e-06  |ddm|= 1.05e-05
converged SCF energy = -57.5224688372297
**** MO energy ****
                Roothaan           | alpha              | beta
MO #1   energy= -2.92385487435041  | -2.99129500890032  | -2.8564147398005   occ= 2
MO #2   energy= -1.81506128251097  | -1.89880455953179  | -1.73131800549016  occ= 2
MO #3   energy= -1.81506127528213  | -1.89880459580212  | -1.73131795476214  occ= 2
MO #4   energy= -1.81506126634979  | -1.89880467148382  | -1.73131786121575  occ= 2
MO #5   energy= -0.22264922039488  | -0.230840704115654 | -0.214457736674113 occ= 2
MO #6   energy= -0.0898630142738812 | -0.438469838607174 | 0.258743658825256  occ= 1
MO #7   energy= -0.0898630142013781 | -0.438469839287722 | 0.258743658957608  occ= 1
MO #8   energy= 0.0138009066155319 | 0.0130618787123339 | 0.0145399345187294 occ= 0
MO #9   energy= 0.0138009080147795 | 0.0130618798758953 | 0.0145399361536638 occ= 0
MO #10  energy= 0.0138009098088966 | 0.013061881217387  | 0.0145399384004071 occ= 0
MO #11  energy= 0.0241925616336495 | 0.0237984616663005 | 0.024586661601     occ= 0
MO #12  energy= 0.0390462694537336 | 0.0390122239699168 | 0.0390803149375512 occ= 0
MO #13  energy= 0.0390462697178127 | 0.0390122242696856 | 0.0390803151659402 occ= 0
MO #14  energy= 0.0390462699155529 | 0.0390122244681835 | 0.039080315362923  occ= 0
MO #15  energy= 0.0394195361750357 | 0.0393575115900509 | 0.0394816218141051 occ= 0
MO #16  energy= 0.0394195361986763 | 0.0393575116107732 | 0.0394816218242178 occ= 0
MO #17  energy= 0.0450727933978086 | 0.0433143660436999 | 0.046831220751917  occ= 0
MO #18  energy= 0.0450727958494305 | 0.0433143675920131 | 0.0468312241068486 occ= 0
MO #19  energy= 0.0450727997866897 | 0.0433143698127981 | 0.046831229760584  occ= 0
MO #20  energy= 0.103086873164105  | 0.0999285448797238 | 0.106245201448485  occ= 0
MO #21  energy= 0.10308687790291   | 0.0999285514333335 | 0.106245204372483  occ= 0
MO #22  energy= 0.103086884843245  | 0.0999285619376629 | 0.106245207748829  occ= 0
MO #23  energy= 0.123140391332866  | 0.120866675198912  | 0.125414172565785  occ= 0
MO #24  energy= 0.123140391458647  | 0.120866675268204  | 0.125414172543476  occ= 0
MO #25  energy= 0.190767529639738  | 0.176607604592991  | 0.204927454686489  occ= 0
MO #26  energy= 0.190767545824543  | 0.176607623220196  | 0.204927468428889  occ= 0
MO #27  energy= 0.19076757500943   | 0.176607657295743  | 0.204927492723123  occ= 0
MO #28  energy= 0.190961653282354  | 0.185093797059071  | 0.196829509505639  occ= 0
MO #29  energy= 0.190961659008024  | 0.185093799773433  | 0.196829518242616  occ= 0
MO #30  energy= 0.190961668000426  | 0.185093802788051  | 0.196829533212803  occ= 0
MO #31  energy= 0.19575943734379   | 0.191815682716101  | 0.199703191971477  occ= 0
MO #32  energy= 0.648185713960378  | 0.639078332577037  | 0.657293095343721  occ= 0
MO #33  energy= 0.648185714750482  | 0.639078336143858  | 0.657293093357107  occ= 0
MO #34  energy= 0.648185715015512  | 0.639078331176133  | 0.657293098854893  occ= 0
MO #35  energy= 0.648933523264933  | 0.643556069158541  | 0.654310977371325  occ= 0
MO #36  energy= 0.648933527371727  | 0.643556066814372  | 0.65431098792908   occ= 0
MO #37  energy= 0.648933533669271  | 0.64355606731418   | 0.654311000024363  occ= 0
MO #38  energy= 0.649743497415     | 0.648879135646284  | 0.65060785918372   occ= 0
MO #39  energy= 0.652175918466995  | 0.614158376341362  | 0.690193503541255  occ= 0
MO #40  energy= 0.652175918910628  | 0.61415837661856   | 0.690193503714967  occ= 0
MO #41  energy= 0.711633477219666  | 0.701145160427985  | 0.722121794011349  occ= 0
MO #42  energy= 0.711633492004801  | 0.701145176904053  | 0.722121807105551  occ= 0
MO #43  energy= 0.711633515941969  | 0.701145204122426  | 0.722121827761513  occ= 0
MO #44  energy= 0.869101792235931  | 0.858340910021318  | 0.879862674450532  occ= 0
MO #45  energy= 1.42638036001427   | 1.40660197568601   | 1.44615874434253   occ= 0
MO #46  energy= 1.42638038048942   | 1.4066019868994    | 1.44615877407944   occ= 0
MO #47  energy= 1.42638041325159   | 1.40660200134006   | 1.44615882516312   occ= 0
MO #48  energy= 2.1655613506382    | 2.12032989419204   | 2.21079280708436   occ= 0
MO #49  energy= 2.16556135311822   | 2.12032991319826   | 2.21079279303819   occ= 0
MO #50  energy= 2.16556136000544   | 2.12032995318098   | 2.21079276682989   occ= 0
MO #51  energy= 2.17179105344958   | 2.14469619763847   | 2.19888590926069   occ= 0
MO #52  energy= 2.17179106149605   | 2.14469616359718   | 2.19888595939493   occ= 0
MO #53  energy= 2.17179107007578   | 2.14469614897778   | 2.19888599117379   occ= 0
MO #54  energy= 2.17902379408135   | 2.17432318013068   | 2.18372440803202   occ= 0
MO #55  energy= 2.62191862222753   | 2.61479852860458   | 2.62903871585049   occ= 0
MO #56  energy= 2.62191863168612   | 2.61479853413371   | 2.62903872923854   occ= 0
MO #57  energy= 2.62191864372679   | 2.61479853866422   | 2.62903874878936   occ= 0
MO #58  energy= 2.62557318185415   | 2.61205185066404   | 2.63909451028193   occ= 0
MO #59  energy= 2.62557318188293   | 2.61205185071127   | 2.6390945102929    occ= 0
MO #60  energy= 2.62691430990463   | 2.61059329072221   | 2.64323532908704   occ= 0
MO #61  energy= 2.62691431292659   | 2.61059329598782   | 2.64323532986536   occ= 0
MO #62  energy= 2.6269143162037    | 2.61059330051839   | 2.64323533188901   occ= 0
MO #63  energy= 2.6286149291041    | 2.60898721716136   | 2.64824264104686   occ= 0
MO #64  energy= 2.72430101840136   | 2.66282984035204   | 2.7857721794075    occ= 0
MO #65  energy= 2.72430101854917   | 2.66282984060071   | 2.78577217941877   occ= 0
MO #66  energy= 2.75256799668433   | 2.74046668401821   | 2.76466930935046   occ= 0
MO #67  energy= 2.75256801389285   | 2.74046670354545   | 2.76466932424026   occ= 0
MO #68  energy= 2.75256804601232   | 2.7404667400401    | 2.76466935198453   occ= 0
MO #69  energy= 3.7699564390974    | 3.74938148744425   | 3.79053139075055   occ= 0
MO #70  energy= 5.58872926627597   | 5.56709542237005   | 5.6103631101819    occ= 0
MO #71  energy= 5.58872929220637   | 5.56709543858798   | 5.61036314582475   occ= 0
MO #72  energy= 5.58872934092564   | 5.56709546807223   | 5.61036321377905   occ= 0
MO #73  energy= 6.81581078121979   | 6.7612393728403    | 6.87038218959928   occ= 0
MO #74  energy= 6.81581078279575   | 6.76123933648022   | 6.87038222911128   occ= 0
MO #75  energy= 6.81581078350055   | 6.76123931807985   | 6.87038224892125   occ= 0
MO #76  energy= 6.81915112951966   | 6.7859675337835    | 6.85233472525585   occ= 0
MO #77  energy= 6.81915116004678   | 6.78596751288505   | 6.8523348072085    occ= 0
MO #78  energy= 6.81915117505371   | 6.78596750185077   | 6.85233484825663   occ= 0
MO #79  energy= 6.82311025662852   | 6.81656344141058   | 6.82965707184644   occ= 0
MO #80  energy= 9.0961854418622    | 9.08151023950456   | 9.11086064421985   occ= 0
MO #81  energy= 9.09618545505638   | 9.08151024561215   | 9.11086066450062   occ= 0
MO #82  energy= 9.09618548092012   | 9.08151025748479   | 9.11086070435546   occ= 0
MO #83  energy= 9.10397551975153   | 9.07579624263692   | 9.13215479949707   occ= 0
MO #84  energy= 9.10397551975608   | 9.07579624262431   | 9.13215479951855   occ= 0
MO #85  energy= 9.10657896657749   | 9.07361371582336   | 9.1395442173316    occ= 0
MO #86  energy= 9.10657897348247   | 9.07361372758457   | 9.13954421938037   occ= 0
MO #87  energy= 9.10657897703944   | 9.07361373360132   | 9.13954422047754   occ= 0
MO #88  energy= 9.11017576763304   | 9.07070634044522   | 9.14964519482088   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0Ti 3s        1.99994
pop of  0Ti 4s        1.99884
pop of  0Ti 5s        0.00073
pop of  0Ti 6s        0.00018
pop of  0Ti 7s        0.00015
pop of  0Ti 8s        0.00014
pop of  0Ti 3px       1.99966
pop of  0Ti 3py       1.99966
pop of  0Ti 3pz       1.99966
pop of  0Ti 4px       0.00010
pop of  0Ti 4py       0.00010
pop of  0Ti 4pz       0.00010
pop of  0Ti 5px       0.00003
pop of  0Ti 5py       0.00003
pop of  0Ti 5pz       0.00003
pop of  0Ti 6px       0.00001
pop of  0Ti 6py       0.00001
pop of  0Ti 6pz       0.00001
pop of  0Ti 7px       0.00000
pop of  0Ti 7py       0.00000
pop of  0Ti 7pz       0.00000
pop of  0Ti 8px       0.00000
pop of  0Ti 8py       0.00000
pop of  0Ti 8pz       0.00000
pop of  0Ti 3dxy      0.61622
pop of  0Ti 3dyz      0.37505
pop of  0Ti 3dz^2     0.18540
pop of  0Ti 3dxz      0.69945
pop of  0Ti 3dx2-y2    0.10643
pop of  0Ti 4dxy      0.00426
pop of  0Ti 4dyz      0.00259
pop of  0Ti 4dz^2     0.00128
pop of  0Ti 4dxz      0.00484
pop of  0Ti 4dx2-y2    0.00074
pop of  0Ti 5dxy      0.00035
pop of  0Ti 5dyz      0.00021
pop of  0Ti 5dz^2     0.00011
pop of  0Ti 5dxz      0.00040
pop of  0Ti 5dx2-y2    0.00006
pop of  0Ti 6dxy      0.00077
pop of  0Ti 6dyz      0.00047
pop of  0Ti 6dz^2     0.00023
pop of  0Ti 6dxz      0.00088
pop of  0Ti 6dx2-y2    0.00013
pop of  0Ti 7dxy      0.00001
pop of  0Ti 7dyz      0.00001
pop of  0Ti 7dz^2     0.00000
pop of  0Ti 7dxz      0.00002
pop of  0Ti 7dx2-y2    0.00000
pop of  0Ti 4fy^3     0.00001
pop of  0Ti 4fxyz     0.00006
pop of  0Ti 4fyz^2    0.00000
pop of  0Ti 4fz^3     0.00003
pop of  0Ti 4fxz^2    0.00004
pop of  0Ti 4fzx^2    0.00002
pop of  0Ti 4fx^3     0.00004
pop of  0Ti 5fy^3     0.00001
pop of  0Ti 5fxyz     0.00010
pop of  0Ti 5fyz^2    0.00000
pop of  0Ti 5fz^3     0.00005
pop of  0Ti 5fxz^2    0.00007
pop of  0Ti 5fzx^2    0.00005
pop of  0Ti 5fx^3     0.00007
pop of  0Ti 6fy^3     0.00000
pop of  0Ti 6fxyz     0.00002
pop of  0Ti 6fyz^2    0.00000
pop of  0Ti 6fz^3     0.00001
pop of  0Ti 6fxz^2    0.00001
pop of  0Ti 6fzx^2    0.00001
pop of  0Ti 6fx^3     0.00001
pop of  0Ti 5g-4      0.00000
pop of  0Ti 5g-3      0.00000
pop of  0Ti 5g-2      0.00000
pop of  0Ti 5g-1      0.00001
pop of  0Ti 5g 0      0.00000
pop of  0Ti 5g 1      0.00000
pop of  0Ti 5g 2      0.00001
pop of  0Ti 5g 3      0.00000
pop of  0Ti 5g 4      0.00000
pop of  0Ti 6g-4      0.00000
pop of  0Ti 6g-3      0.00001
pop of  0Ti 6g-2      0.00000
pop of  0Ti 6g-1      0.00002
pop of  0Ti 6g 0      0.00000
pop of  0Ti 6g 1      0.00000
pop of  0Ti 6g 2      0.00002
pop of  0Ti 6g 3      0.00000
pop of  0Ti 6g 4      0.00001
 ** Mulliken atomic charges  **
charge of  0Ti =     -0.00000

******** <class 'pyscf.mcscf.mc1step.CASSCF'> flags ********
CAS (3e+1e, 6o), ncore = 4, nvir = 78
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
chkfile = ./scratch/34352/tmpkago27
max_memory 4000 MB (current use 244 MB)
internal_rotation = False

******** SHCI flags ********
executable             = /home/bamu3429/softwares/dice/Dice
mpiprefix              = srun -n20
scratchDirectory       = ./scratch/34352
integralFile           = ./FCIDUMP
configFile             = ./input.dat
outputFile             = ./output.dat
maxIter                = 6
sweep_iter             = []
sweep_epsilon          = []
nPTiter                = 0
Stochastic             = True
fullrestart            = False
restart                = False
num_thrds              = 12
memory                 = None

CASCI E = -57.5234694566982  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter 1 (21 JK  4 micro), CASSCF E = -57.5352085729985  dE = -0.011739116  S^2 = 2.0000000
               |grad[o]|=0.00278  |grad[c]|= None  |ddm|=0.0557
macro iter 2 (21 JK  4 micro), CASSCF E = -57.5515016297126  dE = -0.016293057  S^2 = 2.0000000
               |grad[o]|=0.0135  |grad[c]|= None  |ddm|=0.0846
macro iter 3 (14 JK  4 micro), CASSCF E = -57.5537508247142  dE = -0.002249195  S^2 = 2.0000000
               |grad[o]|=0.00855  |grad[c]|= None  |ddm|=0.00436
macro iter 4 (3 JK  1 micro), CASSCF E = -57.5537510333526  dE = -2.0863846e-07  S^2 = 2.0000000
               |grad[o]|=0.000109  |grad[c]|= None  |ddm|=    0
macro iter 5 (1 JK  1 micro), CASSCF E = -57.5537510333526  dE = 0  S^2 = 2.0000000
               |grad[o]|=1.69e-05  |grad[c]|= None  |ddm|=    0
1-step CASSCF converged in 5 macro (60 JK 14 micro) steps
CASSCF canonicalization
CASSCF energy = -57.5537510333526


--------------------------------------------------
                 ICMPSPT CALCULATION              
--------------------------------------------------

Perturbation type: MRLCC
With fully internally contracted scheme
With third order correction

Preparing necessary RDMs
......production of RDMs took      20.66 sec
Reading binary 4RDM from DICE
......reading the RDM took          1.32 sec

(GOOD) Trace 4RDM:     24.0 =    4*    3*    2*    1
(GOOD) Trace 3RDM:     24.0 =    4*    3*    2
(GOOD) Trace 2RDM:     12.0 =    4*    3
(GOOD) Trace 1RDM:      4.0 =    4

Producing the integrals
......production of INT took      88.04 sec

Energy_core =  -54.18710419
Energy      =  -57.55375103

WARNING: Have to use natural orbitals from CAASCF
         offdiagonal elements:    0.42886268

Basic ingredients written to int/
......savings of INGREDIENTS took      77.00 sec

Second-order:
perturber CCVV --        -0.197971660
perturber CCAV --        -0.060130823
perturber ACVV --        -0.105410436
perturber CCAA --        -0.001053747
perturber AAVV --        -0.016850377
perturber CAAV --        -0.038843422
perturber AAAV --        -0.007968508
perturber AAAC --        -0.002936148
Total:                   -0.431165121

Third-order:             -0.001904912

Total PT       --        -0.433070033

