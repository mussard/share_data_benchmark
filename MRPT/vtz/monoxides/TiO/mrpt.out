#INFO: **** input file is /projects/bamu3429/BENCHMARK/fresh_atoms/MRPT/vtz/monoxides/TiO/mrpt.py ****
import json
from pyscf import gto,scf,mcscf, fci, lo, ci, cc
from pyscf.scf import ROHF, UHF,ROKS
import numpy as np
import pandas as pd

# THIS IS WERE IT STARTS ====================================

df=json.load(open("../../../trail.json"))

spins={'ScO':1, 'TiO':2, 'VO':3, 'CrO':4, 'MnO':5, 'FeO':4, 'CuO':1}

nd={'Sc':(1,0), 'Ti':(2,0), 'V':(3,0), 'Cr':(5,0), 'Mn':(5,0), 'Fe':(5,1), 'Cu':(5,4)}

cas={'Sc':3, 'Ti':4, 'V':5, 'Cr':6, 'Mn':7, 'Fe':8, 'Cu':11}

re={'ScO':1.668, 'TiO':1.623, 'VO':1.591, 'CrO':1.621, 'MnO':1.648, 'FeO':1.616, 'CuO':1.725}

datacsv={}
for nm in ['basis','charge','method','molecule','pseudopotential',
           'totalenergy','totalenergy-stocherr','totalenergy-syserr']:
  datacsv[nm]=[]

basis='vtz'
element='Ti'

mol=gto.Mole()
mol.ecp={}
mol.basis={}
for el in [element,'O']:
  mol.ecp[el]=gto.basis.parse_ecp(df[el]['ecp'])
  mol.basis[el]=gto.basis.parse(df[el][basis])
mol.charge=0
mol.spin=spins[element+'O']
mol.build(atom="%s 0. 0. 0.; O 0. 0. %g"%(element,re[element+'O']),verbose=4)

m=ROHF(mol)
m.level_shift=1000.0
dm=m.from_chk("../../../../HF/monoxides/"+element+basis+"0.chk")
hf=m.kernel(dm)
m.analyze()

from pyscf.shciscf import shci
mc = shci.SHCISCF(m, 9, 4+cas[element])
#mc.fcisolver.conv_tol = 1e-14
mc.fcisolver.mpiprefix="srun -n20"
mc.fcisolver.num_thrds=12
mc.verbose = 4
cas=mc.kernel()[0]
 
from pyscf.icmpspt import icmpspt
pt=icmpspt.icmpspt(mc,rdmM=500, PTM=1000,\
                          pttype="MRLCC",\
                          third_order=True,\
                          fully_ic=True,\
                          do_dm4=True)

datacsv['basis'].append(basis)
datacsv['charge'].append(0)
datacsv['method'].append('MRPT')
datacsv['molecule'].append(element)
datacsv['pseudopotential'].append('trail')
datacsv['totalenergy'].append(cas+pt)
datacsv['totalenergy-stocherr'].append(0.0)
datacsv['totalenergy-syserr'].append(0.0)
pd.DataFrame(datacsv).to_csv(element+".csv",index=False)

#INFO: ******************** input file end ********************


System: ('Linux', 'bnode0302.rc.int.colorado.edu', '3.10.0-514.41.1.el7.x86_64', '#1 SMP Wed Jan 17 10:26:16 EST 2018', 'x86_64', 'x86_64')  Threads 28
Python 2.7.11 (default, Mar 22 2016, 01:42:54) 
[GCC Intel(R) C++ gcc 4.8 mode]
numpy 1.11.1  scipy 0.17.1
Date: Wed Apr 18 17:21:22 2018
PySCF version 1.4.6
PySCF path  /projects/bamu3429/softwares/pyscf_uptodate/pyscf
GIT ORIG_HEAD f3591ef22170896a4cdc2aadaa6f5da388ffcadb
GIT HEAD      ref: refs/heads/master
GIT master branch  1847583fb1d2472321833d3c71c8b7008e5fabf5

[INPUT] VERBOSE 4
[INPUT] num atoms = 2
[INPUT] num electrons = 18
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 2
[INPUT] symmetry False subgroup None
[INPUT]  1 Ti     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 O      0.000000000000   0.000000000000   1.623000000000 AA    0.000000000000   0.000000000000   3.067025500169 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] O
[INPUT] 0    0    [10   /1   ]  57.663349         -0.002794
                                35.726816         0.023976
                                22.453757         -0.115974
                                14.732301         0.288033
                                9.739917          -0.274786
                                5.042008          -0.083789
                                2.157818          0.063778
                                1.002916          0.410182
                                0.421839          0.504044
                                0.173041          0.172152
[INPUT] 0    0    [1    /1   ]  1.849096             1
[INPUT] 0    0    [1    /1   ]  0.255434             1
[INPUT] 0    0    [1    /1   ]  0.141483             1
[INPUT] 1    0    [10   /1   ]  52.47406          -0.000522
                                32.138432         0.004857
                                19.458579         -0.027749
                                11.839344         0.074258
                                7.91003           0.014369
                                3.670858          0.153479
                                1.53966           0.283685
                                0.647119          0.358201
                                0.267853          0.29559
                                0.107198          0.104889
[INPUT] 1    0    [1    /1   ]  0.622175             1
[INPUT] 1    0    [1    /1   ]  0.193391             1
[INPUT] 1    0    [1    /1   ]  0.052779             1
[INPUT] 2    0    [1    /1   ]  2.324251             1
[INPUT] 2    0    [1    /1   ]  0.656935             1
[INPUT] 2    0    [1    /1   ]  0.2072               1
[INPUT] 3    0    [1    /1   ]  1.423472             1
[INPUT] 3    0    [1    /1   ]  0.48761              1
[INPUT] Ti
[INPUT] 0    0    [12   /1   ]  37.13946663       0.002411
                                11.66061728       -0.575963
                                8.9751153         2.645948
                                7.67011905        -2.362876
                                3.44923714        -0.059842
                                1.58705441        0.244002
                                0.95387432        0.58593
                                0.47300537        0.378609
                                0.2203041         0.031099
                                0.10349534        0.004602
                                0.04822069        0.000609
                                0.0226639         0.001044
[INPUT] 0    0    [12   /1   ]  37.13946663       -0.000363
                                11.66061728       0.129591
                                8.9751153         -0.625086
                                7.67011905        0.572499
                                3.44923714        0.016652
                                1.58705441        -0.073052
                                0.95387432        -0.203234
                                0.47300537        -0.251131
                                0.2203041         -0.044619
                                0.10349534        0.38905
                                0.04822069        0.591401
                                0.0226639         0.208165
[INPUT] 0    0    [12   /1   ]  37.13946663       -0.001048
                                11.66061728       0.513626
                                8.9751153         -2.6299
                                7.67011905        2.506927
                                3.44923714        0.034363
                                1.58705441        -1.199876
                                0.95387432        -0.360111
                                0.47300537        0.526538
                                0.2203041         0.906119
                                0.10349534        0.354604
                                0.04822069        -0.569496
                                0.0226639         -0.388471
[INPUT] 0    0    [12   /1   ]  37.13946663       -0.002126
                                11.66061728       0.777822
                                8.9751153         -4.101997
                                7.67011905        4.037004
                                3.44923714        -0.301669
                                1.58705441        -2.544268
                                0.95387432        1.067498
                                0.47300537        2.188092
                                0.2203041         -0.737717
                                0.10349534        -1.595594
                                0.04822069        0.519723
                                0.0226639         0.702092
[INPUT] 0    0    [1    /1   ]  0.0226639            1
[INPUT] 0    0    [1    /1   ]  0.01065211           1
[INPUT] 1    0    [12   /1   ]  44.38520603       0.000557
                                23.85822456       -0.004857
                                12.73507149       0.027448
                                6.00842867        -0.150306
                                3.96301478        0.092203
                                2.13751474        0.210744
                                1.20712576        0.397756
                                0.62000194        0.354359
                                0.30900057        0.130823
                                0.12918293        0.012952
                                0.05400711        -0.000125
                                0.02257859        0.000245
[INPUT] 1    0    [12   /1   ]  44.38520603       -7.7e-05
                                23.85822456       0.000906
                                12.73507149       -0.006126
                                6.00842867        0.038285
                                3.96301478        -0.027356
                                2.13751474        -0.059665
                                1.20712576        -0.115513
                                0.62000194        -0.130421
                                0.30900057        0.025358
                                0.12918293        0.394962
                                0.05400711        0.54831
                                0.02257859        0.169017
[INPUT] 1    0    [12   /1   ]  44.38520603       0.000257
                                23.85822456       -0.004273
                                12.73507149       0.034307
                                6.00842867        -0.26758
                                3.96301478        0.2157
                                2.13751474        0.80689
                                1.20712576        0.194864
                                0.62000194        -0.88026
                                0.30900057        -0.530792
                                0.12918293        0.664296
                                0.05400711        0.379472
                                0.02257859        -0.003174
[INPUT] 1    0    [12   /1   ]  44.38520603       0.000117
                                23.85822456       -0.005201
                                12.73507149       0.057541
                                6.00842867        -0.690259
                                3.96301478        1.21697
                                2.13751474        1.017989
                                1.20712576        -1.674556
                                0.62000194        -0.722613
                                0.30900057        1.629515
                                0.12918293        -0.172012
                                0.05400711        -0.594627
                                0.02257859        0.019229
[INPUT] 1    0    [1    /1   ]  0.02257859           1
[INPUT] 1    0    [1    /1   ]  0.00943936           1
[INPUT] 2    0    [10   /1   ]  29.31465998       -0.000519
                                13.63067536       -0.007186
                                8.04907964        0.095441
                                3.25682476        0.170565
                                1.474054          0.27882
                                0.66141289        0.324798
                                0.29673638        0.280135
                                0.13456087        0.172066
                                0.06095666        0.058237
                                0.02784531        0.004588
[INPUT] 2    0    [10   /1   ]  29.31465998       0.002823
                                13.63067536       -0.006527
                                8.04907964        -0.061261
                                3.25682476        -0.257858
                                1.474054          -0.489583
                                0.66141289        0.014563
                                0.29673638        0.349211
                                0.13456087        0.382975
                                0.06095666        0.175115
                                0.02784531        0.017645
[INPUT] 2    0    [10   /1   ]  29.31465998       0.007279
                                13.63067536       -0.0349
                                8.04907964        0.005127
                                3.25682476        -0.547554
                                1.474054          -0.249327
                                0.66141289        0.883201
                                0.29673638        0.185008
                                0.13456087        -0.439752
                                0.06095666        -0.35135
                                0.02784531        -0.032892
[INPUT] 2    0    [1    /1   ]  0.02784531           1
[INPUT] 2    0    [1    /1   ]  0.01271987           1
[INPUT] 3    0    [1    /1   ]  2.226593             1
[INPUT] 3    0    [1    /1   ]  0.630802             1
[INPUT] 3    0    [1    /1   ]  0.17870852           1
[INPUT] 4    0    [1    /1   ]  2.043434             1
[INPUT] 4    0    [1    /1   ]  0.57891237           1
nuclear repulsion = 23.4755139779667
number of shells = 35
number of NR pGTOs = 480
number of NR cGTOs = 133
basis = {'O': [[0, [57.663349, -0.002794], [35.726816, 0.023976], [22.453757, -0.115974], [14.732301, 0.288033], [9.739917, -0.274786], [5.042008, -0.083789], [2.157818, 0.063778], [1.002916, 0.410182], [0.421839, 0.504044], [0.173041, 0.172152]], [0, [1.849096, 1.0]], [0, [0.255434, 1.0]], [0, [0.141483, 1.0]], [1, [52.47406, -0.000522], [32.138432, 0.004857], [19.458579, -0.027749], [11.839344, 0.074258], [7.91003, 0.014369], [3.670858, 0.153479], [1.53966, 0.283685], [0.647119, 0.358201], [0.267853, 0.29559], [0.107198, 0.104889]], [1, [0.622175, 1.0]], [1, [0.193391, 1.0]], [1, [0.052779, 1.0]], [2, [2.324251, 1.0]], [2, [0.656935, 1.0]], [2, [0.2072, 1.0]], [3, [1.423472, 1.0]], [3, [0.48761, 1.0]]], 'Ti': [[0, [37.13946663, 0.002411], [11.66061728, -0.575963], [8.9751153, 2.645948], [7.67011905, -2.362876], [3.44923714, -0.059842], [1.58705441, 0.244002], [0.95387432, 0.58593], [0.47300537, 0.378609], [0.2203041, 0.031099], [0.10349534, 0.004602], [0.04822069, 0.000609], [0.0226639, 0.001044]], [0, [37.13946663, -0.000363], [11.66061728, 0.129591], [8.9751153, -0.625086], [7.67011905, 0.572499], [3.44923714, 0.016652], [1.58705441, -0.073052], [0.95387432, -0.203234], [0.47300537, -0.251131], [0.2203041, -0.044619], [0.10349534, 0.38905], [0.04822069, 0.591401], [0.0226639, 0.208165]], [0, [37.13946663, -0.001048], [11.66061728, 0.513626], [8.9751153, -2.6299], [7.67011905, 2.506927], [3.44923714, 0.034363], [1.58705441, -1.199876], [0.95387432, -0.360111], [0.47300537, 0.526538], [0.2203041, 0.906119], [0.10349534, 0.354604], [0.04822069, -0.569496], [0.0226639, -0.388471]], [0, [37.13946663, -0.002126], [11.66061728, 0.777822], [8.9751153, -4.101997], [7.67011905, 4.037004], [3.44923714, -0.301669], [1.58705441, -2.544268], [0.95387432, 1.067498], [0.47300537, 2.188092], [0.2203041, -0.737717], [0.10349534, -1.595594], [0.04822069, 0.519723], [0.0226639, 0.702092]], [0, [0.0226639, 1.0]], [0, [0.01065211, 1.0]], [1, [44.38520603, 0.000557], [23.85822456, -0.004857], [12.73507149, 0.027448], [6.00842867, -0.150306], [3.96301478, 0.092203], [2.13751474, 0.210744], [1.20712576, 0.397756], [0.62000194, 0.354359], [0.30900057, 0.130823], [0.12918293, 0.012952], [0.05400711, -0.000125], [0.02257859, 0.000245]], [1, [44.38520603, -7.7e-05], [23.85822456, 0.000906], [12.73507149, -0.006126], [6.00842867, 0.038285], [3.96301478, -0.027356], [2.13751474, -0.059665], [1.20712576, -0.115513], [0.62000194, -0.130421], [0.30900057, 0.025358], [0.12918293, 0.394962], [0.05400711, 0.54831], [0.02257859, 0.169017]], [1, [44.38520603, 0.000257], [23.85822456, -0.004273], [12.73507149, 0.034307], [6.00842867, -0.26758], [3.96301478, 0.2157], [2.13751474, 0.80689], [1.20712576, 0.194864], [0.62000194, -0.88026], [0.30900057, -0.530792], [0.12918293, 0.664296], [0.05400711, 0.379472], [0.02257859, -0.003174]], [1, [44.38520603, 0.000117], [23.85822456, -0.005201], [12.73507149, 0.057541], [6.00842867, -0.690259], [3.96301478, 1.21697], [2.13751474, 1.017989], [1.20712576, -1.674556], [0.62000194, -0.722613], [0.30900057, 1.629515], [0.12918293, -0.172012], [0.05400711, -0.594627], [0.02257859, 0.019229]], [1, [0.02257859, 1.0]], [1, [0.00943936, 1.0]], [2, [29.31465998, -0.000519], [13.63067536, -0.007186], [8.04907964, 0.095441], [3.25682476, 0.170565], [1.474054, 0.27882], [0.66141289, 0.324798], [0.29673638, 0.280135], [0.13456087, 0.172066], [0.06095666, 0.058237], [0.02784531, 0.004588]], [2, [29.31465998, 0.002823], [13.63067536, -0.006527], [8.04907964, -0.061261], [3.25682476, -0.257858], [1.474054, -0.489583], [0.66141289, 0.014563], [0.29673638, 0.349211], [0.13456087, 0.382975], [0.06095666, 0.175115], [0.02784531, 0.017645]], [2, [29.31465998, 0.007279], [13.63067536, -0.0349], [8.04907964, 0.005127], [3.25682476, -0.547554], [1.474054, -0.249327], [0.66141289, 0.883201], [0.29673638, 0.185008], [0.13456087, -0.439752], [0.06095666, -0.35135], [0.02784531, -0.032892]], [2, [0.02784531, 1.0]], [2, [0.01271987, 1.0]], [3, [2.226593, 1.0]], [3, [0.630802, 1.0]], [3, [0.17870852, 1.0]], [4, [2.043434, 1.0]], [4, [0.57891237, 1.0]]]}
ecp = {'O': [2, [[-1, [[], [[10.27717748, 6.0]], [[15.99566749, 1232.50197768], [10.46901775, -696.47008301], [14.6384801, -2654.22657081], [12.57591181, 2101.67732548]], [[7.77739102, 61.66306486]]]], [0, [[], [], [[12.39426073, -656683.37638839], [12.38126171, 657858.57667068], [8.57671033, 511.50098405], [9.89256508, -2579.54665641], [28.05641604, -57.68129584], [17.24753607, 970.30940152]], []]], [1, [[], [], [[14.78918914, -363027.24258186], [14.82014018, 361852.52314043], [22.89622221, -1300.20069256], [8.51331893, -181.96869573], [11.48609758, 2194.87589959], [27.22017524, 451.19906206]], []]]]], 'Ti': [10, [[-1, [[], [[8.52499277, 12.0]], [[15.2433413, 2048.39512837], [9.82605516, -812.71625987], [13.73638629, -6663.62886396], [12.6545051, 5396.93874773]], [[7.54790686, 102.29991323]]]], [0, [[], [], [[6.07854372, -5355.67455847], [6.60870356, 4802.76911085], [5.40803832, 1304.66429039], [10.43037595, -1133.61681175], [18.40796253, -258.77562194], [15.384288, 672.53886697]], []]], [1, [[], [], [[9.60319864, 56981.17339652], [9.66270511, -57002.97844363], [15.06515908, 1335.72576887], [16.36599976, -813.49634683], [7.86420177, -720.45341501], [10.25452653, 239.69852194]], []]], [2, [[], [], [[10.56650824, -4262.72074057], [2.71368379, -1.34753473], [9.33780917, 1569.82864567], [31.60560687, -0.4538755], [12.28030141, 5034.44351544], [13.3677017, -2350.67846378]], []]]]]}
CPU time:         3.57


******** <class 'pyscf.scf.rohf.ROHF'> flags ********
method = ROHF
initial guess = minao
damping factor = 0
level shift factor = 1000.0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /rc_scratch/bamu3429/tmp8qAMKd
max_memory 4000 MB (current use 110 MB)
num. doubly occ = 8  num. singly occ = 2
Set gradient conv threshold to 3.16228e-05
init E= -73.275275888242
  HOMO = 499.881092136161  LUMO = 1000.01262880305
cycle= 1 E= -73.2752758882424  delta_E= -4.12e-13  |g|= 1.46e-05  |ddm|= 6.38e-08
  HOMO = -0.118907861041409  LUMO = 0.0126288031866093
Extra cycle  E= -73.2752758883657  delta_E= -1.23e-10  |g|= 5.93e-06  |ddm|= 3.63e-05
converged SCF energy = -73.2752758883657
**** MO energy ****
                Roothaan           | alpha              | beta
MO #1   energy= -2.97002687073195  | -3.00916899973405  | -2.93088474224655  occ= 2
MO #2   energy= -1.88924992680978  | -1.90359116237218  | -1.87490869689004  occ= 2
MO #3   energy= -1.85749443413923  | -1.91893472588322  | -1.79605414239525  occ= 2
MO #4   energy= -1.85749443413923  | -1.91893472588321  | -1.79605414239525  occ= 2
MO #5   energy= -1.15388768818222  | -1.15604065909202  | -1.15173471792861  occ= 2
MO #6   energy= -0.459544587054913 | -0.464734170777111 | -0.454355008998023 occ= 2
MO #7   energy= -0.443148230881812 | -0.44581953745987  | -0.440476924303757 occ= 2
MO #8   energy= -0.443148230881809 | -0.44581953745987  | -0.440476924303756 occ= 2
MO #9   energy= -0.123731193180089 | -0.265545637710914 | 0.0180830064012998 occ= 1
MO #10  energy= -0.118907861041409 | -0.457363508926796 | 0.219548424123301  occ= 1
MO #11  energy= 0.0126288031866093 | 0.00717308455551286 | 0.0180845218177077 occ= 0
MO #12  energy= 0.01262880318661   | 0.00717308455551309 | 0.0180845218177065 occ= 0
MO #13  energy= 0.0155131442811544 | 0.0137007790497667 | 0.0173256580008349 occ= 0
MO #14  energy= 0.0253255246474066 | 0.0242840454497647 | 0.0263669489831076 occ= 0
MO #15  energy= 0.0374578455584567 | 0.0372365230006335 | 0.0376791681162814 occ= 0
MO #16  energy= 0.0378949607434014 | 0.0377351887165393 | 0.0380547616136276 occ= 0
MO #17  energy= 0.040773022892697  | 0.03829653384754   | 0.0432495119378541 occ= 0
MO #18  energy= 0.0407730228926991 | 0.0382965338475458 | 0.0432495119378529 occ= 0
MO #19  energy= 0.0436714410001573 | 0.0429358201350634 | 0.0444070757230141 occ= 0
MO #20  energy= 0.0445026840029568 | 0.0331236582985845 | 0.0558817097073285 occ= 0
MO #21  energy= 0.0445026840029579 | 0.0331236582985857 | 0.0558817097073303 occ= 0
MO #22  energy= 0.0618443865969678 | 0.0489489365321431 | 0.0747399306845828 occ= 0
MO #23  energy= 0.0954876345402427 | 0.0881584729380143 | 0.102816796142469  occ= 0
MO #24  energy= 0.113163247828681  | 0.109874663933704  | 0.116451831723658  occ= 0
MO #25  energy= 0.113163247828695  | 0.109874663933718  | 0.116451831723672  occ= 0
MO #26  energy= 0.117595827663095  | 0.111513720154766  | 0.123677886170598  occ= 0
MO #27  energy= 0.119026182639889  | 0.114617205057296  | 0.123435044523899  occ= 0
MO #28  energy= 0.139093536471138  | 0.132707477824103  | 0.145479822814141  occ= 0
MO #29  energy= 0.157022359708054  | 0.142620482096641  | 0.171424237319467  occ= 0
MO #30  energy= 0.157022359708055  | 0.142620482096642  | 0.171424237319468  occ= 0
MO #31  energy= 0.161190012357194  | 0.151576038404657  | 0.170803779712523  occ= 0
MO #32  energy= 0.170786356029713  | 0.162266043884914  | 0.179306668174511  occ= 0
MO #33  energy= 0.239019035728506  | 0.224160630644214  | 0.253877440812797  occ= 0
MO #34  energy= 0.239019035728513  | 0.224160630644218  | 0.253877440812805  occ= 0
MO #35  energy= 0.276332724064102  | 0.273540692649289  | 0.279124755478913  occ= 0
MO #36  energy= 0.276332724064104  | 0.273540692649291  | 0.279124755478915  occ= 0
MO #37  energy= 0.300098215420718  | 0.296125600621016  | 0.304070904361551  occ= 0
MO #38  energy= 0.423230275347075  | 0.416038241388918  | 0.430422344432965  occ= 0
MO #39  energy= 0.56636082214756   | 0.552416260406444  | 0.58030537450649   occ= 0
MO #40  energy= 0.614532398157546  | 0.584829126708917  | 0.644235367399685  occ= 0
MO #41  energy= 0.617423623189199  | 0.602044430066648  | 0.632802816311749  occ= 0
MO #42  energy= 0.617423623189201  | 0.60204443006665   | 0.63280281631175   occ= 0
MO #43  energy= 0.619119879269489  | 0.612750307873672  | 0.625489450665305  occ= 0
MO #44  energy= 0.619400908436942  | 0.597344276330214  | 0.641457426687807  occ= 0
MO #45  energy= 0.63412510138543   | 0.619679667077558  | 0.6485705356933    occ= 0
MO #46  energy= 0.634125101385431  | 0.61967966707756   | 0.648570535693302  occ= 0
MO #47  energy= 0.66425177642423   | 0.647774106728837  | 0.680729421359918  occ= 0
MO #48  energy= 0.666101913392029  | 0.655710961861784  | 0.676492864922273  occ= 0
MO #49  energy= 0.751298720395701  | 0.744148040149875  | 0.758449402901099  occ= 0
MO #50  energy= 0.864697149597411  | 0.862112817524207  | 0.867281481670613  occ= 0
MO #51  energy= 0.864697149597413  | 0.86211281752421   | 0.867281481670616  occ= 0
MO #52  energy= 0.915715401528164  | 0.907707055471227  | 0.923723703823901  occ= 0
MO #53  energy= 0.91592222648169   | 0.913101227654175  | 0.918743226830103  occ= 0
MO #54  energy= 0.919418963382914  | 0.915934228247692  | 0.922903698518139  occ= 0
MO #55  energy= 0.947452850825036  | 0.944688162596993  | 0.950217539053076  occ= 0
MO #56  energy= 0.947452850825038  | 0.944688162596997  | 0.950217539053082  occ= 0
MO #57  energy= 1.12155915167998   | 1.10726312617052   | 1.13585517718945   occ= 0
MO #58  energy= 1.12155915168      | 1.10726312617053   | 1.13585517718947   occ= 0
MO #59  energy= 1.40238731514008   | 1.39568865339477   | 1.40908597448168   occ= 0
MO #60  energy= 1.60066998691148   | 1.59589981722229   | 1.60544015592094   occ= 0
MO #61  energy= 1.73467893357838   | 1.72521474469367   | 1.74414312246307   occ= 0
MO #62  energy= 1.73467893357838   | 1.72521474469368   | 1.74414312246309   occ= 0
MO #63  energy= 1.94649034605422   | 1.93413646515617   | 1.95884420818964   occ= 0
MO #64  energy= 1.95022550679213   | 1.94818659221875   | 1.95226442136551   occ= 0
MO #65  energy= 1.99864256464734   | 1.99086307445343   | 2.00642205484125   occ= 0
MO #66  energy= 1.99864256464735   | 1.99086307445343   | 2.00642205484126   occ= 0
MO #67  energy= 2.05453714926869   | 2.05257210382758   | 2.0565021947098    occ= 0
MO #68  energy= 2.05453714926869   | 2.05257210382758   | 2.0565021947098    occ= 0
MO #69  energy= 2.14141367513825   | 2.13761097072536   | 2.14521637921436   occ= 0
MO #70  energy= 2.14472341015491   | 2.11110144765721   | 2.17834537265262   occ= 0
MO #71  energy= 2.14472341015491   | 2.11110144765721   | 2.17834537265262   occ= 0
MO #72  energy= 2.22698502475626   | 2.21870927079618   | 2.23526077840066   occ= 0
MO #73  energy= 2.29996878124869   | 2.28436096470022   | 2.31557660722216   occ= 0
MO #74  energy= 2.30432006786065   | 2.30147812811873   | 2.30716200760257   occ= 0
MO #75  energy= 2.36426595713812   | 2.35945702177119   | 2.36907489250505   occ= 0
MO #76  energy= 2.36426595713813   | 2.35945702177121   | 2.36907489250506   occ= 0
MO #77  energy= 2.3888531621756    | 2.38315844594916   | 2.39454787872087   occ= 0
MO #78  energy= 2.38972402757968   | 2.38820085344771   | 2.39124720171164   occ= 0
MO #79  energy= 2.48517930004698   | 2.47983742003012   | 2.49052117978088   occ= 0
MO #80  energy= 2.51050486304324   | 2.50284635086203   | 2.51816337522445   occ= 0
MO #81  energy= 2.51050486304325   | 2.50284635086204   | 2.51816337522447   occ= 0
MO #82  energy= 2.6028761839505    | 2.58611771051095   | 2.61963466472078   occ= 0
MO #83  energy= 2.60289915913941   | 2.58605559140394   | 2.61974272687489   occ= 0
MO #84  energy= 2.60625365835875   | 2.60360161487949   | 2.60890570158214   occ= 0
MO #85  energy= 2.72013984699799   | 2.71054698361437   | 2.72973271038162   occ= 0
MO #86  energy= 2.72013984699799   | 2.71054698361436   | 2.72973271038162   occ= 0
MO #87  energy= 2.7249648485116    | 2.67242723474731   | 2.77750239412748   occ= 0
MO #88  energy= 2.74740791026854   | 2.73971360025905   | 2.75510222027802   occ= 0
MO #89  energy= 3.04942005296893   | 3.04321878062494   | 3.05562132531292   occ= 0
MO #90  energy= 3.04942005296894   | 3.04321878062495   | 3.05562132531293   occ= 0
MO #91  energy= 3.16221718762849   | 3.15942521191159   | 3.16500916334539   occ= 0
MO #92  energy= 3.16336698841486   | 3.15334496096962   | 3.17338900077001   occ= 0
MO #93  energy= 3.24590861336166   | 3.2387892561587    | 3.25302797065227   occ= 0
MO #94  energy= 3.32526934558303   | 3.31066661674496   | 3.33987207472504   occ= 0
MO #95  energy= 3.46903788847559   | 3.46563696074135   | 3.47243881620983   occ= 0
MO #96  energy= 3.46903788847559   | 3.46563696074134   | 3.47243881620984   occ= 0
MO #97  energy= 3.60565245407273   | 3.60220573592272   | 3.60909917178498   occ= 0
MO #98  energy= 4.17914772980163   | 4.17665643671749   | 4.18163902288574   occ= 0
MO #99  energy= 4.17914772980167   | 4.17665643671754   | 4.18163902288579   occ= 0
MO #100 energy= 5.38002983735744   | 5.37817009903449   | 5.38188957567474   occ= 0
MO #101 energy= 5.95602041860838   | 5.95072811232186   | 5.96131272481366   occ= 0
MO #102 energy= 6.07576483025997   | 6.06094793126592   | 6.09058172925399   occ= 0
MO #103 energy= 6.07576483025997   | 6.06094793126593   | 6.090581729254     occ= 0
MO #104 energy= 6.51226157974513   | 6.51215799529171   | 6.51236516419857   occ= 0
MO #105 energy= 6.51226157974513   | 6.51215799529171   | 6.51236516419857   occ= 0
MO #106 energy= 6.59698673425404   | 6.59683704622814   | 6.59713642227996   occ= 0
MO #107 energy= 6.59723128444679   | 6.59693668021311   | 6.59752588865953   occ= 0
MO #108 energy= 6.69100815148912   | 6.68326710097148   | 6.69874920198747   occ= 0
MO #109 energy= 6.72983004295393   | 6.72562964200383   | 6.73403044390403   occ= 0
MO #110 energy= 6.72983004295393   | 6.72562964200384   | 6.73403044390403   occ= 0
MO #111 energy= 6.78030745654431   | 6.74302306789915   | 6.81759184518948   occ= 0
MO #112 energy= 6.78030745654431   | 6.74302306789915   | 6.81759184518947   occ= 0
MO #113 energy= 6.81076965279936   | 6.78182495134751   | 6.83971435440337   occ= 0
MO #114 energy= 6.81440710661151   | 6.81002933684203   | 6.81878487638098   occ= 0
MO #115 energy= 7.01631895770502   | 7.01035323292182   | 7.02228468248821   occ= 0
MO #116 energy= 7.01631895770504   | 7.01035323292185   | 7.02228468248824   occ= 0
MO #117 energy= 7.13682936324835   | 7.13639685649636   | 7.13726187000033   occ= 0
MO #118 energy= 7.13684090780534   | 7.13468780128065   | 7.13899401437316   occ= 0
MO #119 energy= 7.60592252454535   | 7.60446671683132   | 7.60737833227167   occ= 0
MO #120 energy= 7.61390665221745   | 7.61000208589296   | 7.61781121854197   occ= 0
MO #121 energy= 7.61390665221746   | 7.61000208589296   | 7.61781121854196   occ= 0
MO #122 energy= 7.86233403538638   | 7.85668525349009   | 7.86798281726129   occ= 0
MO #123 energy= 9.00391192312129   | 8.9978387462391    | 9.00998509994101   occ= 0
MO #124 energy= 9.07155189594523   | 9.04638694748632   | 9.09671684616682   occ= 0
MO #125 energy= 9.07156855099719   | 9.04629853905433   | 9.09683856294005   occ= 0
MO #126 energy= 9.08474666852161   | 9.0699811522843    | 9.09951218475894   occ= 0
MO #127 energy= 9.08474666852162   | 9.06998115228431   | 9.09951218475894   occ= 0
MO #128 energy= 9.18265593596658   | 9.17884724605225   | 9.18646462588093   occ= 0
MO #129 energy= 9.19053077701863   | 9.17347996916539   | 9.20758158635433   occ= 0
MO #130 energy= 9.2451276634865    | 9.23605150327092   | 9.25420382370209   occ= 0
MO #131 energy= 9.24512766348651   | 9.23605150327091   | 9.25420382370208   occ= 0
MO #132 energy= 9.52868380436833   | 9.52087897604153   | 9.53648863302058   occ= 0
MO #133 energy= 13.5578181556531   | 13.5575018876877   | 13.5581344236171   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0Ti 3s        1.99957
pop of  0Ti 4s        0.89277
pop of  0Ti 5s        0.00500
pop of  0Ti 6s        0.00230
pop of  0Ti 7s        0.00185
pop of  0Ti 8s        0.00115
pop of  0Ti 3px       1.99917
pop of  0Ti 3py       1.99917
pop of  0Ti 3pz       1.99612
pop of  0Ti 4px       0.00830
pop of  0Ti 4py       0.00830
pop of  0Ti 4pz       0.06802
pop of  0Ti 5px       0.00021
pop of  0Ti 5py       0.00021
pop of  0Ti 5pz       0.00701
pop of  0Ti 6px       0.00003
pop of  0Ti 6py       0.00003
pop of  0Ti 6pz       0.00163
pop of  0Ti 7px       0.00036
pop of  0Ti 7py       0.00036
pop of  0Ti 7pz       0.01523
pop of  0Ti 8px       0.00004
pop of  0Ti 8py       0.00004
pop of  0Ti 8pz       0.00150
pop of  0Ti 3dxy      0.99079
pop of  0Ti 3dyz      0.30578
pop of  0Ti 3dz^2     0.52564
pop of  0Ti 3dxz      0.30578
pop of  0Ti 3dx2-y2    0.00030
pop of  0Ti 4dxy      0.00640
pop of  0Ti 4dyz      0.00034
pop of  0Ti 4dz^2     0.00836
pop of  0Ti 4dxz      0.00034
pop of  0Ti 4dx2-y2    0.00000
pop of  0Ti 5dxy      0.00040
pop of  0Ti 5dyz      0.00012
pop of  0Ti 5dz^2     0.00258
pop of  0Ti 5dxz      0.00012
pop of  0Ti 5dx2-y2    0.00000
pop of  0Ti 6dxy      0.00128
pop of  0Ti 6dyz      0.00001
pop of  0Ti 6dz^2     0.00132
pop of  0Ti 6dxz      0.00001
pop of  0Ti 6dx2-y2    0.00000
pop of  0Ti 7dxy      0.00002
pop of  0Ti 7dyz      0.00000
pop of  0Ti 7dz^2     0.00005
pop of  0Ti 7dxz      0.00000
pop of  0Ti 7dx2-y2    0.00000
pop of  0Ti 4fy^3     0.00004
pop of  0Ti 4fxyz     0.00000
pop of  0Ti 4fyz^2    0.00013
pop of  0Ti 4fz^3     0.00024
pop of  0Ti 4fxz^2    0.00013
pop of  0Ti 4fzx^2    0.00000
pop of  0Ti 4fx^3     0.00004
pop of  0Ti 5fy^3     0.00007
pop of  0Ti 5fxyz     0.00007
pop of  0Ti 5fyz^2    0.00126
pop of  0Ti 5fz^3     0.00195
pop of  0Ti 5fxz^2    0.00126
pop of  0Ti 5fzx^2    0.00000
pop of  0Ti 5fx^3     0.00007
pop of  0Ti 6fy^3     0.00001
pop of  0Ti 6fxyz     0.00011
pop of  0Ti 6fyz^2    0.00066
pop of  0Ti 6fz^3     0.00457
pop of  0Ti 6fxz^2    0.00066
pop of  0Ti 6fzx^2    0.00000
pop of  0Ti 6fx^3     0.00001
pop of  0Ti 5g-4      0.00000
pop of  0Ti 5g-3      0.00000
pop of  0Ti 5g-2      0.00000
pop of  0Ti 5g-1      0.00001
pop of  0Ti 5g 0      0.00002
pop of  0Ti 5g 1      0.00001
pop of  0Ti 5g 2      0.00000
pop of  0Ti 5g 3      0.00000
pop of  0Ti 5g 4      0.00000
pop of  0Ti 6g-4      0.00000
pop of  0Ti 6g-3      0.00000
pop of  0Ti 6g-2      0.00000
pop of  0Ti 6g-1      0.00008
pop of  0Ti 6g 0      0.00083
pop of  0Ti 6g 1      0.00008
pop of  0Ti 6g 2      0.00000
pop of  0Ti 6g 3      0.00000
pop of  0Ti 6g 4      0.00001
pop of  1O 2s        1.85480
pop of  1O 3s        0.00192
pop of  1O 4s        0.00384
pop of  1O 5s        0.01391
pop of  1O 2px       1.67041
pop of  1O 2py       1.67041
pop of  1O 2pz       1.57443
pop of  1O 3px       0.00002
pop of  1O 3py       0.00002
pop of  1O 3pz       0.00051
pop of  1O 4px       0.00404
pop of  1O 4py       0.00404
pop of  1O 4pz       0.00103
pop of  1O 5px       0.00225
pop of  1O 5py       0.00225
pop of  1O 5pz       0.00481
pop of  1O 3dxy      0.00000
pop of  1O 3dyz      0.00035
pop of  1O 3dz^2     0.00048
pop of  1O 3dxz      0.00035
pop of  1O 3dx2-y2    0.00000
pop of  1O 4dxy      0.00000
pop of  1O 4dyz      0.00263
pop of  1O 4dz^2     0.00273
pop of  1O 4dxz      0.00263
pop of  1O 4dx2-y2    0.00000
pop of  1O 5dxy      0.00055
pop of  1O 5dyz      0.00348
pop of  1O 5dz^2     0.00337
pop of  1O 5dxz      0.00348
pop of  1O 5dx2-y2    0.00000
pop of  1O 4fy^3     0.00000
pop of  1O 4fxyz     0.00000
pop of  1O 4fyz^2    0.00007
pop of  1O 4fz^3     0.00012
pop of  1O 4fxz^2    0.00007
pop of  1O 4fzx^2    0.00000
pop of  1O 4fx^3     0.00000
pop of  1O 5fy^3     0.00000
pop of  1O 5fxyz     0.00007
pop of  1O 5fyz^2    0.00013
pop of  1O 5fz^3     0.00034
pop of  1O 5fxz^2    0.00013
pop of  1O 5fzx^2    0.00000
pop of  1O 5fx^3     0.00000
 ** Mulliken atomic charges  **
charge of  0Ti =      0.82965
charge of  1O =     -0.82965

******** <class 'pyscf.mcscf.mc1step.CASSCF'> flags ********
CAS (5e+3e, 9o), ncore = 5, nvir = 119
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
chkfile = ./scratch/24907/tmpOiSjR8
max_memory 4000 MB (current use 504 MB)
internal_rotation = False

******** SHCI flags ********
executable             = /home/bamu3429/softwares/dice/Dice
mpiprefix              = srun -n20
scratchDirectory       = ./scratch/24907
integralFile           = ./FCIDUMP
configFile             = ./input.dat
outputFile             = ./output.dat
maxIter                = 6
sweep_iter             = []
sweep_epsilon          = []
nPTiter                = 0
Stochastic             = True
fullrestart            = False
restart                = False
num_thrds              = 12
memory                 = None

CASCI E = -73.2752885869641  S^2 = 2.0000000
Set conv_tol_grad to 0.000316228
macro iter 1 (7 JK  2 micro), CASSCF E = -73.2754113129613  dE = -0.000122726  S^2 = 2.0000000
               |grad[o]|=0.000151  |grad[c]|= None  |ddm|=0.018
macro iter 2 (7 JK  2 micro), CASSCF E = -73.2759305954597  dE = -0.0005192825  S^2 = 2.0000000
               |grad[o]|=0.000907  |grad[c]|= None  |ddm|=0.00343
macro iter 3 (21 JK  4 micro), CASSCF E = -73.2958234795868  dE = -0.019892884  S^2 = 2.0000000
               |grad[o]|=0.00405  |grad[c]|= None  |ddm|=0.0494
macro iter 4 (21 JK  4 micro), CASSCF E = -73.3041176488716  dE = -0.0082941693  S^2 = 2.0000000
               |grad[o]|=0.0567  |grad[c]|= None  |ddm|=0.058
macro iter 5 (21 JK  4 micro), CASSCF E = -73.3054313772006  dE = -0.0013137283  S^2 = 2.0000000
               |grad[o]|=0.0449  |grad[c]|= None  |ddm|=0.0384
macro iter 6 (21 JK  4 micro), CASSCF E = -73.3061985954912  dE = -0.00076721829  S^2 = 2.0000000
               |grad[o]|=0.0339  |grad[c]|= None  |ddm|=0.0205
macro iter 7 (21 JK  4 micro), CASSCF E = -73.305263097557  dE = 0.00093549793  S^2 = 2.0000000
               |grad[o]|=0.0359  |grad[c]|= None  |ddm|=0.0308
macro iter 8 (21 JK  4 micro), CASSCF E = -73.31122475885  dE = -0.0059616613  S^2 = 2.0000000
               |grad[o]|=0.075  |grad[c]|= None  |ddm|=0.0089
macro iter 9 (21 JK  4 micro), CASSCF E = -73.3312436374738  dE = -0.020018879  S^2 = 2.0000000
               |grad[o]|=0.0493  |grad[c]|= None  |ddm|=0.0585
macro iter 10 (21 JK  4 micro), CASSCF E = -73.3642093816731  dE = -0.032965744  S^2 = 2.0000000
               |grad[o]|=0.0409  |grad[c]|= None  |ddm|=0.0537
macro iter 11 (21 JK  4 micro), CASSCF E = -73.3880215624633  dE = -0.023812181  S^2 = 2.0000000
               |grad[o]|=0.0513  |grad[c]|= None  |ddm|=0.0428
macro iter 12 (21 JK  4 micro), CASSCF E = -73.4033132726273  dE = -0.01529171  S^2 = 2.0000000
               |grad[o]|=0.0519  |grad[c]|= None  |ddm|=0.0494
macro iter 13 (21 JK  4 micro), CASSCF E = -73.4093744000753  dE = -0.0060611274  S^2 = 2.0000000
               |grad[o]|=0.0411  |grad[c]|= None  |ddm|=0.0441
macro iter 14 (20 JK  4 micro), CASSCF E = -73.4127899549366  dE = -0.0034155549  S^2 = 2.0000000
               |grad[o]|=0.0331  |grad[c]|= None  |ddm|=0.025
macro iter 15 (20 JK  4 micro), CASSCF E = -73.4147779231608  dE = -0.0019879682  S^2 = 2.0000000
               |grad[o]|=0.0282  |grad[c]|= None  |ddm|=0.0145
macro iter 16 (21 JK  4 micro), CASSCF E = -73.4150714900694  dE = -0.00029356691  S^2 = 2.0000000
               |grad[o]|=0.0258  |grad[c]|= None  |ddm|=0.00993
macro iter 17 (21 JK  4 micro), CASSCF E = -73.4150090350169  dE = 6.2455053e-05  S^2 = 2.0000000
               |grad[o]|=0.0262  |grad[c]|= None  |ddm|=0.00856
macro iter 18 (21 JK  4 micro), CASSCF E = -73.4195407744259  dE = -0.0045317394  S^2 = 2.0000000
               |grad[o]|=0.0263  |grad[c]|= None  |ddm|=0.00456
macro iter 19 (17 JK  4 micro), CASSCF E = -73.4195224271475  dE = 1.8347278e-05  S^2 = 2.0000000
               |grad[o]|=0.0151  |grad[c]|= None  |ddm|=0.00752
macro iter 20 (15 JK  4 micro), CASSCF E = -73.4210425853407  dE = -0.0015201582  S^2 = 2.0000000
               |grad[o]|=0.0155  |grad[c]|= None  |ddm|=0.00509
macro iter 21 (14 JK  4 micro), CASSCF E = -73.4212514437085  dE = -0.00020885837  S^2 = 2.0000000
               |grad[o]|=0.00606  |grad[c]|= None  |ddm|=0.0055
macro iter 22 (15 JK  4 micro), CASSCF E = -73.4212699459136  dE = -1.8502205e-05  S^2 = 2.0000000
               |grad[o]|=0.00192  |grad[c]|= None  |ddm|=0.00247
macro iter 23 (8 JK  2 micro), CASSCF E = -73.4212702028439  dE = -2.5693031e-07  S^2 = 2.0000000
               |grad[o]|=0.000242  |grad[c]|= None  |ddm|=0.000282
macro iter 24 (3 JK  1 micro), CASSCF E = -73.4212702066463  dE = -3.80237e-09  S^2 = 2.0000000
               |grad[o]|=7.6e-05  |grad[c]|= None  |ddm|=    0
1-step CASSCF converged in 24 macro (420 JK 87 micro) steps
CASSCF canonicalization
CASSCF energy = -73.4212702066463


--------------------------------------------------
                 ICMPSPT CALCULATION              
--------------------------------------------------

Perturbation type: MRLCC
With fully internally contracted scheme
With third order correction

Preparing necessary RDMs
......production of RDMs took      73.45 sec
Reading binary 4RDM from DICE
......reading the RDM took         27.03 sec

(GOOD) Trace 4RDM:   1680.0 =    8*    7*    6*    5
(GOOD) Trace 3RDM:    336.0 =    8*    7*    6
(GOOD) Trace 2RDM:     56.0 =    8*    7
(GOOD) Trace 1RDM:      8.0 =    8

Producing the integrals
......production of INT took     137.46 sec

Energy_core =  -81.06026730
Energy      =  -73.42127021

WARNING: Have to use natural orbitals from CAASCF
         offdiagonal elements:    0.65225744

Basic ingredients written to int/
......savings of INGREDIENTS took     127.84 sec

Second-order:
perturber CCVV --        -0.156043546
perturber CCAV --        -0.079233887
perturber ACVV --        -0.127066327
perturber CCAA --        -0.027148598
perturber AAVV --        -0.100572390
perturber CAAV --        -0.111457986
