#INFO: **** input file is /projects/bamu3429/BENCHMARK/fresh_atoms/MRPT/monoxides/VO/mrpt.py ****
import json
from pyscf import gto,scf,mcscf, fci, lo, ci, cc
from pyscf.scf import ROHF, UHF,ROKS
import numpy as np
import pandas as pd

# THIS IS WERE IT STARTS ====================================

df=json.load(open("../../trail.json"))

spins={'ScO':1, 'TiO':2, 'VO':3, 'CrO':4, 'MnO':5, 'FeO':4, 'CuO':1}

nd={'Sc':(1,0), 'Ti':(2,0), 'V':(3,0), 'Cr':(5,0), 'Mn':(5,0), 'Fe':(5,1), 'Cu':(5,4)}

cas={'Sc':3, 'Ti':4, 'V':5, 'Cr':6, 'Mn':7, 'Fe':8, 'Cu':11}

re={'ScO':1.668, 'TiO':1.623, 'VO':1.591, 'CrO':1.621, 'MnO':1.648, 'FeO':1.616, 'CuO':1.725}

datacsv={}
for nm in ['basis','charge','method','molecule','pseudopotential',
           'totalenergy','totalenergy-stocherr','totalenergy-syserr']:
  datacsv[nm]=[]

basis='vdz'
element='V'

mol=gto.Mole()
mol.ecp={}
mol.basis={}
for el in [element,'O']:
  mol.ecp[el]=gto.basis.parse_ecp(df[el]['ecp'])
  mol.basis[el]=gto.basis.parse(df[el][basis])
mol.charge=0
mol.spin=spins[element+'O']
mol.build(atom="%s 0. 0. 0.; O 0. 0. %g"%(element,re[element+'O']),verbose=4)

m=ROHF(mol)
m.level_shift=1000.0
dm=m.from_chk("../../../HF/monoxides/"+element+basis+"0.chk")
hf=m.kernel(dm)
m.analyze()

from pyscf.shciscf import shci
mc = shci.SHCISCF(m, 9, 4+cas[element])
#mc.fcisolver.conv_tol = 1e-14
mc.fcisolver.mpiprefix="mpirun -np 28"
mc.fcisolver.num_thrds=12
mc.verbose = 4
cas=mc.kernel()[0]
 
from pyscf.icmpspt import icmpspt
pt=icmpspt.icmpspt(mc,rdmM=500, PTM=1000,\
                          pttype="MRLCC",\
                          third_order=True,\
                          fully_ic=True,\
                          do_dm4=True)

datacsv['basis'].append(basis)
datacsv['charge'].append(0)
datacsv['method'].append('MRPT')
datacsv['molecule'].append(element)
datacsv['pseudopotential'].append('trail')
datacsv['totalenergy'].append(cas+pt)
datacsv['totalenergy-stocherr'].append(0.0)
datacsv['totalenergy-syserr'].append(0.0)
pd.DataFrame(datacsv).to_csv(element+".csv",index=False)

#INFO: ******************** input file end ********************


System: ('Linux', 'bnode0308.rc.int.colorado.edu', '3.10.0-514.41.1.el7.x86_64', '#1 SMP Wed Jan 17 10:26:16 EST 2018', 'x86_64', 'x86_64')  Threads 1
Python 2.7.11 (default, Mar 22 2016, 01:42:54) 
[GCC Intel(R) C++ gcc 4.8 mode]
numpy 1.11.1  scipy 0.17.1
Date: Mon Mar 26 11:03:25 2018
PySCF version 1.4
PySCF path  /projects/bamu3429/softwares/pyscf_uptodate/pyscf
GIT ORIG_HEAD e2292e6edec2b0e0024c21b81de03db1d7bd4121
GIT HEAD      ref: refs/heads/master
GIT master branch  f3591ef22170896a4cdc2aadaa6f5da388ffcadb

[INPUT] VERBOSE 4
[INPUT] num atoms = 2
[INPUT] num electrons = 19
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 3
[INPUT] symmetry False subgroup None
[INPUT]  1 V      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 O      0.000000000000   0.000000000000   1.591000000000 AA    0.000000000000   0.000000000000   3.006554264183 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] O
[INPUT] 0    0    [10   /1   ]  57.663349         -0.002794
                                35.726816         0.023976
                                22.453757         -0.115974
                                14.732301         0.288033
                                9.739917          -0.274786
                                5.042008          -0.083789
                                2.157818          0.063778
                                1.002916          0.410182
                                0.421839          0.504044
                                0.173041          0.172152
[INPUT] 0    0    [1    /1   ]  0.222099             1
[INPUT] 0    0    [1    /1   ]  0.08884              1
[INPUT] 1    0    [10   /1   ]  52.47406          -0.000522
                                32.138432         0.004857
                                19.458579         -0.027749
                                11.839344         0.074258
                                7.91003           0.014369
                                3.670858          0.153479
                                1.53966           0.283685
                                0.647119          0.358201
                                0.267853          0.29559
                                0.107198          0.104889
[INPUT] 1    0    [1    /1   ]  0.252604             1
[INPUT] 1    0    [1    /1   ]  0.101042             1
[INPUT] 2    0    [1    /1   ]  1.223113             1
[INPUT] 2    0    [1    /1   ]  0.489245             1
[INPUT] V
[INPUT] 0    0    [12   /1   ]  33.51168105       0.006845
                                15.38532624       -0.214557
                                9.96227367        1.392425
                                8.05943355        -1.485929
                                3.6960334         -0.026725
                                1.49220279        0.457681
                                0.84622253        0.506886
                                0.43855031        0.249453
                                0.2102388         0.007109
                                0.1022422         0.007055
                                0.04832462        -0.000443
                                0.02406855        0.001278
[INPUT] 0    0    [12   /1   ]  33.51168105       -0.001211
                                15.38532624       0.04697
                                9.96227367        -0.329808
                                8.05943355        0.363635
                                3.6960334         0.005985
                                1.49220279        -0.140857
                                0.84622253        -0.203846
                                0.43855031        -0.200776
                                0.2102388         0.022081
                                0.1022422         0.429765
                                0.04832462        0.534383
                                0.02406855        0.187984
[INPUT] 0    0    [12   /1   ]  33.51168105       -0.006871
                                15.38532624       0.226397
                                9.96227367        -1.640881
                                8.05943355        1.900984
                                3.6960334         -0.211293
                                1.49220279        -1.475616
                                0.84622253        0.220931
                                0.43855031        0.532517
                                0.2102388         0.907357
                                0.1022422         0.106097
                                0.04832462        -0.528638
                                0.02406855        -0.33681
[INPUT] 0    0    [1    /1   ]  0.02406855           1
[INPUT] 0    0    [1    /1   ]  0.01198757           1
[INPUT] 1    0    [12   /1   ]  49.83779697       0.000413
                                25.60370921       -0.003442
                                10.40982442       0.097153
                                7.71483683        -0.206888
                                4.49868206        0.083281
                                2.48212838        0.186621
                                1.4387019         0.395144
                                0.72090362        0.377883
                                0.3443302         0.134629
                                0.13162828        0.011074
                                0.05284968        -0.000426
                                0.02121951        0.000256
[INPUT] 1    0    [12   /1   ]  49.83779697       -2.9e-05
                                25.60370921       0.000502
                                10.40982442       -0.020934
                                7.71483683        0.047431
                                4.49868206        -0.020701
                                2.48212838        -0.057583
                                1.4387019         -0.106451
                                0.72090362        -0.140229
                                0.3443302         0.043257
                                0.13162828        0.438687
                                0.05284968        0.536785
                                0.02121951        0.12546
[INPUT] 1    0    [12   /1   ]  49.83779697       9e-05
                                25.60370921       -0.002342
                                10.40982442       0.125465
                                7.71483683        -0.321923
                                4.49868206        0.19446
                                2.48212838        0.693755
                                1.4387019         0.323454
                                0.72090362        -0.875978
                                0.3443302         -0.540174
                                0.13162828        0.69685
                                0.05284968        0.327275
                                0.02121951        -0.009315
[INPUT] 1    0    [1    /1   ]  0.02121951           1
[INPUT] 1    0    [1    /1   ]  0.00851977           1
[INPUT] 2    0    [10   /1   ]  34.27504048       0.000678
                                16.12418185       -0.017858
                                9.59474528        0.107867
                                3.8690861         0.173949
                                1.82728072        0.26883
                                0.85799457        0.321303
                                0.38035078        0.300128
                                0.15533087        0.170792
                                0.06318167        0.035148
                                0.03734397        0.003549
[INPUT] 2    0    [10   /1   ]  34.27504048       0.000411
                                16.12418185       0.011699
                                9.59474528        -0.096988
                                3.8690861         -0.225228
                                1.82728072        -0.395141
                                0.85799457        -0.078275
                                0.38035078        0.3045
                                0.15533087        0.474064
                                0.06318167        0.20462
                                0.03734397        0.016541
[INPUT] 2    0    [1    /1   ]  0.03734397           1
[INPUT] 2    0    [1    /1   ]  0.02207241           1
[INPUT] 3    0    [1    /1   ]  1.853039             1
[INPUT] 3    0    [1    /1   ]  1.0952517            1
nuclear repulsion = 25.9433202085229
number of shells = 24
number of NR pGTOs = 334
number of NR cGTOs = 76
basis = {'O': [[0, [57.663349, -0.002794], [35.726816, 0.023976], [22.453757, -0.115974], [14.732301, 0.288033], [9.739917, -0.274786], [5.042008, -0.083789], [2.157818, 0.063778], [1.002916, 0.410182], [0.421839, 0.504044], [0.173041, 0.172152]], [0, [0.222099, 1.0]], [0, [0.08884, 1.0]], [1, [52.47406, -0.000522], [32.138432, 0.004857], [19.458579, -0.027749], [11.839344, 0.074258], [7.91003, 0.014369], [3.670858, 0.153479], [1.53966, 0.283685], [0.647119, 0.358201], [0.267853, 0.29559], [0.107198, 0.104889]], [1, [0.252604, 1.0]], [1, [0.101042, 1.0]], [2, [1.223113, 1.0]], [2, [0.489245, 1.0]]], 'V': [[0, [33.51168105, 0.006845], [15.38532624, -0.214557], [9.96227367, 1.392425], [8.05943355, -1.485929], [3.6960334, -0.026725], [1.49220279, 0.457681], [0.84622253, 0.506886], [0.43855031, 0.249453], [0.2102388, 0.007109], [0.1022422, 0.007055], [0.04832462, -0.000443], [0.02406855, 0.001278]], [0, [33.51168105, -0.001211], [15.38532624, 0.04697], [9.96227367, -0.329808], [8.05943355, 0.363635], [3.6960334, 0.005985], [1.49220279, -0.140857], [0.84622253, -0.203846], [0.43855031, -0.200776], [0.2102388, 0.022081], [0.1022422, 0.429765], [0.04832462, 0.534383], [0.02406855, 0.187984]], [0, [33.51168105, -0.006871], [15.38532624, 0.226397], [9.96227367, -1.640881], [8.05943355, 1.900984], [3.6960334, -0.211293], [1.49220279, -1.475616], [0.84622253, 0.220931], [0.43855031, 0.532517], [0.2102388, 0.907357], [0.1022422, 0.106097], [0.04832462, -0.528638], [0.02406855, -0.33681]], [0, [0.02406855, 1.0]], [0, [0.01198757, 1.0]], [1, [49.83779697, 0.000413], [25.60370921, -0.003442], [10.40982442, 0.097153], [7.71483683, -0.206888], [4.49868206, 0.083281], [2.48212838, 0.186621], [1.4387019, 0.395144], [0.72090362, 0.377883], [0.3443302, 0.134629], [0.13162828, 0.011074], [0.05284968, -0.000426], [0.02121951, 0.000256]], [1, [49.83779697, -2.9e-05], [25.60370921, 0.000502], [10.40982442, -0.020934], [7.71483683, 0.047431], [4.49868206, -0.020701], [2.48212838, -0.057583], [1.4387019, -0.106451], [0.72090362, -0.140229], [0.3443302, 0.043257], [0.13162828, 0.438687], [0.05284968, 0.536785], [0.02121951, 0.12546]], [1, [49.83779697, 9e-05], [25.60370921, -0.002342], [10.40982442, 0.125465], [7.71483683, -0.321923], [4.49868206, 0.19446], [2.48212838, 0.693755], [1.4387019, 0.323454], [0.72090362, -0.875978], [0.3443302, -0.540174], [0.13162828, 0.69685], [0.05284968, 0.327275], [0.02121951, -0.009315]], [1, [0.02121951, 1.0]], [1, [0.00851977, 1.0]], [2, [34.27504048, 0.000678], [16.12418185, -0.017858], [9.59474528, 0.107867], [3.8690861, 0.173949], [1.82728072, 0.26883], [0.85799457, 0.321303], [0.38035078, 0.300128], [0.15533087, 0.170792], [0.06318167, 0.035148], [0.03734397, 0.003549]], [2, [34.27504048, 0.000411], [16.12418185, 0.011699], [9.59474528, -0.096988], [3.8690861, -0.225228], [1.82728072, -0.395141], [0.85799457, -0.078275], [0.38035078, 0.3045], [0.15533087, 0.474064], [0.06318167, 0.20462], [0.03734397, 0.016541]], [2, [0.03734397, 1.0]], [2, [0.02207241, 1.0]], [3, [1.853039, 1.0]], [3, [1.0952517, 1.0]]]}
ecp = {'O': [2, [[-1, [[], [[10.27717748, 6.0]], [[15.99566749, 1232.50197768], [10.46901775, -696.47008301], [14.6384801, -2654.22657081], [12.57591181, 2101.67732548]], [[7.77739102, 61.66306486]]]], [0, [[], [], [[12.39426073, -656683.37638839], [12.38126171, 657858.57667068], [8.57671033, 511.50098405], [9.89256508, -2579.54665641], [28.05641604, -57.68129584], [17.24753607, 970.30940152]], []]], [1, [[], [], [[14.78918914, -363027.24258186], [14.82014018, 361852.52314043], [22.89622221, -1300.20069256], [8.51331893, -181.96869573], [11.48609758, 2194.87589959], [27.22017524, 451.19906206]], []]]]], 'V': [10, [[-1, [[], [[8.85341849, 13.0]], [[14.12393489, 1867.96836466], [10.01469125, -417.2185296], [16.87739786, -6735.41034163], [17.42661229, 5248.9519915]], [[8.14766139, 115.09444037]]]], [0, [[], [], [[10.17161428, 8429.89768085], [6.62108601, -4738.0869454], [6.4407206, 3874.69004628], [11.26222343, -9817.80452096], [19.82459033, -286.16022228], [14.35299938, 2571.80634504]], []]], [1, [[], [], [[10.25117807, 40641.17869487], [10.49106006, -41559.00487832], [13.7869188, 3357.33248976], [16.29479305, -896.47755921], [7.79003518, -1904.45864373], [6.62830213, 382.3757783]], []]], [2, [[], [], [[8.601477, 4615.05527413], [10.66674565, -3671.60281242], [15.19026557, 4480.50015686], [8.06189603, -2591.12632756], [19.82232597, 2587.18683714], [18.22318105, -5431.92186158]], []]]]]}
CPU time:         0.57


******** <class 'pyscf.scf.rohf.ROHF'> flags ********
method = ROHF
initial guess = minao
damping factor = 0
level shift factor = 1000.0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /projects/bamu3429/BENCHMARK/fresh_atoms/MRPT/monoxides/VO/tmp9gboTJ
max_memory 4000 MB (current use 81 MB)
num. doubly occ = 8  num. singly occ = 3
Set gradient conv threshold to 3.16228e-05
init E= -86.3988493877069
  HOMO = 499.885945537231  LUMO = 1000.01359680966
cycle= 1 E= -86.3988493877071  delta_E= -2.42e-13  |g|= 1.13e-05  |ddm|= 4.11e-08
  HOMO = -0.114054463440218  LUMO = 0.0135968097167061
Extra cycle  E= -86.3988493877486  delta_E= -4.15e-11  |g|= 1.04e-05  |ddm|= 2.59e-05
converged SCF energy = -86.3988493877486
**** MO energy ****
                Roothaan           | alpha              | beta
MO #1   energy= -3.26758391802606  | -3.3478841063261   | -3.18728374042716  occ= 2
MO #2   energy= -2.10517655458992  | -2.13359667351317  | -2.07675643585942  occ= 2
MO #3   energy= -2.06929137484066  | -2.19933187581886  | -1.93925087386246  occ= 2
MO #4   energy= -2.06929137484066  | -2.19933187581886  | -1.93925087386246  occ= 2
MO #5   energy= -1.17747839791458  | -1.18089535187673  | -1.17406144146549  occ= 2
MO #6   energy= -0.479702493056528 | -0.49085860321751  | -0.468546412251839 occ= 2
MO #7   energy= -0.453355406062233 | -0.458470866119188 | -0.448239946005277 occ= 2
MO #8   energy= -0.453355406062232 | -0.458470866119188 | -0.448239946005277 occ= 2
MO #9   energy= -0.126917408504441 | -0.286099422730531 | 0.0322640684544966 occ= 1
MO #10  energy= -0.114054463440523 | -0.492033815676619 | 0.263924889044718  occ= 1
MO #11  energy= -0.114054463440218 | -0.492033815683501 | 0.263924889047168  occ= 1
MO #12  energy= 0.0135968097167061 | 0.00975250065066397 | 0.0174411187827509 occ= 0
MO #13  energy= 0.0135968097167069 | 0.00975250065066445 | 0.0174411187827498 occ= 0
MO #14  energy= 0.0139124735507336 | 0.0115109565177856 | 0.0163141707335888 occ= 0
MO #15  energy= 0.0286105741987752 | 0.0278343476329423 | 0.0293867832841601 occ= 0
MO #16  energy= 0.0423862733146433 | 0.0291002729772684 | 0.0556722736520195 occ= 0
MO #17  energy= 0.0423862733146454 | 0.0291002729772704 | 0.0556722736520195 occ= 0
MO #18  energy= 0.048603520128401  | 0.0370412326991226 | 0.0601660351597427 occ= 0
MO #19  energy= 0.061769928781827  | 0.0613399012485319 | 0.0621999572511652 occ= 0
MO #20  energy= 0.0617699287818606 | 0.0613399012485498 | 0.0621999572511418 occ= 0
MO #21  energy= 0.0688482248711432 | 0.0670656346087965 | 0.0706308151334904 occ= 0
MO #22  energy= 0.0688482248711474 | 0.0670656346088005 | 0.0706308151334955 occ= 0
MO #23  energy= 0.0787887756607678 | 0.0717694499543651 | 0.0858082708092745 occ= 0
MO #24  energy= 0.120197238110921  | 0.109065795756193  | 0.131328772601697  occ= 0
MO #25  energy= 0.141583460453662  | 0.124207307520684  | 0.158959613386641  occ= 0
MO #26  energy= 0.141583460453667  | 0.124207307520681  | 0.158959613386653  occ= 0
MO #27  energy= 0.153963368753515  | 0.142383739949139  | 0.165542915951403  occ= 0
MO #28  energy= 0.17909026377783   | 0.171316626192259  | 0.186863897688778  occ= 0
MO #29  energy= 0.179090263778451  | 0.171316626192553  | 0.186863897688896  occ= 0
MO #30  energy= 0.196933798196484  | 0.185412633116523  | 0.208454963276448  occ= 0
MO #31  energy= 0.196933798196515  | 0.185412633116557  | 0.208454963276474  occ= 0
MO #32  energy= 0.211894318953028  | 0.200438132472474  | 0.223350542962509  occ= 0
MO #33  energy= 0.249127043993355  | 0.221773401286629  | 0.27648068670008   occ= 0
MO #34  energy= 0.249127043993355  | 0.221773401286629  | 0.27648068670008   occ= 0
MO #35  energy= 0.37339427665496   | 0.364747579199006  | 0.382040952324716  occ= 0
MO #36  energy= 0.462428974115834  | 0.460796827133695  | 0.464061121097971  occ= 0
MO #37  energy= 0.462428974115859  | 0.460796827133722  | 0.464061121097998  occ= 0
MO #38  energy= 0.473020477841626  | 0.465418810871101  | 0.480622136450657  occ= 0
MO #39  energy= 1.00239179298857   | 0.979193069747308  | 1.02559051671793   occ= 0
MO #40  energy= 1.09017505476921   | 1.02019235785371   | 1.16015774500403   occ= 0
MO #41  energy= 1.09017505477398   | 1.02019235785769   | 1.16015774500565   occ= 0
MO #42  energy= 1.23368780752672   | 1.21270770343058   | 1.25466791162285   occ= 0
MO #43  energy= 1.23368780752672   | 1.21270770343058   | 1.25466791162285   occ= 0
MO #44  energy= 1.43127414927232   | 1.42306234364171   | 1.43948596434778   occ= 0
MO #45  energy= 1.43127414927259   | 1.42306234364176   | 1.43948596434806   occ= 0
MO #46  energy= 1.49735560395897   | 1.49413863974362   | 1.50057256860953   occ= 0
MO #47  energy= 1.53627568431255   | 1.5329815060059    | 1.5395698626192    occ= 0
MO #48  energy= 1.53627568431257   | 1.53298150600593   | 1.53956986261921   occ= 0
MO #49  energy= 1.58613604053625   | 1.58150064837929   | 1.59077143269321   occ= 0
MO #50  energy= 1.58613604053625   | 1.58150064837929   | 1.59077143269321   occ= 0
MO #51  energy= 1.5996005864514    | 1.57611367892008   | 1.62308748478432   occ= 0
MO #52  energy= 1.88568885122079   | 1.8741218474552    | 1.89725586190896   occ= 0
MO #53  energy= 2.04742187556043   | 2.03343417547605   | 2.06140957644962   occ= 0
MO #54  energy= 2.61724833905453   | 2.56767399859329   | 2.66682267951579   occ= 0
MO #55  energy= 2.61724833905454   | 2.56767399859329   | 2.66682267951579   occ= 0
MO #56  energy= 2.97092504933254   | 2.88570969668339   | 3.05614040198171   occ= 0
MO #57  energy= 2.97092504933255   | 2.8857096966834    | 3.05614040198171   occ= 0
MO #58  energy= 3.00580625857903   | 2.98945644978813   | 3.02215606597284   occ= 0
MO #59  energy= 3.00624166349741   | 2.96996124073746   | 3.04252208603231   occ= 0
MO #60  energy= 3.00624166349744   | 2.9699612407375    | 3.04252208603234   occ= 0
MO #61  energy= 3.279164041882     | 3.26099789606506   | 3.29733018769894   occ= 0
MO #62  energy= 3.279164041882     | 3.26099789606506   | 3.29733018769894   occ= 0
MO #63  energy= 3.75307124001844   | 3.73860812316436   | 3.76753435625961   occ= 0
MO #64  energy= 4.21070579826892   | 4.21020535731884   | 4.21120623920994   occ= 0
MO #65  energy= 4.21070579826895   | 4.21020535731887   | 4.21120623920997   occ= 0
MO #66  energy= 4.31896621069606   | 4.31829826248224   | 4.31963415890989   occ= 0
MO #67  energy= 4.31896621069606   | 4.31829826248225   | 4.31963415890989   occ= 0
MO #68  energy= 4.51895006662755   | 4.5149562025207    | 4.52294393070289   occ= 0
MO #69  energy= 6.88464894259207   | 6.87487321320427   | 6.89442467197824   occ= 0
MO #70  energy= 7.4755326866835    | 7.40721058251736   | 7.54385479084968   occ= 0
MO #71  energy= 7.47553268668353   | 7.40721058251738   | 7.5438547908497    occ= 0
MO #72  energy= 7.48452450222357   | 7.45209485569587   | 7.51695414871573   occ= 0
MO #73  energy= 7.48452450222384   | 7.45209485569683   | 7.51695414871529   occ= 0
MO #74  energy= 7.64239512462127   | 7.61994269300915   | 7.66484755623343   occ= 0
MO #75  energy= 7.64239512462129   | 7.61994269300918   | 7.66484755623346   occ= 0
MO #76  energy= 7.75690577096665   | 7.73634402584745   | 7.77746751608268   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0V 3s        1.99961
pop of  0V 4s        0.87385
pop of  0V 5s        0.00485
pop of  0V 6s        0.00466
pop of  0V 7s        0.00224
pop of  0V 3px       1.99952
pop of  0V 3py       1.99952
pop of  0V 3pz       1.99677
pop of  0V 4px       0.00986
pop of  0V 4py       0.00986
pop of  0V 4pz       0.06116
pop of  0V 5px       0.00019
pop of  0V 5py       0.00019
pop of  0V 5pz       0.00552
pop of  0V 6px       0.00021
pop of  0V 6py       0.00021
pop of  0V 6pz       0.00856
pop of  0V 7px       0.00004
pop of  0V 7py       0.00004
pop of  0V 7pz       0.00084
pop of  0V 3dxy      0.99753
pop of  0V 3dyz      0.29499
pop of  0V 3dz^2     0.60553
pop of  0V 3dxz      0.29499
pop of  0V 3dx2-y2    0.99753
pop of  0V 4dxy      0.00175
pop of  0V 4dyz      0.00155
pop of  0V 4dz^2     0.00193
pop of  0V 4dxz      0.00155
pop of  0V 4dx2-y2    0.00175
pop of  0V 5dxy      0.00063
pop of  0V 5dyz      0.00000
pop of  0V 5dz^2     0.00132
pop of  0V 5dxz      0.00000
pop of  0V 5dx2-y2    0.00063
pop of  0V 6dxy      0.00003
pop of  0V 6dyz      0.00001
pop of  0V 6dz^2     0.00009
pop of  0V 6dxz      0.00001
pop of  0V 6dx2-y2    0.00003
pop of  0V 4fy^3     0.00000
pop of  0V 4fxyz     0.00000
pop of  0V 4fyz^2    0.00009
pop of  0V 4fz^3     0.00025
pop of  0V 4fxz^2    0.00009
pop of  0V 4fzx^2    0.00000
pop of  0V 4fx^3     0.00000
pop of  0V 5fy^3     0.00000
pop of  0V 5fxyz     0.00002
pop of  0V 5fyz^2    0.00058
pop of  0V 5fz^3     0.00089
pop of  0V 5fxz^2    0.00058
pop of  0V 5fzx^2    0.00002
pop of  0V 5fx^3     0.00000
pop of  1O 2s        1.86695
pop of  1O 3s        0.00480
pop of  1O 4s        0.01521
pop of  1O 2px       1.68177
pop of  1O 2py       1.68177
pop of  1O 2pz       1.53756
pop of  1O 3px       0.00287
pop of  1O 3py       0.00287
pop of  1O 3pz       0.00085
pop of  1O 4px       0.00238
pop of  1O 4py       0.00238
pop of  1O 4pz       0.00176
pop of  1O 3dxy      0.00001
pop of  1O 3dyz      0.00124
pop of  1O 3dz^2     0.00171
pop of  1O 3dxz      0.00124
pop of  1O 3dx2-y2    0.00001
pop of  1O 4dxy      0.00001
pop of  1O 4dyz      0.00470
pop of  1O 4dz^2     0.00308
pop of  1O 4dxz      0.00470
pop of  1O 4dx2-y2    0.00001
 ** Mulliken atomic charges  **
charge of  0V =      0.81788
charge of  1O =     -0.81788

******** <class 'pyscf.mcscf.mc1step.CASSCF'> flags ********
CAS (6e+3e, 9o), ncore = 5, nvir = 62
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
chkfile = ./scratch/142986/tmp3e6EEd
max_memory 4000 MB (current use 129 MB)
internal_rotation = False

******** SHCI flags ********
executable             = /home/bamu3429/softwares/dice/Dice
mpiprefix              = mpirun -np 28
scratchDirectory       = ./scratch/142986
integralFile           = ./FCIDUMP
configFile             = ./input.dat
outputFile             = ./output.dat
maxIter                = 6
sweep_iter             = []
sweep_epsilon          = []
nPTiter                = 0
Stochastic             = True
fullrestart            = False
restart                = False
num_thrds              = 12
memory                 = None

CASCI E = -86.3989242810894  S^2 = 3.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (7 JK  2 micro), CASSCF E = -86.3991857581323  dE = -0.00026147704  S^2 = 3.7500000
               |grad[o]|=0.000675  |grad[c]|= None  |ddm|=0.00673
macro iter 2 (21 JK  4 micro), CASSCF E = -86.4108748524317  dE = -0.011689094  S^2 = 3.7500000
               |grad[o]|=0.00203  |grad[c]|= None  |ddm|=0.0341
macro iter 3 (21 JK  4 micro), CASSCF E = -86.4347086454564  dE = -0.023833793  S^2 = 3.7500000
               |grad[o]|=0.0448  |grad[c]|= None  |ddm|=0.0807
macro iter 4 (21 JK  4 micro), CASSCF E = -86.4596584977451  dE = -0.024949852  S^2 = 3.7500000
               |grad[o]|=0.0646  |grad[c]|= None  |ddm|=0.0443
macro iter 5 (21 JK  4 micro), CASSCF E = -86.510860399892  dE = -0.051201902  S^2 = 3.7500000
               |grad[o]|=0.0672  |grad[c]|= None  |ddm|=0.0649
macro iter 6 (21 JK  4 micro), CASSCF E = -86.5506529392241  dE = -0.039792539  S^2 = 3.7500000
               |grad[o]|=0.0747  |grad[c]|= None  |ddm|=0.0627
macro iter 7 (13 JK  4 micro), CASSCF E = -86.5549719681619  dE = -0.0043190289  S^2 = 3.7500000
               |grad[o]|=0.039  |grad[c]|= None  |ddm|=0.0538
macro iter 8 (11 JK  4 micro), CASSCF E = -86.5549840650165  dE = -1.2096855e-05  S^2 = 3.7500000
               |grad[o]|=0.00225  |grad[c]|= None  |ddm|=0.0057
macro iter 9 (3 JK  1 micro), CASSCF E = -86.5549841487614  dE = -8.3744951e-08  S^2 = 3.7500000
               |grad[o]|=0.000234  |grad[c]|= None  |ddm|=0.000363
1-step CASSCF converged in 9 macro (139 JK 31 micro) steps
CASSCF canonicalization
CASSCF energy = -86.5549841487614


--------------------------------------------------
                 ICMPSPT CALCULATION              
--------------------------------------------------

Perturbation type: MRLCC
With fully internally contracted scheme
With third order correction

Preparing necessary RDMs
......production of RDMs took      56.70 sec
Reading binary 4RDM from DICE
......reading the RDM took         27.64 sec

(GOOD) Trace 4RDM:   3024.0 =    9*    8*    7*    6
(GOOD) Trace 3RDM:    504.0 =    9*    8*    7
(GOOD) Trace 2RDM:     72.0 =    9*    8
(GOOD) Trace 1RDM:      9.0 =    9

Producing the integrals
......production of INT took     168.76 sec

Energy_core =  -92.4819871162
Energy      =  -86.5549841488

WARNING: Have to use natural orbitals from CAASCF
         offdiagonal elements: 0.482776635259

Basic ingredients written to int/
......savings of INGREDIENTS took      29.52 sec

Second-order:
perturber CCVV --        -0.093800531
perturber CCAV --        -0.064863689
perturber ACVV --        -0.097680317
perturber CCAA --        -0.039131666
perturber AAVV --        -0.103535050
perturber CAAV --        -0.120320672
terminate called after throwing an instance of 'std::runtime_error'
  what():  No convergence!
/bin/sh: line 1: 144540 Aborted                 /projects/bamu3429/softwares/icpt/icpt MRLCC_AAAV.inp > MRLCC_AAAV.out
Traceback (most recent call last):
  File "mrpt.py", line 56, in <module>
    do_dm4=True)
  File "/projects/bamu3429/softwares/pyscf_uptodate/pyscf/icmpspt/icmpspt.py", line 1375, in icmpspt
    cumulantE4=cumulantE4, df=df, no_handcoded_E3=no_handcoded_E3)
  File "/projects/bamu3429/softwares/pyscf_uptodate/pyscf/icmpspt/icmpspt.py", line 689, in executeMRLCC
    output = check_call("%s  %s  %s > %s"%(mpiprefix, executable, infile, outfile), shell=True)
  File "/curc/sw/python/2.7.11/lib/python2.7/subprocess.py", line 540, in check_call
    raise CalledProcessError(retcode, cmd)
subprocess.CalledProcessError: Command '  /projects/bamu3429/softwares/icpt/icpt  MRLCC_AAAV.inp > MRLCC_AAAV.out' returned non-zero exit status 134
