#INFO: **** input file is /projects/bamu3429/BENCHMARK/fresh_atoms/MRPT/monoxides/ScO/mrpt.py ****
import json
from pyscf import gto,scf,mcscf, fci, lo, ci, cc
from pyscf.scf import ROHF, UHF,ROKS
import numpy as np
import pandas as pd

# THIS IS WERE IT STARTS ====================================

df=json.load(open("../../trail.json"))

spins={'ScO':1, 'TiO':2, 'VO':3, 'CrO':4, 'MnO':5, 'FeO':4, 'CuO':1}

nd={'Sc':(1,0), 'Ti':(2,0), 'V':(3,0), 'Cr':(5,0), 'Mn':(5,0), 'Fe':(5,1), 'Cu':(5,4)}

cas={'Sc':3, 'Ti':4, 'V':5, 'Cr':6, 'Mn':7, 'Fe':8, 'Cu':11}

re={'ScO':1.668, 'TiO':1.623, 'VO':1.591, 'CrO':1.621, 'MnO':1.648, 'FeO':1.616, 'CuO':1.725}

datacsv={}
for nm in ['basis','charge','method','molecule','pseudopotential',
           'totalenergy','totalenergy-stocherr','totalenergy-syserr']:
  datacsv[nm]=[]

basis='vdz'
element='Sc'

mol=gto.Mole()
mol.ecp={}
mol.basis={}
for el in [element,'O']:
  mol.ecp[el]=gto.basis.parse_ecp(df[el]['ecp'])
  mol.basis[el]=gto.basis.parse(df[el][basis])
mol.charge=0
mol.spin=spins[element+'O']
mol.build(atom="%s 0. 0. 0.; O 0. 0. %g"%(element,re[element+'O']),verbose=4)

m=ROHF(mol)
m.level_shift=1000.0
dm=m.from_chk("../../../HF/monoxides/"+element+basis+"0.chk")
hf=m.kernel(dm)
m.analyze()

from pyscf.shciscf import shci
mc = shci.SHCISCF(m, 9, 4+cas[element])
#mc.fcisolver.conv_tol = 1e-14
mc.fcisolver.mpiprefix="mpirun -np 28"
mc.fcisolver.num_thrds=12
mc.verbose = 4
cas=mc.kernel()[0]
 
from pyscf.icmpspt import icmpspt
pt=icmpspt.icmpspt(mc,rdmM=500, PTM=1000,\
                          pttype="MRLCC",\
                          third_order=True,\
                          fully_ic=True,\
                          do_dm4=True)

datacsv['basis'].append(basis)
datacsv['charge'].append(0)
datacsv['method'].append('MRPT')
datacsv['molecule'].append(element)
datacsv['pseudopotential'].append('trail')
datacsv['totalenergy'].append(cas+pt)
datacsv['totalenergy-stocherr'].append(0.0)
datacsv['totalenergy-syserr'].append(0.0)
pd.DataFrame(datacsv).to_csv(element+".csv",index=False)

#INFO: ******************** input file end ********************


System: ('Linux', 'bnode0308.rc.int.colorado.edu', '3.10.0-514.41.1.el7.x86_64', '#1 SMP Wed Jan 17 10:26:16 EST 2018', 'x86_64', 'x86_64')  Threads 1
Python 2.7.11 (default, Mar 22 2016, 01:42:54) 
[GCC Intel(R) C++ gcc 4.8 mode]
numpy 1.11.1  scipy 0.17.1
Date: Mon Mar 26 10:23:39 2018
PySCF version 1.4
PySCF path  /projects/bamu3429/softwares/pyscf_uptodate/pyscf
GIT ORIG_HEAD e2292e6edec2b0e0024c21b81de03db1d7bd4121
GIT HEAD      ref: refs/heads/master
GIT master branch  f3591ef22170896a4cdc2aadaa6f5da388ffcadb

[INPUT] VERBOSE 4
[INPUT] num atoms = 2
[INPUT] num electrons = 17
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 1
[INPUT] symmetry False subgroup None
[INPUT]  1 Sc     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 O      0.000000000000   0.000000000000   1.668000000000 AA    0.000000000000   0.000000000000   3.152063175775 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] Sc
[INPUT] 0    0    [12   /1   ]  36.40041505       0.005374
                                19.41172108       -0.032266
                                7.76559262        0.361279
                                4.72233684        -0.858519
                                3.30202494        0.196889
                                1.73290764        0.133972
                                0.86033787        0.640189
                                0.4883664         0.334618
                                0.23725388        0.123744
                                0.10565308        -0.017421
                                0.04670613        0.010856
                                0.020926          -0.001573
[INPUT] 0    0    [12   /1   ]  36.40041505       -0.001039
                                19.41172108       0.006911
                                7.76559262        -0.089603
                                4.72233684        0.22876
                                3.30202494        -0.05839
                                1.73290764        -0.038559
                                0.86033787        -0.215849
                                0.4883664         -0.20849
                                0.23725388        -0.146275
                                0.10565308        0.350802
                                0.04670613        0.655178
                                0.020926          0.218601
[INPUT] 0    0    [12   /1   ]  36.40041505       -0.00183
                                19.41172108       0.017383
                                7.76559262        -0.306573
                                4.72233684        0.839756
                                3.30202494        -0.052081
                                1.73290764        -0.85219
                                0.86033787        -0.851788
                                0.4883664         0.410577
                                0.23725388        0.822494
                                0.10565308        0.741761
                                0.04670613        -0.631886
                                0.020926          -0.450278
[INPUT] 0    0    [1    /1   ]  0.020926             1
[INPUT] 0    0    [1    /1   ]  0.00937558           1
[INPUT] 1    0    [12   /1   ]  41.12697558       0.001162
                                22.43738592       -0.006345
                                11.2588519        0.030743
                                6.08582478        -0.083979
                                3.77549759        -0.031739
                                2.17906519        0.232763
                                1.07491872        0.420436
                                0.55241218        0.351975
                                0.2815094         0.143464
                                0.12312886        0.016009
                                0.0538551         0.000238
                                0.02355558        0.000253
[INPUT] 1    0    [12   /1   ]  41.12697558       -0.000251
                                22.43738592       0.001425
                                11.2588519        -0.007434
                                6.08582478        0.022493
                                3.77549759        0.004514
                                2.17906519        -0.065531
                                1.07491872        -0.124901
                                0.55241218        -0.130795
                                0.2815094         0.004026
                                0.12312886        0.357311
                                0.0538551         0.542386
                                0.02355558        0.222946
[INPUT] 1    0    [12   /1   ]  41.12697558       0.000719
                                22.43738592       -0.005169
                                11.2588519        0.035545
                                6.08582478        -0.125521
                                3.77549759        -0.110989
                                2.17906519        0.858227
                                1.07491872        0.397739
                                0.55241218        -0.878221
                                0.2815094         -0.616013
                                0.12312886        0.57803
                                0.0538551         0.453432
                                0.02355558        0.007472
[INPUT] 1    0    [1    /1   ]  0.02355558           1
[INPUT] 1    0    [1    /1   ]  0.01030293           1
[INPUT] 2    0    [10   /1   ]  23.41055103       -0.002062
                                9.57667856        0.014373
                                5.80916551        0.096933
                                2.24207749        0.204502
                                1.03019541        0.261896
                                0.49142269        0.31382
                                0.21727354        0.282419
                                0.10003285        0.15287
                                0.04583255        0.056392
                                0.02097146        0.002436
[INPUT] 2    0    [10   /1   ]  23.41055103       0.003535
                                9.57667856        -0.025151
                                5.80916551        -0.062521
                                2.24207749        -0.365218
                                1.03019541        -0.408516
                                0.49142269        0.106345
                                0.21727354        0.341278
                                0.10003285        0.355175
                                0.04583255        0.170429
                                0.02097146        0.018134
[INPUT] 2    0    [1    /1   ]  0.02097146           1
[INPUT] 2    0    [1    /1   ]  0.00959584           1
[INPUT] 3    0    [1    /1   ]  1.439822             1
[INPUT] 3    0    [1    /1   ]  0.65881494           1
[INPUT] O
[INPUT] 0    0    [10   /1   ]  57.663349         -0.002794
                                35.726816         0.023976
                                22.453757         -0.115974
                                14.732301         0.288033
                                9.739917          -0.274786
                                5.042008          -0.083789
                                2.157818          0.063778
                                1.002916          0.410182
                                0.421839          0.504044
                                0.173041          0.172152
[INPUT] 0    0    [1    /1   ]  0.222099             1
[INPUT] 0    0    [1    /1   ]  0.08884              1
[INPUT] 1    0    [10   /1   ]  52.47406          -0.000522
                                32.138432         0.004857
                                19.458579         -0.027749
                                11.839344         0.074258
                                7.91003           0.014369
                                3.670858          0.153479
                                1.53966           0.283685
                                0.647119          0.358201
                                0.267853          0.29559
                                0.107198          0.104889
[INPUT] 1    0    [1    /1   ]  0.252604             1
[INPUT] 1    0    [1    /1   ]  0.101042             1
[INPUT] 2    0    [1    /1   ]  1.223113             1
[INPUT] 2    0    [1    /1   ]  0.489245             1
nuclear repulsion = 20.9386666191367
number of shells = 24
number of NR pGTOs = 334
number of NR cGTOs = 76
basis = {'Sc': [[0, [36.40041505, 0.005374], [19.41172108, -0.032266], [7.76559262, 0.361279], [4.72233684, -0.858519], [3.30202494, 0.196889], [1.73290764, 0.133972], [0.86033787, 0.640189], [0.4883664, 0.334618], [0.23725388, 0.123744], [0.10565308, -0.017421], [0.04670613, 0.010856], [0.020926, -0.001573]], [0, [36.40041505, -0.001039], [19.41172108, 0.006911], [7.76559262, -0.089603], [4.72233684, 0.22876], [3.30202494, -0.05839], [1.73290764, -0.038559], [0.86033787, -0.215849], [0.4883664, -0.20849], [0.23725388, -0.146275], [0.10565308, 0.350802], [0.04670613, 0.655178], [0.020926, 0.218601]], [0, [36.40041505, -0.00183], [19.41172108, 0.017383], [7.76559262, -0.306573], [4.72233684, 0.839756], [3.30202494, -0.052081], [1.73290764, -0.85219], [0.86033787, -0.851788], [0.4883664, 0.410577], [0.23725388, 0.822494], [0.10565308, 0.741761], [0.04670613, -0.631886], [0.020926, -0.450278]], [0, [0.020926, 1.0]], [0, [0.00937558, 1.0]], [1, [41.12697558, 0.001162], [22.43738592, -0.006345], [11.2588519, 0.030743], [6.08582478, -0.083979], [3.77549759, -0.031739], [2.17906519, 0.232763], [1.07491872, 0.420436], [0.55241218, 0.351975], [0.2815094, 0.143464], [0.12312886, 0.016009], [0.0538551, 0.000238], [0.02355558, 0.000253]], [1, [41.12697558, -0.000251], [22.43738592, 0.001425], [11.2588519, -0.007434], [6.08582478, 0.022493], [3.77549759, 0.004514], [2.17906519, -0.065531], [1.07491872, -0.124901], [0.55241218, -0.130795], [0.2815094, 0.004026], [0.12312886, 0.357311], [0.0538551, 0.542386], [0.02355558, 0.222946]], [1, [41.12697558, 0.000719], [22.43738592, -0.005169], [11.2588519, 0.035545], [6.08582478, -0.125521], [3.77549759, -0.110989], [2.17906519, 0.858227], [1.07491872, 0.397739], [0.55241218, -0.878221], [0.2815094, -0.616013], [0.12312886, 0.57803], [0.0538551, 0.453432], [0.02355558, 0.007472]], [1, [0.02355558, 1.0]], [1, [0.01030293, 1.0]], [2, [23.41055103, -0.002062], [9.57667856, 0.014373], [5.80916551, 0.096933], [2.24207749, 0.204502], [1.03019541, 0.261896], [0.49142269, 0.31382], [0.21727354, 0.282419], [0.10003285, 0.15287], [0.04583255, 0.056392], [0.02097146, 0.002436]], [2, [23.41055103, 0.003535], [9.57667856, -0.025151], [5.80916551, -0.062521], [2.24207749, -0.365218], [1.03019541, -0.408516], [0.49142269, 0.106345], [0.21727354, 0.341278], [0.10003285, 0.355175], [0.04583255, 0.170429], [0.02097146, 0.018134]], [2, [0.02097146, 1.0]], [2, [0.00959584, 1.0]], [3, [1.439822, 1.0]], [3, [0.65881494, 1.0]]], 'O': [[0, [57.663349, -0.002794], [35.726816, 0.023976], [22.453757, -0.115974], [14.732301, 0.288033], [9.739917, -0.274786], [5.042008, -0.083789], [2.157818, 0.063778], [1.002916, 0.410182], [0.421839, 0.504044], [0.173041, 0.172152]], [0, [0.222099, 1.0]], [0, [0.08884, 1.0]], [1, [52.47406, -0.000522], [32.138432, 0.004857], [19.458579, -0.027749], [11.839344, 0.074258], [7.91003, 0.014369], [3.670858, 0.153479], [1.53966, 0.283685], [0.647119, 0.358201], [0.267853, 0.29559], [0.107198, 0.104889]], [1, [0.252604, 1.0]], [1, [0.101042, 1.0]], [2, [1.223113, 1.0]], [2, [0.489245, 1.0]]]}
ecp = {'Sc': [10, [[-1, [[], [[8.68432435, 11.0]], [[12.96081047, 1293.12711495], [3.42726018, -59.34807006], [13.92649869, -6626.33658022], [14.1135521, 5365.4170824]], [[3.87834215, 95.52756785]]]], [0, [[], [], [[14.11432286, -1492.86349923], [4.42835597, 1499.37242], [7.46045566, 1088.20049735], [10.23533878, -1981.91696501], [4.52489587, -1710.45115474], [13.07885945, 2625.43810581]], []]], [1, [[], [], [[9.83997641, -2070.12504374], [7.25072068, 5801.02991534], [11.81974746, 1554.97375552], [14.07433272, -853.69420879], [7.08460322, -4878.01776292], [14.07166426, 462.12967346]], []]], [2, [[], [], [[11.29849449, -570.2795343], [5.72119848, -549.4382461], [6.53234086, 1672.92599442], [8.11431019, -2704.80905453], [9.9572828, 4666.19773963], [10.24029445, -2524.96335631]], []]]]], 'O': [2, [[-1, [[], [[10.27717748, 6.0]], [[15.99566749, 1232.50197768], [10.46901775, -696.47008301], [14.6384801, -2654.22657081], [12.57591181, 2101.67732548]], [[7.77739102, 61.66306486]]]], [0, [[], [], [[12.39426073, -656683.37638839], [12.38126171, 657858.57667068], [8.57671033, 511.50098405], [9.89256508, -2579.54665641], [28.05641604, -57.68129584], [17.24753607, 970.30940152]], []]], [1, [[], [], [[14.78918914, -363027.24258186], [14.82014018, 361852.52314043], [22.89622221, -1300.20069256], [8.51331893, -181.96869573], [11.48609758, 2194.87589959], [27.22017524, 451.19906206]], []]]]]}
CPU time:         0.51


******** <class 'pyscf.scf.rohf.ROHF'> flags ********
method = ROHF
initial guess = minao
damping factor = 0
level shift factor = 1000.0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
DIIS start cycle = 1
DIIS space = 8
SCF tol = 1e-09
SCF gradient tol = None
max. SCF cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /projects/bamu3429/BENCHMARK/fresh_atoms/MRPT/monoxides/ScO/tmpHi5U9u
max_memory 4000 MB (current use 81 MB)
num. doubly occ = 8  num. singly occ = 1
Set gradient conv threshold to 3.16228e-05
init E= -61.829963200958
  HOMO = 499.880537692754  LUMO = 1000.01155193749
cycle= 1 E= -61.8299632009583  delta_E= -3.55e-13  |g|= 1.42e-05  |ddm|= 6e-08
  HOMO = -0.119462307812475  LUMO = 0.0115519374397262
Extra cycle  E= -61.8299632011628  delta_E= -2.04e-10  |g|= 4.92e-06  |ddm|= 7.61e-05
converged SCF energy = -61.8299632011628
**** MO energy ****
                Roothaan           | alpha              | beta
MO #1   energy= -2.65341543718695  | -2.65810696759181  | -2.64872390497007  occ= 2
MO #2   energy= -1.66573085319032  | -1.67086311864928  | -1.66059858088741  occ= 2
MO #3   energy= -1.62924558336893  | -1.63161179699421  | -1.62687936974364  occ= 2
MO #4   energy= -1.62924558336893  | -1.63161179699421  | -1.62687936974364  occ= 2
MO #5   energy= -1.11983218165156  | -1.12085977786303  | -1.1188045845835   occ= 2
MO #6   energy= -0.431153481987156 | -0.432711614038504 | -0.429595326410434 occ= 2
MO #7   energy= -0.420405291544618 | -0.421173926257152 | -0.419636656832088 occ= 2
MO #8   energy= -0.420405291544617 | -0.42117392625715  | -0.419636656832087 occ= 2
MO #9   energy= -0.119462307812475 | -0.248336639065042 | 0.00941064727227528 occ= 1
MO #10  energy= 0.0115519374397262 | 0.00519380612784076 | 0.0179100687516112 occ= 0
MO #11  energy= 0.0115519374397265 | 0.0051938061278406 | 0.0179100687516113 occ= 0
MO #12  energy= 0.0160600387817926 | 0.01450426617626   | 0.0176161648615268 occ= 0
MO #13  energy= 0.0230223841039696 | 0.0220445709015641 | 0.0240002489843418 occ= 0
MO #14  energy= 0.0283386173798534 | 0.0282448475141176 | 0.0284323872455898 occ= 0
MO #15  energy= 0.0283386173798534 | 0.0282448475141166 | 0.0284323872455887 occ= 0
MO #16  energy= 0.0319512460128327 | 0.0314294472221157 | 0.0324730448035489 occ= 0
MO #17  energy= 0.031951246012833  | 0.0314294472221168 | 0.0324730448035495 occ= 0
MO #18  energy= 0.0366680244174941 | 0.036513357069415  | 0.0368226904317866 occ= 0
MO #19  energy= 0.0447442634092496 | 0.0334895836132302 | 0.0559989432052686 occ= 0
MO #20  energy= 0.0447442634092498 | 0.0334895836132322 | 0.0559989432052699 occ= 0
MO #21  energy= 0.0602669654677899 | 0.0504065965746094 | 0.0701273053361012 occ= 0
MO #22  energy= 0.0748492307317704 | 0.070801596978216  | 0.0788968644853223 occ= 0
MO #23  energy= 0.0748492307317735 | 0.07080159697822   | 0.0788968644853261 occ= 0
MO #24  energy= 0.101082055616872  | 0.099995692571523  | 0.10216841866222   occ= 0
MO #25  energy= 0.101082055616872  | 0.0999956925715229 | 0.102168418662221  occ= 0
MO #26  energy= 0.115728699975824  | 0.113913463564091  | 0.117544081230642  occ= 0
MO #27  energy= 0.134347110799644  | 0.126191880645083  | 0.142503029301059  occ= 0
MO #28  energy= 0.143044814627946  | 0.138646972404544  | 0.147442656851344  occ= 0
MO #29  energy= 0.143044814627946  | 0.138646972404545  | 0.147442656851345  occ= 0
MO #30  energy= 0.168698856819425  | 0.159056704970223  | 0.178341008668626  occ= 0
MO #31  energy= 0.168698856819427  | 0.159056704970226  | 0.178341008668628  occ= 0
MO #32  energy= 0.173882108417316  | 0.164317986201873  | 0.183446382484798  occ= 0
MO #33  energy= 0.24973619956136   | 0.242367749588146  | 0.257104649534575  occ= 0
MO #34  energy= 0.249736199561362  | 0.242367749588148  | 0.257104649534577  occ= 0
MO #35  energy= 0.386480829359766  | 0.38436226693062   | 0.388599353197275  occ= 0
MO #36  energy= 0.418373366166425  | 0.417113408660526  | 0.419633323672323  occ= 0
MO #37  energy= 0.418373366166425  | 0.417113408660525  | 0.419633323672323  occ= 0
MO #38  energy= 0.461035961382782  | 0.459330472160523  | 0.462741435085447  occ= 0
MO #39  energy= 0.824336557894341  | 0.815092176898845  | 0.833580947086902  occ= 0
MO #40  energy= 0.87233451486349   | 0.866825046690094  | 0.877843983036883  occ= 0
MO #41  energy= 0.8723345148635    | 0.866825046690107  | 0.877843983036895  occ= 0
MO #42  energy= 1.03663231989951   | 1.02914370534625   | 1.04412093445276   occ= 0
MO #43  energy= 1.03663231989951   | 1.02914370534625   | 1.04412093445276   occ= 0
MO #44  energy= 1.25404587998192   | 1.24536703022466   | 1.26272474894351   occ= 0
MO #45  energy= 1.39021459791706   | 1.38929432311459   | 1.39113487271953   occ= 0
MO #46  energy= 1.39021459791707   | 1.3892943231146    | 1.39113487271953   occ= 0
MO #47  energy= 1.46028033875139   | 1.45926347444066   | 1.46129720306213   occ= 0
MO #48  energy= 1.46028033875141   | 1.45926347444067   | 1.46129720306214   occ= 0
MO #49  energy= 1.47267165731487   | 1.47031501650581   | 1.47502830470748   occ= 0
MO #50  energy= 1.55018190094695   | 1.54986409461468   | 1.55049970727922   occ= 0
MO #51  energy= 1.55018190094698   | 1.54986409461471   | 1.55049970727925   occ= 0
MO #52  energy= 1.722205583841     | 1.71982794972893   | 1.72458322131195   occ= 0
MO #53  energy= 1.8994670499687    | 1.89622046461603   | 1.90271363532138   occ= 0
MO #54  energy= 1.8994670499687    | 1.89622046461604   | 1.90271363532138   occ= 0
MO #55  energy= 1.92435845776009   | 1.92213566568794   | 1.92658125041436   occ= 0
MO #56  energy= 2.00368782473149   | 2.00182070914158   | 2.00555494032139   occ= 0
MO #57  energy= 2.00368782473149   | 2.00182070914159   | 2.0055549403214    occ= 0
MO #58  energy= 2.01008454182486   | 2.00495866282109   | 2.01521042082862   occ= 0
MO #59  energy= 2.01008454182486   | 2.0049586628211    | 2.01521042082862   occ= 0
MO #60  energy= 2.31303885723225   | 2.31152495245971   | 2.31455276105282   occ= 0
MO #61  energy= 2.44686073581317   | 2.44578856459295   | 2.44793290703338   occ= 0
MO #62  energy= 2.44686073581317   | 2.44578856459296   | 2.44793290703339   occ= 0
MO #63  energy= 3.17744603483863   | 3.17383709369964   | 3.18105497614648   occ= 0
MO #64  energy= 4.23387914808983   | 4.2337193149919    | 4.23403898118778   occ= 0
MO #65  energy= 4.23387914808984   | 4.2337193149919    | 4.23403898118777   occ= 0
MO #66  energy= 4.352711975214     | 4.3524325896839    | 4.35299136074408   occ= 0
MO #67  energy= 4.352711975214     | 4.35243258968392   | 4.3529913607441    occ= 0
MO #68  energy= 4.36489951579356   | 4.36438132266064   | 4.36541770908645   occ= 0
MO #69  energy= 5.23495175419498   | 5.2337811327654    | 5.23612237562456   occ= 0
MO #70  energy= 5.23495175419498   | 5.2337811327654    | 5.23612237562456   occ= 0
MO #71  energy= 5.2840637146511    | 5.28250045415613   | 5.28562697514608   occ= 0
MO #72  energy= 5.2840637146511    | 5.28250045415614   | 5.28562697514609   occ= 0
MO #73  energy= 5.45959999445836   | 5.4573396373117    | 5.46186035160501   occ= 0
MO #74  energy= 5.45959999445837   | 5.45733963731171   | 5.46186035160502   occ= 0
MO #75  energy= 5.49178258993007   | 5.48945365986155   | 5.49411152005868   occ= 0
MO #76  energy= 5.6045377288876    | 5.603037537757     | 5.60603792006082   occ= 0
 ** Mulliken pop on meta-lowdin orthogonal AOs  **
 ** Mulliken pop  **
pop of  0Sc 3s        1.99928
pop of  0Sc 4s        0.88927
pop of  0Sc 5s        0.00368
pop of  0Sc 6s        0.00251
pop of  0Sc 7s        0.00133
pop of  0Sc 3px       1.99910
pop of  0Sc 3py       1.99910
pop of  0Sc 3pz       1.99527
pop of  0Sc 4px       0.01224
pop of  0Sc 4py       0.01224
pop of  0Sc 4pz       0.08716
pop of  0Sc 5px       0.00017
pop of  0Sc 5py       0.00017
pop of  0Sc 5pz       0.00718
pop of  0Sc 6px       0.00058
pop of  0Sc 6py       0.00058
pop of  0Sc 6pz       0.02147
pop of  0Sc 7px       0.00009
pop of  0Sc 7py       0.00009
pop of  0Sc 7pz       0.00276
pop of  0Sc 3dxy      0.00000
pop of  0Sc 3dyz      0.31230
pop of  0Sc 3dz^2     0.47510
pop of  0Sc 3dxz      0.31230
pop of  0Sc 3dx2-y2    0.00000
pop of  0Sc 4dxy      0.00000
pop of  0Sc 4dyz      0.00038
pop of  0Sc 4dz^2     0.00719
pop of  0Sc 4dxz      0.00038
pop of  0Sc 4dx2-y2    0.00000
pop of  0Sc 5dxy      0.00000
pop of  0Sc 5dyz      0.00008
pop of  0Sc 5dz^2     0.00199
pop of  0Sc 5dxz      0.00008
pop of  0Sc 5dx2-y2    0.00000
pop of  0Sc 6dxy      0.00000
pop of  0Sc 6dyz      0.00000
pop of  0Sc 6dz^2     0.00002
pop of  0Sc 6dxz      0.00000
pop of  0Sc 6dx2-y2    0.00000
pop of  0Sc 4fy^3     0.00000
pop of  0Sc 4fxyz     0.00000
pop of  0Sc 4fyz^2    0.00024
pop of  0Sc 4fz^3     0.00044
pop of  0Sc 4fxz^2    0.00024
pop of  0Sc 4fzx^2    0.00000
pop of  0Sc 4fx^3     0.00000
pop of  0Sc 5fy^3     0.00000
pop of  0Sc 5fxyz     0.00000
pop of  0Sc 5fyz^2    0.00124
pop of  0Sc 5fz^3     0.00161
pop of  0Sc 5fxz^2    0.00124
pop of  0Sc 5fzx^2    0.00000
pop of  0Sc 5fx^3     0.00000
pop of  1O 2s        1.84784
pop of  1O 3s        0.00655
pop of  1O 4s        0.02188
pop of  1O 2px       1.66246
pop of  1O 2py       1.66246
pop of  1O 2pz       1.61919
pop of  1O 3px       0.00332
pop of  1O 3py       0.00332
pop of  1O 3pz       0.00192
pop of  1O 4px       0.00320
pop of  1O 4py       0.00320
pop of  1O 4pz       0.00220
pop of  1O 3dxy      0.00000
pop of  1O 3dyz      0.00093
pop of  1O 3dz^2     0.00124
pop of  1O 3dxz      0.00093
pop of  1O 3dx2-y2    0.00000
pop of  1O 4dxy      0.00000
pop of  1O 4dyz      0.00367
pop of  1O 4dz^2     0.00292
pop of  1O 4dxz      0.00367
pop of  1O 4dx2-y2    0.00000
 ** Mulliken atomic charges  **
charge of  0Sc =      0.85092
charge of  1O =     -0.85092

******** <class 'pyscf.mcscf.mc1step.CASSCF'> flags ********
CAS (4e+3e, 9o), ncore = 5, nvir = 62
max_cycle_macro = 50
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 0.02
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 2.5
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 3
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
chkfile = ./scratch/130035/tmpzqnSMP
max_memory 4000 MB (current use 129 MB)
internal_rotation = False

******** SHCI flags ********
executable             = /home/bamu3429/softwares/dice/Dice
mpiprefix              = mpirun -np 28
scratchDirectory       = ./scratch/130035
integralFile           = ./FCIDUMP
configFile             = ./input.dat
outputFile             = ./output.dat
maxIter                = 6
sweep_iter             = []
sweep_epsilon          = []
nPTiter                = 0
Stochastic             = True
fullrestart            = False
restart                = False
num_thrds              = 12
memory                 = None

CASCI E = -61.829969673262  S^2 = 0.7500000
Set conv_tol_grad to 0.000316228
macro iter 1 (7 JK  2 micro), CASSCF E = -61.8299813659212  dE = -1.1692659e-05  S^2 = 0.7500000
               |grad[o]|=6.17e-05  |grad[c]|= None  |ddm|=0.00673
macro iter 2 (7 JK  2 micro), CASSCF E = -61.8300173024375  dE = -3.5936516e-05  S^2 = 0.7500000
               |grad[o]|=0.000123  |grad[c]|= None  |ddm|=0.00358
macro iter 3 (7 JK  2 micro), CASSCF E = -61.8301854136831  dE = -0.00016811125  S^2 = 0.7500000
               |grad[o]|=0.000521  |grad[c]|= None  |ddm|=0.00313
macro iter 4 (21 JK  4 micro), CASSCF E = -61.8386791503421  dE = -0.0084937367  S^2 = 0.7500000
               |grad[o]|=0.00204  |grad[c]|= None  |ddm|=0.0299
macro iter 5 (21 JK  4 micro), CASSCF E = -61.8561502327893  dE = -0.017471082  S^2 = 0.7500000
               |grad[o]|=0.0298  |grad[c]|= None  |ddm|=0.0335
macro iter 6 (21 JK  4 micro), CASSCF E = -61.8985527442843  dE = -0.042402511  S^2 = 0.7500000
               |grad[o]|=0.0433  |grad[c]|= None  |ddm|=0.0446
macro iter 7 (21 JK  4 micro), CASSCF E = -61.9451358826352  dE = -0.046583138  S^2 = 0.7500000
               |grad[o]|=0.0707  |grad[c]|= None  |ddm|=0.0294
macro iter 8 (21 JK  4 micro), CASSCF E = -61.9621487381411  dE = -0.017012856  S^2 = 0.7500000
               |grad[o]|=0.0437  |grad[c]|= None  |ddm|=0.0278
macro iter 9 (21 JK  4 micro), CASSCF E = -61.9641501920865  dE = -0.0020014539  S^2 = 0.7500000
               |grad[o]|=0.0076  |grad[c]|= None  |ddm|=0.0061
macro iter 10 (21 JK  4 micro), CASSCF E = -61.9649877821567  dE = -0.00083759007  S^2 = 0.7500000
               |grad[o]|=0.00458  |grad[c]|= None  |ddm|=0.00341
macro iter 11 (21 JK  4 micro), CASSCF E = -61.9652873830998  dE = -0.00029960094  S^2 = 0.7500000
               |grad[o]|=0.00235  |grad[c]|= None  |ddm|=0.00325
macro iter 12 (17 JK  4 micro), CASSCF E = -61.9654884346153  dE = -0.00020105152  S^2 = 0.7500000
               |grad[o]|=0.00176  |grad[c]|= None  |ddm|=0.00774
macro iter 13 (12 JK  4 micro), CASSCF E = -61.9655325343192  dE = -4.4099704e-05  S^2 = 0.7500000
               |grad[o]|=0.00138  |grad[c]|= None  |ddm|=0.00348
macro iter 14 (16 JK  4 micro), CASSCF E = -61.9655336818824  dE = -1.1475632e-06  S^2 = 0.7500000
               |grad[o]|=0.000324  |grad[c]|= None  |ddm|=0.000946
macro iter 15 (3 JK  1 micro), CASSCF E = -61.9655397991529  dE = -6.1172705e-06  S^2 = 0.7500000
               |grad[o]|=0.000125  |grad[c]|= None  |ddm|=0.000159
macro iter 16 (4 JK  1 micro), CASSCF E = -61.9655400670568  dE = -2.6790386e-07  S^2 = 0.7500000
               |grad[o]|=0.000106  |grad[c]|= None  |ddm|=7.73e-05
macro iter 17 (8 JK  1 micro), CASSCF E = -61.9655401806159  dE = -1.135591e-07  S^2 = 0.7500000
               |grad[o]|=6.45e-05  |grad[c]|= None  |ddm|=4.22e-05
macro iter 18 (5 JK  1 micro), CASSCF E = -61.9655402311458  dE = -5.0529906e-08  S^2 = 0.7500000
               |grad[o]|=5.27e-05  |grad[c]|= None  |ddm|=3.73e-05
1-step CASSCF converged in 18 macro (254 JK 54 micro) steps
CASSCF canonicalization
CASSCF energy = -61.9655402311458


--------------------------------------------------
                 ICMPSPT CALCULATION              
--------------------------------------------------

Perturbation type: MRLCC
With fully internally contracted scheme
With third order correction

Preparing necessary RDMs
......production of RDMs took      18.69 sec
Reading binary 4RDM from DICE
......reading the RDM took         26.64 sec

(GOOD) Trace 4RDM:    840.0 =    7*    6*    5*    4
(GOOD) Trace 3RDM:    210.0 =    7*    6*    5
(GOOD) Trace 2RDM:     42.0 =    7*    6
(GOOD) Trace 1RDM:      7.0 =    7

Producing the integrals
......production of INT took     169.32 sec

Energy_core =  -70.2449770157
Energy      =  -61.9655402311

WARNING: Have to use natural orbitals from CAASCF
         offdiagonal elements: 0.470567186191

Basic ingredients written to int/
......savings of INGREDIENTS took      29.61 sec

Second-order:
perturber CCVV --        -0.173616389
perturber CCAV --        -0.055627026
perturber ACVV --        -0.065658992
perturber CCAA --        -0.014634392
perturber AAVV --        -0.055859394
perturber CAAV --        -0.069604497
perturber AAAV --        -0.023748345
perturber AAAC --        -0.006624469
Total:                   -0.465373503

Third-order:             -0.002511351

Total PT       --        -0.467884854

